{"version":3,"sources":["webpack:///./src/app/graph2/element/GraphNode.js","webpack:///./src/app/graph2/element/GraphEdge.js","webpack:///./src/app/util/input/AbstractInputHandler.js","webpack:///./src/app/graph2/renderer/NodeRenderer.js","webpack:///./src/app/graph2/element/GraphElement.js","webpack:///./src/app/modules/fsa2/machine/FSA.js","webpack:///./src/app/modules/fsa2/graph/element/FSAEdge.js","webpack:///./src/app/modules/fsa2/machine/util/EqualFSA.js","webpack:///./src/app/graph2/renderer/EdgeRenderer.js","webpack:///./src/app/modules/fsa2/machine/util/ConvertFSA.js","webpack:///./src/app/modules/fsa2/machine/util/IntersectFSA.js","webpack:///./src/app/graph2/NodeGraph.js","webpack:///./src/app/graph2/element/QuadraticEdge.js","webpack:///./src/app/graph2/inputhandler/GraphNodeInputHandler.js","webpack:///./src/app/graph2/inputhandler/GraphEdgeInputHandler.js","webpack:///./src/app/graph2/renderer/StartMarkerRenderer.js","webpack:///./src/app/components/iconset/RunningManIcon.js","webpack:///./src/app/modules/fsa2/graph/FSAGraph.js","webpack:///./src/app/graph2/inputhandler/IndexedGraphStartMarkerInputHandler.js","webpack:///./src/app/modules/fsa2/GraphLayout.js","webpack:///./src/app/modules/fsa2/machine/util/InvertDFA.js","webpack:///./src/app/session/manager/undo/AbstractEventHandler.js","webpack:///./src/app/components/iconset/ZoomInIcon.js","webpack:///./src/app/components/iconset/ZoomOutIcon.js","webpack:///./src/app/graph2/components/widgets/ZoomWidget.js","webpack:///./src/app/components/iconset/PinpointIcon.js","webpack:///./src/app/graph2/components/widgets/FocusCenterWidget.js","webpack:///./src/app/graph2/components/layers/ViewportNavigationLayer.js","webpack:///./src/app/components/iconset/flat/JSONFileIcon.js","webpack:///./src/app/components/iconset/BoxAddIcon.js","webpack:///./src/app/session/SessionImporter.js","webpack:///./src/app/util/file/import/Importer.js","webpack:///./src/app/graph2/renderer/GraphHighlightRenderer.js","webpack:///./src/app/graph2/components/layers/GraphHighlightLayer.js","webpack:///./src/app/experimental/UserUtil.js","webpack:///./src/app/graph2/IndexedNodeGraph.js","webpack:///./src/app/util/Downloader.js","webpack:///./src/app/components/iconset/PageContentIcon.js","webpack:///./src/app/components/iconset/AddIcon.js","webpack:///./src/app/components/iconset/SubtractIcon.js","webpack:///./src/app/components/iconset/CheckCircleIcon.js","webpack:///./src/app/components/iconset/CrossCircleIcon.js","webpack:///./src/app/components/iconset/PendingIcon.js","webpack:///./src/app/util/input/ViewportAdapter.js","webpack:///./src/app/util/input/InputContext.js","webpack:///./src/app/util/input/InputPointer.js","webpack:///./src/app/util/input/InputAdapter.js","webpack:///./src/app/util/input/components/ViewportComponent.js","webpack:///./src/app/graph2/controller/InputController.js","webpack:///./src/app/graph2/inputhandler/ViewportInputHandler.js","webpack:///./src/app/graph2/components/GraphView.js","webpack:///./src/app/components/iconset/TrashCanDetailedIcon.js","webpack:///./src/app/graph2/components/widgets/TrashCanWidget.js","webpack:///./src/app/components/iconset/MoveIcon.js","webpack:///./src/app/graph2/components/widgets/ModeTrayWidget.js","webpack:///./src/app/graph2/components/layers/ViewportEditLayer.js","webpack:///./src/app/deprecated/icons/flat/PNGIcon.js","webpack:///./src/app/deprecated/icons/flat/JPGIcon.js","webpack:///./src/app/deprecated/icons/flat/SVGIcon.js","webpack:///./src/app/components/iconset/flat/PNGFileIcon.js","webpack:///./src/app/modules/nodegraph/filehandlers/NodalGraphImageExporter.js","webpack:///./src/app/graph2/renderer/BoxRenderer.js","webpack:///./src/app/graph2/controller/SelectionBox.js","webpack:///./src/app/graph2/inputhandler/SelectionBoxInputHandler.js","webpack:///./src/app/graph2/components/layers/SelectionBoxLayer.js","webpack:///./src/app/graph2/controller/LabelFormatter.js","webpack:///./src/app/graph2/controller/GraphChangeHandler.js","webpack:///./src/app/graph2/controller/GraphController.js","webpack:///./src/app/graph2/renderer/GraphNodeRenderer.js","webpack:///./src/app/graph2/components/layers/GraphNodeLayer.js","webpack:///./src/app/graph2/renderer/StartNodeMarkerRenderer.js","webpack:///./src/app/graph2/components/layers/IndexedGraphStartMarkerLayer.js","webpack:///./src/app/graph2/renderer/GraphEdgeRenderer.js","webpack:///./src/app/graph2/components/layers/GraphEdgeLayer.js","webpack:///./src/app/graph2/components/widgets/pattern/PatternInput.js","webpack:///./src/app/graph2/components/widgets/LabelEditorWidget.js","webpack:///./src/app/graph2/util/UnreachableNodes.js","webpack:///./src/app/graph2/util/NodeGraphUtils.js","webpack:///./src/app/modules/fsa2/machine/util/SolveFSA.js","webpack:///./src/app/modules/fsa2/machine/FSAUtils.js","webpack:///./src/app/modules/fsa2/graph/element/FSANode.js","webpack:///./src/app/modules/fsa2/FSAGraphParser.js","webpack:///./src/app/graph2/AbstractGraphLabeler.js","webpack:///./src/app/modules/abstract/AbstractMachineController.js","webpack:///./src/app/util/Eventable.js","webpack:///./src/app/modules/nodegraph/SafeGraphEventHandler.js","webpack:///./src/app/experimental/panels/PanelDivider.js","webpack:///./src/app/components/iconset/TriangleIcon.js","webpack:///./src/app/experimental/panels/PanelCheckbox.js","webpack:///./src/app/util/file/Parser.js","webpack:///./src/app/graph2/components/widgets/pattern/PatternInputButton.js","webpack:///./src/app/components/iconset/DownArrowIcon.js","webpack:///./src/app/experimental/MachineChangeHandler.js","webpack:///./src/app/modules/abstract/AbstractMachineBuilder.js","webpack:///./src/app/modules/fsa2/graph/FSAGraphLabeler.js","webpack:///./src/app/modules/fsa2/graph/FSAGraphController.js","webpack:///./src/app/modules/fsa2/machine/FSABuilder.js","webpack:///./src/app/modules/fsa2/machine/MachineController.js","webpack:///./src/app/modules/fsa2/tester/StringTester.js","webpack:///./src/app/modules/fsa2/tester/TapeContext.js","webpack:///./src/app/modules/fsa2/components/notifications/NFAToDFAConversionNotificationLayout.js","webpack:///./src/app/modules/fsa2/components/notifications/StateNotificationLayout.js","webpack:///./src/app/modules/fsa2/components/notifications/TransitionNotificationLayout.js","webpack:///./src/app/modules/fsa2/components/notifications/StateMissingTransitionNotificationLayout.js","webpack:///./src/app/modules/fsa2/components/notifications/StateUnreachableNotificationLayout.js","webpack:///./src/app/modules/fsa2/components/notifications/FSANotifications.js","webpack:///./src/app/modules/fsa2/FSAErrorChecker.js","webpack:///./src/app/modules/fsa2/filehandlers/FSAImporter.js","webpack:///./src/app/modules/fsa2/filehandlers/FSAJFFImporter.js","webpack:///./src/app/modules/fsa2/filehandlers/FSAExporter.js","webpack:///./src/app/components/iconset/flat/XMLFileIcon.js","webpack:///./src/app/modules/fsa2/filehandlers/FSAJFFExporter.js","webpack:///./src/app/session/manager/broadcast/BroadcastHandler.js","webpack:///./src/app/modules/fsa2/FSABroadcastHandler.js","webpack:///./src/app/modules/fsa2/TutorialHandler.js","webpack:///./src/app/modules/fsa2/components/panels/overview/states/StateListElement.js","webpack:///./src/app/modules/fsa2/components/panels/overview/states/StateListView.js","webpack:///./src/app/modules/fsa2/components/panels/overview/alphabet/AlphabetListElement.js","webpack:///./src/app/modules/fsa2/components/panels/overview/alphabet/AlphabetListView.js","webpack:///./src/app/modules/fsa2/components/panels/overview/transitions/TransitionChartView.js","webpack:///./src/app/modules/fsa2/components/panels/overview/transitions/TransitionTableView.js","webpack:///./src/app/modules/fsa2/components/panels/overview/AutoStateLabelView.js","webpack:///./src/app/modules/fsa2/components/panels/overview/OverviewPanel.js","webpack:///./src/app/modules/fsa2/components/panels/testing/TestItem.js","webpack:///./src/app/modules/fsa2/components/panels/testing/TestListView.js","webpack:///./src/app/modules/fsa2/components/panels/testing/TestingPanel.js","webpack:///./src/app/modules/fsa2/filehandlers/FSAGraphParser.js","webpack:///./src/app/modules/fsa2/components/panels/analysis/AnalysisPanel.js","webpack:///./src/app/modules/fsa2/components/panels/analysis/MachineLoader.js","webpack:///./src/app/modules/fsa2/graph/renderer/FSANodeRenderer.js","webpack:///./src/app/modules/fsa2/graph/inputhandler/FSANodeInputHandler.js","webpack:///./src/app/modules/fsa2/graph/renderer/FSAEdgeRenderer.js","webpack:///./src/app/modules/fsa2/components/layers/FSAGraphLayer.js","webpack:///./src/app/modules/fsa2/components/widgets/FSALabelEditorRenderer.js","webpack:///./src/app/modules/fsa2/components/layers/FSAGraphOverlayLayer.js","webpack:///./src/app/modules/fsa2/components/widgets/TapeWidget.js","webpack:///./src/app/modules/fsa2/components/layers/FSATapeGraphOverlayLayer.js","webpack:///./src/app/modules/fsa2/FSAModule.js"],"names":["GraphNode","id","x","y","_label","dst","this","label","usePosition","Math","floor","GraphElement","GraphEdge","from","to","_from","_to","node","Error","HALFPI","PI","result","isPlaceholder","dy","dx","atan2","halfPlaceholderLength","getPlaceholderLength","placeholderLength","getNodeSize","src","getHashString","AbstractInputHandler","pointer","zoomValue","prevValue","EVENT_SOURCE_NODE","DefaultNodeShapeRenderer","props","Fragment","cx","position","cy","r","radius","fill","color","stroke","outline","onMouseOver","onMouseOut","cursor","pointerEvents","DefaultLabelRenderer","style","userSelect","fontSize","min","max","length","textAnchor","NodeRenderer","NodeShapeRenderer","NodeLabelRenderer","e","target","type","React","Component","elementID","_id","EMPTY_SYMBOL","State","_src","getGraphElementID","guid","Transition","symbols","_symbols","slice","symbol","push","includes","join","FSA","deterministic","_states","Map","_alphabet","_transitions","_finalStates","Set","_customSymbols","_startState","_deterministic","_errors","fsa","clear","entries","key","value","copy","set","isStartState","isFinalState","add","get","getSourceState","getStateID","getDestinationState","error","foundSymbols","keys","values","state","transitions","getOutgoingTransitions","addState","stateID","has","size","next","getStateLabel","hasState","transitionKey","transition","hasSymbol","addSymbol","_incrSymbolCount","getSymbols","index","indexOf","_decrSymbolCount","splice","symbolCount","isCustomSymbol","newSymbol","count","cache","custom","final","forceNondeterminism","fromTransitionKey","startsWith","toState","doClosureTransition","s","i","string","stringHash","SYMBOL_SEPARATOR","EMPTY_CHAR","FSAEdge","QuadraticEdge","isEquivalentFSAWithWitness","fsa1","fsa2","isEquivalentDFA","isDeterministic","convertToDFA","dfa1","dfa2","dfa3","intersectionOfComplement","witnessString","dfa3acceptssomething","isLanguageNotEmpty","dfa4","dfa4acceptssometing","m1","m2","alphabet1","alphabet2","getAlphabet","isUsedSymbol","haveTheSameUsedAlphabet","inverted","invertDFA","intersectDFA","dfa","explored","frontier","getStartState","path","current","shift","pathUpTill","dest","SIXTH_PI","HALF_PI","DIRECTED_FORWARD","EVENT_SOURCE_FORWARD_ENDPOINT","EVENT_SOURCE_EDGE","EVENT_SOURCE_LABEL","DefaultEndpointRenderer","d","sin","angle","cos","transform","direction","labels","map","str","reverse","alignmentBaseline","EdgeRenderer","fromAngle","toAngle","directed","ForwardEndpointRenderer","forwardEndpointRenderer","endpointRenderer","BackwardEndpointRenderer","backwardEndpointRenderer","EdgeLabelRenderer","labelRenderer","fromPoint","toPoint","centerPoint","center","reverseLabel","quadLine","dftx","dfty","dfcx","dfcy","ftrad","fcrad","abs","pathData","strokeWidth","split","setDeterministic","startState","dfaData","nfaSource","dfaStateMap","dfaFinalStates","dfaTransitionMap","dfaStartState","dfaTrapState","startStatesByClosure","getDFAStateFromNFAStates","statePowerSet","states","len","concat","getPowerSetOfStates","getStates","nfaStates","expandNFAStatesToDFA","dfaState","dfaTransitionKey","getDFATransitionKeyFromDFAStateAndSymbol","setStartState","finalState","setFinalState","addTransition","fromDFAState","nfaTerminals","fromNFAState","doTerminalTransition","nfaStateKey","nfaState","getNFAStateKeyFromNFAStates","dfaStateLabel","alphabet","checkSameAlphabet","start1","start2","pairIDs","finalPairIDs","startPair","startPairID","remainingPairIDs","parentPairID","pop","parentPair","parent1","parent2","state1","state2","doTransition","newPairID","pairToState","statePairID","statePair","createState","fromPairID","toPairID","fromState","NodeGraph","nodeClass","edgeClass","_nodeClass","_edgeClass","_nodeMapping","_edgeMapping","clearEdges","clearNodes","minX","minY","maxX","maxY","width","height","minNX","Number","MAX_VALUE","minNY","maxNX","MIN_VALUE","maxNY","maxNodeSize","minEX","minEY","maxEX","maxEY","startPoint","endPoint","edge","getStartPoint","getEndPoint","getCenterPoint","sx","sy","ex","ey","addNode","setGraphElementID","nullSourceEdges","getEdges","getEdgeFrom","getEdgeTo","setEdgeTo","deleteEdge","getNodes","getNodeLabel","Array","addEdge","getEdgeLabel","_quad","radians","coords","prevNode","setQuadraticByCoords","fromx","fromy","midpointx","midpointy","angleOffset","sqrt","outrad","inrad","maxdr","getDirectionalVector","isQuadratic","getQuadraticAsCoords","px","py","nodeSize","getMidPoint","qcoords","qx","qy","isSelfLoop","GRAPH_EVENT_NODE_DELETE","GRAPH_EVENT_NODE_DELETE_ALL","GRAPH_EVENT_NODE_EDIT_WHILE_DELETE","GraphNodeInputHandler","inputController","graphController","_inputController","_graphController","_cachedPosition","currentTargetType","getCurrentTargetType","isTrashMode","currentTargetSource","getCurrentTargetSource","getGraph","deleteNode","emitGraphEvent","isMoveMode","getInputAdapter","openLabelEditor","hasChanged","onInputEvent","hasActiveTarget","labelFormatter","getLabelFormatter","createNode","setNodeLabel","getDefaultNodeLabel","selectionBox","getSelectionBox","hasSelection","isTargetInSelection","clearSelection","bindActiveTarget","targetSource","getActiveTargetSource","getSelection","moveNodeTo","unbindActiveTarget","graph","lerp","other","diameter","nextDX","nextDY","GRAPH_EVENT_EDGE_CREATE","GRAPH_EVENT_EDGE_DELETE","GRAPH_EVENT_EDGE_EDIT_WHILE_DELETE","GraphEdgeInputHandler","_cachedEdgeQuads","_cachedEdgeTo","_cachedPointer","_newEdge","_shouldDeleteEdgePlaceholder","_shouldDeleteEdgeWithEmptyLabel","flag","targetEdge","createEdge","setNodeEventsOnly","getQuadraticRadians","getQuadraticLength","setQuadraticRadians","setQuadraticLength","targetType","getActiveTargetType","handleDragMoveForEndpoint","getImmediateTargetType","immediateTargetSource","getImmediateTargetSource","isNewEdge","edgeTo","setEdgeLabel","getDefaultEdgeLabel","EVENT_SOURCE_START_MARKER","StartMarkerRenderer","offset","diameterX","RunningManIcon","className","xmlns","viewBox","PureComponent","FSAGraph","FSANode","IndexedNodeGraph","GRAPH_EVENT_START_MARKER_CHANGE","GraphStartMarkerInputHandler","_ghostMarker","_cachedMarkerTarget","setStartNode","getReachableState","reachable","startNode","getStartNode","GraphLayout","reachableNode","unreachable","unreachableNode","filter","numOfReachable","numOfUnreachable","numOfNode","maxNum","currentStep","degree","degree_re","degree_un","toBeRejected","getFinalStates","AbstractEventHandler","undoManager","ZoomInIcon","ZoomOutIcon","ZoomWidget","onZoomIn","bind","onZoomOut","viewportAdapter","viewScale","getScale","addScale","toFixed","Style","zoom_container","IconButton","zoom_button","title","onClick","zoom_label","PinpointIcon","FocusCenterWidget","setOffset","center_focus_button","disabled","getOffsetX","getOffsetY","ViewportNavigationLayer","navbar_container","navbar_widget_container","navbar_widget","children","JSONFileIcon","points","BoxAddIcon","SessionImporter","app","_app","session","fileData","getApp","getUndoManager","captureEvent","sessionData","fileName","fileType","projectName","getSession","currentModule","getCurrentModule","onParseSession","onPreImportSession","onImportSession","substring","setProjectName","onPostImportSession","Promise","resolve","HIGHLIGHT_LINE_ARRAY","GraphHighlightRenderer","strokeDashoffset","strokeDasharray","GraphHighlightLayer","highlights","nodes","edges","userClearGraph","graphOnly","callback","window","confirm","I18N","toString","getGraphController","_nodes","prev","downloadText","filename","textData","downloadURL","encodeURIComponent","url","element","document","createElement","headerIndex","setAttribute","display","body","appendChild","click","removeChild","PageContentIcon","AddIcon","SubtractIcon","CheckCircleIcon","CrossCircleIcon","PendingIcon","ViewportAdapter","_element","_offsetX","_offsetY","_nextOffsetX","_nextOffsetY","_offsetDamping","_scaleFactor","_minScale","_maxScale","scale","damping","clientX","clientY","ctm","getScreenCTM","a","f","immediate","dscale","InputContext","_inputHandlers","inputHandler","priority","eventName","eventArgs","handlerEventCallback","apply","InputPointer","inputAdapter","_inputAdapter","_viewportAdapter","_active","_x","_y","_inputpos","pos","LONG_TAP_TICKS","DOUBLE_TAP_TICKS","SCROLL_SENSITIVITY","CURSOR_RADIUS_SQU","CURSOR_RADIUS","DRAGGING_BUFFER_SQU","DRAGGING_BUFFER","InputAdapter","_contexts","_activeDragHandler","_cursor","_mousemove","_mouseup","_touchmove","_touchend","_timer","_pointer","_dragging","_altinput","_holdInputDelay","_dblInputDelay","_scrollSensitivity","_minTapRadius","_draggingRadiusSqu","_prevEmptyInput","_prevEmptyTime","_prevEmptyX","_prevEmptyY","onContextMenu","onMouseDown","onMouseMove","onTouchStart","onWheel","onMouseDownThenMove","onMouseDownThenUp","onTouchStartThenMove","onTouchStartThenEnd","onDelayedInputDown","context","unshift","SVGElement","setElement","addEventListener","onTouchMove","removeEventListener","update","handleEvent","stopPropagation","preventDefault","activeElement","blur","focus","button","ctrlKey","onInputDown","mouse","transformScreenToView","setPosition","cancelInputEvent","onInputMove","onInputUp","changedTouches","touch","deltaY","setScale","beginInput","setTimeout","onDragMove","getDistanceSquToInitial","inputEventPosition","getInputEventPosition","timer","clearTimeout","onDragStop","dist","dt","Date","now","endInput","isActive","SMOOTH_OFFSET_DAMPING","MIN_SCALE","MAX_SCALE","ViewportComponent","_ref","createRef","setMinScale","setMaxScale","setOffsetDamping","addInputHandler","initialize","destroy","viewport","baseViewSize","viewSize","halfViewSize","getViewportAdapter","getSVGViewBoxString","getSVGTransformString","ref","viewport_component","DEFAULT_MOVE_MODE_FIRST","InputController","_trashMode","_nodeOnly","_moveModeFirst","_handlingInput","_target","source","_activeTarget","input","_immediateTarget","_selectionBox","updateCurrentTarget","data","pointerEvent","isAltInput","ViewportInputHandler","hasCurrentTarget","addOffset","GraphView","_inputContext","_viewportComponent","_viewportInputHandler","inputContext","bindContext","clearInputHandlers","unbindContext","renderGraph","renderOverlay","TrashCanDetailedIcon","TrashCanWidget","_buttonElement","active","forceActive","_doubleTapTimeout","onMouseEnter","onMouseLeave","onAnyMouseDownNotConsumed","setState","onChange","onClear","documentElement","visible","hide","refButton","trash_container","MoveIcon","ModeTrayWidget","mode","tray_container","tray_button","EditPencilIcon","ViewportEditLayer","onTrashChange","onTrashClear","onModeChange","setTrashMode","getDrawerComponent","setViewportColor","clearGraph","setMoveModeFirst","moveMode","isHandlingInput","isMoveModeFirst","view_container","view_widget","bottom","right","isEmpty","isUsingTouch","isDragging","left","PNGIcon","JPGIcon","SVGIcon","PNGFileIcon","IMAGE_TYPE_PNG","NodalGraphImageExporter","imageType","_imageType","exportType","getProjectName","svgElement","getGraphView","getViewportComponent","getSVGElement","workspaceDim","baseVal","svg","processSVGForExport","fileExt","name","themeManager","attributeValue","startIndex","stopIndex","getStyleByName","getValue","rgb","ColorHelper","offsetX","offsetY","bounds","getBoundingRect","w","EXPORT_PADDING_X","h","EXPORT_PADDING_Y","clone","cloneNode","getThemeManager","getElementsByTagName","strokeValue","getAttribute","strokeResult","processColorAttribute","fillValue","fillResult","uiElements","getElementsByClassName","remove","BWIcon","SessionExporter","IMAGE_EXPORTERS","registerImageExporters","exportManager","exporter","registerExporter","getImageType","BoxRenderer","fromX","fromY","toX","toY","fillOpacity","getNodesWithin","x1","y1","x2","y2","SelectionBox","_boundingBox","targets","forceUpdate","box","mx","my","lx","ly","SelectionBoxInputHandler","beginSelection","isVisible","updateSelection","endSelection","SelectionBoxLayer","_selectionBoxInputHandler","setSelectionBox","inputPriority","removeInputHandler","selectionBoundingBox","getBoundingBox","LabelFormatter","nextLabel","nextNodeLabel","nextEdgeLabel","DEFAULT_LABEL_FORMATTER","DEFAULT_REFRESH_TICKS","GraphChangeHandler","refreshTicks","_cachedGraphHash","_refreshTicks","_elapsedTicks","Infinity","_listeners","listener","graphHash","getHashCode","GraphController","_graph","_graphChangeHandler","_labelEditor","_labelFormatter","labelEditor","eventData","onGraphEvent","defaultLabel","prevLabel","openEditor","GraphNodeRenderer","GraphNodeLayer","_graphNodeInputHandler","Renderer","nodeRenderer","editable","hasPointerEvents","StartNodeMarkerRenderer","_prevSize","IndexedGraphStartMarkerLayer","_startMarkerInputHandler","IndexedGraphStartMarkerInputHandler","startMarkerRenderer","getGhostMarker","GraphEdgeRenderer","start","end","edgeDir","getEdgeDirection","GraphEdgeLayer","_graphEdgeInputHandler","edgeRenderer","PatternInput","inputElement","placeholder","maxLength","multiLine","formatter","_submitTimeout","_submit","submitOnBlur","_skipBlur","_skipSelect","onFocus","onBlur","onKeyDown","select","submit","onSubmit","shiftKey","caretPosition","selectionStart","selectionEnd","ignore","separator","format","maxlength","multiline","rows","spellCheck","LabelEditorWidget","inputComponent","open","_targetCallback","onInputSubmit","onInputBlur","graphElement","defaultValue","onCancel","_targetOnSubmit","_targetOnCancel","getNodeLabelFormatter","setFormatter","getEdgeLabelFormatter","resetValue","closeEditor","isEditorOpen","targetStyle","getElement","parentClientRect","getBoundingClientRect","screenPos","transformViewToScreen","offsetWidth","offsetHeight","top","editor_container","saveOnExit","getUnreachableNodes","getNodeCount","nextNodes","nextNode","MAX_COMPUTATION_STEPS","solveFSA","Symbol","iterator","cachedStates","cachedSymbols","relatedState","counter","solveFSAByStep","nfa","nextStates","nextIndex","cstate","nextState","_accept","_custom","JSON","parse","nodeDatas","nodeCount","edgeDatas","edgeCount","initialIndex","nodeIndices","nodeData","setNodeAccept","setNodeCustom","initialNode","edgeData","sourceNode","destinationNode","quadData","objectify","graphNodes","graphEdges","graphInitial","accept","getNodeAccept","getNodeCustom","quad","getQuadratic","edgeSource","edgeDestination","sourceIndex","destinationIndex","initial","_version","XML","nodeElements","edgeElements","nodeElementIDs","nodeElement","nodeElementID","xElements","xElement","hasChildNodes","xValue","childNodes","parseFloat","nodeValue","yElements","yElement","yValue","initialElements","finalElements","boundingRect","transitionMapping","edgeElement","sourceID","fromElements","fromElement","fromValue","destinationID","toElements","toElement","toValue","readElements","readElement","readValue","transitionID","doc","DOMParser","parseFromString","structure","innerHTML","automaton","read","AbstractGraphLabeler","AbstractMachineController","module","machineBuilder","_module","_machineBuilder","Eventable","__eventListeners","mixin","targetClass","targetPrototype","prototype","Object","assign","registerEvent","unregisterEvent","listeners","clearEventListeners","countEventListeners","getEventListeners","on","once","args","emit","onEventProcessed","SafeGraphEventHandler","graphParser","_graphParser","_graphData","prevEvent","getPreviousEvent","applyRedo","PanelDivider","panel_divider","TriangleIcon","PanelCheckbox","checked","checkbox_container","htmlFor","Parser","PatternInputButton","_timeout","onAnyMouseUp","parent","ignoreBlur","DownArrowIcon","MachineChangeHandler","AbstractMachineBuilder","_machineChangeHandler","_warnings","onGraphChange","getGraphChangeHandler","addListener","removeListener","attemptBuildMachine","getMachine","machine","errors","warnings","DEFAULT_NODE_LABEL_PREFIX","edgeLabelFormatter","allowNull","symbolLength","trim","subsymbol","FSAGraphLabeler","_prefix","prefix","shouldAutoRenameNodes","otherNodes","nodeIndex","newNodeLabel","getDefaultNodeLabelPrefix","getNodesByLabel","DEFAULT_AUTO_RENAME","FSAGraphController","setLabelFormatter","setGraphController","shouldAutoLabel","edgeLabel","otherEdge","otherSymbols","getEdgeSymbolsFromLabel","parallelEdgeHeight","dist12sq","vertical","m","b","x0","y0","dist02sq","formatEdge","applyAutoRename","getNotificationManager","pushNotification","WARNING_LAYOUT_ID","applyLayout","graphLabeler","enable","selectedNode","selection","deleteTargetEdge","random","getGraphLabeler","newLabel","FSABuilder","_machine","nodeMapping","getTransitions","startNodes","nodeLabels","nodeOutgoings","edgeSymbols","edgePlaceholders","edgeEmpties","graphStart","nodeLabel","srcNode","dstNode","srcState","getStateByID","dstState","edgeLabelSymbols","transitionSymbol","outSymbols","outEdges","sharedStates","getSource","unreachables","missingSymbols","edgeMapping","MachineController","machineType","getMachineType","setMachineType","attemptBuildGraph","currentMachineType","getMachineBuilder","setGraphToMachine","changeMachineTo","getStateCount","addCustomSymbol","removeCustomSymbol","prevSymbol","nextSymbol","replace","renameCustomSymbol","getCustomSymbols","setCustomSymbol","clearCustomSymbols","TestTapeContext","tester","machineController","getTestString","_tester","_machineController","stepForward","stepBackward","resetPosition","runTest","stopTest","_tapeInput","getNodesAtPosition","changePosition","getPosition","inputString","infiniteLeft","infiniteRight","_left","_right","_index","finish","reset","StringTester","_testString","_testIndex","_tapeContext","_cachePath","_cachedResult","_resolve","_reject","testString","reject","testResult","thenStop","then","isResult","currentState","prevCache","cachedState","nextCache","NFAToDFAConversionNotificationLayout","notification","convertMachineTo","close","stateCount","countStates","DefaultNotificationLayout","styleType","STYLE_TYPE_WARNING","pow","StateNotificationLayout","_targetIndex","_targetLabel","message","targetLength","moveViewToPosition","deleteTargetNodes","STYLE_TYPE_ERROR","text","ARROW","TransitionNotificationLayout","targetIndex","targetLabel","graphView","deleteTargetEdges","StateMissingTransitionNotificationLayout","StateUnreachableNotificationLayout","MACHINE_CONVERSION_LAYOUT_ID","STATE_LAYOUT_ID","TRANSITION_LAYOUT_ID","STATE_MISSING_LAYOUT_ID","STATE_UNREACHABLE_LAYOUT_ID","FSAErrorChecker","_showErrorOnChange","onMachineChange","getMachineChangeHandler","showErrors","enabled","getMachineErrors","getMachineWarnings","notificationManager","clearNotifications","SUCCESS_LAYOUT_ID","warning","FSAImporter","jsonGraphParser","_prevGraphHash","getMachineController","machineData","customSymbols","isArray","statePrefix","setDefaultNodeLabelPrefix","loadMachineFromData","nextGraphHash","FSAJFFImporter","jffGraphParser","FSAExporter","graphData","XMLFileIcon","FSAJFFExporter","XMLSerializer","serializeToString","MessageHandler","_broadcastManager","broadcastManager","FSABroadcastHandler","targetSessionID","sendMessageTo","JSONGraphParser","attemptBuild","currentMachine","alert","BroadcastHandler","TutorialHandler","forceStart","LocalStorage","getData","SEQUENCE_LAYOUT_ID","setData","StateListElement","onValueChange","onKeyUp","keyCode","inputValue","nodeCustom","nodeAccept","displayValue","element_container","StateListView","_prevX","_prevY","onElementAdd","onElementFocus","onElementBlur","onElementChange","renameNode","deleteTargetNode","list_container","element_list","first_marker","add_button","AlphabetListElement","_inputElement","inputSymbol","displaySymbol","symbolUsed","used","AlphabetListView","newSymbolComponent","useNewSymbol","isSymbol","renameSymbol","createSymbol","deleteSymbol","renderAlphabetList","TransitionChartView","_cachedMachineHash","_cachedMachineComponents","destinations","transitionString","chart_key","chart_value","machineHash","entry","renderTransitionEntry","chart_container","fontFamily","renderTransitionTable","SYMBOL_AXIS","TransitionTableView","rowAxis","onRowAxisSwitch","table_entry","rowComponents","renderTableEntryForSymbolAxis","getTransitionSymbols","scope","table_axis_header","table_container","renderTableAxis","renderTableEntries","AutoStateLabelView","onAutoStatePrefixSubmit","onAutoStatePrefixFormat","select_container","select_label","FormattedInput","prefix_editor","captureOnExit","postfix_selector","onMachineTypeChange","OverviewPanel","onAutoLayoutApply","onAutoLayoutChange","onAutoLabelChange","onSnapToGridChange","newValue","applyAutoLayout","setAutoRenameNodes","drawer","autoRename","drawerFull","isDrawerFullscreen","PanelContainer","TITLE","machine_type_select","PanelSection","full","getEdgeCount","autolayout_button","PanelSwitch","defineProperty","DEFAULT_MODE","TestItem","status","nextValue","onDelete","onTest","test_item_container","test_button","test_input","subtitle","delete_button","ACCEPT_FILE_TYPES","TEST_FILENAME","TestListView","_testList","_testName","onTestNew","onTestUpload","onTestDownload","onTestClose","onTestAdd","onTestDelete","onTestTest","onTestRunAll","resetStatus","fileBlob","reader","FileReader","onload","event","tests","test","abort","readAsText","testStrings","isTesting","nextTest","item","forceImmediate","itemValue","startTest","err","promise","empty","test_container","test_control_tray","test_control_button","IconUploadButton","onUpload","UploadIcon","DownloadIcon","CrossIcon","test_list_container","test_list_add","test_list_count","test_list_scroll_container","test_list","testCallback","test_list_runall","TestingPanel","stepMode","onStepTestChange","onAutoErrorCheckChange","_testMode","_drawer","setDrawerSoloClass","closeDrawer","openDrawer","errorChecker","getErrorChecker","errorCheck","isErrorChecking","setErrorChecking","getStringTester","panel_container","FSAGraphParser","AnalysisPanel","isEqual","optimizeUnreachOption","optimizeRedundOption","onConvertToDFA","onConvertToNFA","onInvertDFA","onEquivalentTest","onOptimizeMachine","onFileUpload","unreachableArray","invertMachine","TextUploader","uploadFile","equivalenceResult","isChecked","onDeleteAllUnreachable","files","analysis_button","canOptimize","upload_input","FSANodeRenderer","FSANodeInputHandler","FSAEdgeRenderer","FSAGraphLayer","getInputController","_fsaNodeInputHandler","getInputContext","testTargetNodes","getGraphEdgeInputHandler","setShouldDeleteEdgeWithEmptyLabel","setShouldDeleteEdgePlaceholder","RECOMMENDED_SYMBOLS","DEFAULT_SYMBOLS","FSALabelEditorRenderer","getLabelEditor","appendValue","showEdgeTray","getTarget","showNodeTray","showRecommended","tray_used","renderSymbol","tray_default","FSAGraphOverlayLayer","setLabelEditor","TapeWidget","onTapeStepBackward","onTapeStepForward","onTapeFinish","onTapeReset","onTapeSkipForward","onTapeSkipBackward","onTapeStop","stop","tapeContext","tapeIndex","getCurrentTapeIndex","tape_container","tape_control_tray","isTapeLeftInfinite","opacity","getTapeInput","activeRead","sourceStates","getTapeSourceStatesByIndex","setCurrentTapeIndex","sourceState","isTapeRightInfinite","FSATapeGraphOverlayLayer","getTapeContext","FSAModule","_graphViewComponent","getRenderManager","addRenderer","RENDER_LAYER_WORKSPACE","_errorChecker","_broadcastHandler","_tutorialHandler","registerNotificationLayout","getExportManager","getImportManager","addImporter","setEventHandlerFactory","getDrawerManager","addPanelClass","marginRight","margin","flex","getHotKeyManager","registerHotKey","CTRL_KEY","tryExportFile","getMenuManager","setSubtitleComponentClass","getTooltipManager","addTooltip","getBroadcastManager","addMessageHandler","getToolbarComponent","closeBar"],"mappings":"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","file":"module_fsa.bundle.315bba53011c0f5f807b.js","sourcesContent":["import GraphElement from './GraphElement.js';\n\n/**\n * A class that represents the node elements of a graph.\n *\n * @see {@link NodeGraph}\n * @extends GraphElement\n */\nclass GraphNode extends GraphElement\n{\n    /**\n   * Creates a node with the unique id.\n   * \n   * @param {String} id         the element id for this node.\n   * @param {Number} [x=0]      the initial x position\n   * @param {Number} [y=0]      the initial y position\n   */\n    constructor(id, x = 0, y = 0)\n    {\n        super(id);\n\n        this.x = x;\n        this.y = y;\n    \n        this._label = '';\n    }\n\n    /** @override */\n    getCenterPoint(dst={x: 0, y: 0})\n    {\n        dst.x = this.x;\n        dst.y = this.y;\n        return dst;\n    }\n\n    /**\n   * Sets the node label to the passed-in string.\n   *\n   * Assumes the label is NOT null.\n   * @param {String} label  The new node label.\n   * @returns {this}\n   */\n    setNodeLabel(label)\n    {\n        this._label = label;\n        return this;\n    }\n\n    /**\n   * Gets the label of the node. If the node has no label, it will return an\n   * empty string.\n   * @returns {String} The node's label.\n   */\n    getNodeLabel() { return this._label; }\n\n    /**\n   * Gets the size of the node. Can be overriden to specify a different size.\n   * @returns {Number} The radius of the node.\n   */\n    getNodeSize() { return 16; }\n\n    /** @override */\n    getHashString(usePosition=true)\n    {\n        if (usePosition)\n        {\n            return super.getHashString(usePosition) + ':' +\n        Math.floor(this.x) + ',' + Math.floor(this.y) + '.' + this._label;\n        }\n        else\n        {\n            return super.getHashString(usePosition) + ':' + this._label;\n        }\n    }\n}\n\nexport default GraphNode;\n","import GraphElement from './GraphElement.js';\n\n/**\n * A class that represents the edge elements of a graph.\n * \n * @see {@link NodeGraph}\n * @extends GraphElement\n */\nclass GraphEdge extends GraphElement\n{\n    /**\n     * Creates a edge with the unique id.\n     * \n     * @param {String} id           The element id for this node.\n     * @param {GraphNode} from      The from node of the edge.\n     * @param {GraphNode} [to=null] The to node of the edge.\n     */\n    constructor(id, from, to=null)\n    {\n        super(id);\n\n        this._from = from;\n        this._to = to;\n\n        this._label = '';\n    }\n\n    setEdgeFrom(node)\n    {\n        if (!node) throw new Error('Source of edge cannot be null');\n\n        this._from = node;\n        return this;\n    }\n\n    setEdgeTo(node)\n    {\n        this._to = node;\n        return this;\n    }\n\n    /**\n     * Sets the edge label to the passed-in string.\n     *\n     * Assumes the label is NOT null.\n     * @param {String} label  The new edge label.\n     * @returns {this}\n     */\n    setEdgeLabel(label)\n    {\n        this._label = label;\n        return this;\n    }\n\n    getEdgeDirection()\n    {\n        const from = this._from;\n        const to = this._to;\n        const HALFPI = Math.PI / 2;\n        let result = 0;\n\n        if (this.isPlaceholder())\n        {\n            result = Math.PI / 4;\n        }\n        else\n        {\n            const dy = to.y - from.y;\n            const dx = to.x - from.x;\n            result = Math.atan2(dy, dx);\n        }\n\n        if (result > HALFPI || result < -HALFPI)\n        {\n            result += Math.PI;\n        }\n\n        return result;\n    }\n\n    getStartPoint(dst = { x: 0, y: 0 })\n    {\n        const from = this._from;\n        dst.x = from.x;\n        dst.y = from.y;\n        return dst;\n    }\n\n    /** @override */\n    getCenterPoint(dst = { x: 0, y: 0 })\n    {\n        const from = this._from;\n        const to = this._to;\n        if (this.isPlaceholder())\n        {\n            const halfPlaceholderLength = this.getPlaceholderLength() / 2;\n            dst.x = from.x + halfPlaceholderLength;\n            dst.y = from.y + halfPlaceholderLength;\n        }\n        else\n        {\n            dst.x = from.x + (to.x - from.x) / 2;\n            dst.y = from.y + (to.y - from.y) / 2;\n        }\n        return dst;\n    }\n\n    getEndPoint(dst = { x: 0, y: 0 })\n    {\n        if (this.isPlaceholder())\n        {\n            const from = this._from;\n            const placeholderLength = this.getPlaceholderLength();\n            dst.x = from.x + placeholderLength;\n            dst.y = from.y + placeholderLength;\n        }\n        else\n        {\n            const to = this._to;\n            dst.x = to.x;\n            dst.y = to.y;\n        }\n        return dst;\n    }\n\n    getPlaceholderLength() { return this._from.getNodeSize(); }\n    isPlaceholder() { return this._to === null; }\n    isSelfLoop() { return this._from === this._to; }\n\n    /**\n     * Gets the label of the edge. If the edge has no label, it will return an\n     * empty string.\n     * @returns {String} The edge's label.\n     */\n    getEdgeLabel() { return this._label; }\n\n    getEdgeFrom() { return this._from; }\n    getEdgeTo() { return this._to; }\n\n    /** @override */\n    getHashString(usePosition = true)\n    {\n        const src = this._from ? this._from.getHashString(usePosition) : '';\n        // HACK: to may be a pointer, which is not a node, so getHashString does not exist.\n        const dst = this._to ? this._to.getHashString ? this._to.getHashString(usePosition) : '0' : '';\n        return super.getHashString(usePosition) + ':' + src + ',' + dst + '.' + this._label;\n    }\n}\n\nexport default GraphEdge;","/**\n * Used by InputAdapter to handle input event logic.\n */\nclass AbstractInputHandler\n{\n    constructor() {}\n\n    /**\n   * Called by InputAdapter before an InputEvent begins.\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not begin.\n   */\n    onPreInputEvent(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter when an InputEvent resolves and is not an Alt input.\n   * To handle events for Alt inputs, refer to onAltInputEvent().\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not propagate to trigger other events.\n   */\n    onInputEvent(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter when an InputEvent resolves and is an Alt input.\n   * To handle events for non-Alt inputs, refer to onInputEvent().\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not propagate to trigger other events.\n   */\n    onAltInputEvent(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter when a DblInputEvent resolves. The input is\n   * assumed by a non-Alt input, since only non-Alt inputs can trigger this\n   * event.\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not propagate to trigger other events.\n   */\n    onDblInputEvent(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter when input moves. The input is called before drag\n   * logic.\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not propagate to trigger other events (i.e. dragging events).\n   */\n    onMoveInputEvent(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter before a drag begins. The input could be either\n   * an Alt or non-Alt input.\n   * Returns true if the event should be consumed. If consumed, the event will\n   * not propagate to trigger other events, and then it will continue the drag\n   * input events for the current handler only.\n   * \n   * NOTE: A drag does not start immediately on move. There is a radius to\n   * compensate for mobile users. Therefore pointer.x and pointer.y refer to\n   * the offset position. To get the starting pointer position, use\n   * pointer.getInputEventPosition().\n   */\n    onDragStart(pointer) { return false; }\n\n    /**\n   * Called by InputAdapter while dragging moves. The input could be either\n   * an Alt or non-Alt input.\n   * Will always be called after onDragStart() and will be followed by\n   * onDragStop() when complete.\n   */\n    onDragMove(pointer) {}\n\n    /**\n   * Called by InputAdapter after a drag ends. The input could be either an\n   * Alt or non-Alt input.\n   * Will always be called after onDragStart(). Although onDragMove may be\n   * called in-between, it is not guaranteed.\n   */\n    onDragStop(pointer) {}\n\n    /**\n   * Called by InputAdapter after an InputEvent ends.\n   */\n    onPostInputEvent(pointer) {}\n\n    /**\n   * Called by InputAdapter when zoom changes.\n   * Returns true if event is consumed (zoom will not be applied)\n   */\n    onZoomChange(pointer, zoomValue, prevValue)\n    {\n        return false;\n    }\n}\n\nexport default AbstractInputHandler;","import React from 'react';\n\nconst INPUT_MASK_NODE_RADIUS_OFFSET = 4;\n\nexport const EVENT_SOURCE_NODE = 'node';\n\nexport const DefaultNodeShapeRenderer = props => (\n    <React.Fragment>\n        <circle cx={props.position.x} cy={props.position.y}\n            r={props.radius}\n            fill={props.color}\n            stroke={props.outline} />\n        {(props.onMouseOver || props.onMouseOut) &&\n            <circle cx={props.position.x} cy={props.position.y}\n                r={props.radius + INPUT_MASK_NODE_RADIUS_OFFSET}\n                fill=\"transparent\"\n                cursor=\"pointer\"\n                onMouseOver={props.onMouseOver}\n                onMouseOut={props.onMouseOut}\n                pointerEvents={props.pointerEvents} />}\n    </React.Fragment>\n);\n\nexport const DefaultLabelRenderer = props => (\n    <text x={props.position.x} y={props.position.y + 4}\n        pointerEvents=\"none\"\n        style={{\n            userSelect: 'none',\n            fontSize: `${(1 - Math.min(Math.max(props.label.length - 2, 0) / 6, 0.5))}em`\n        }}\n        textAnchor=\"middle\"\n        fill={props.color}>\n        {props.label}\n    </text>\n);\n\nclass NodeRenderer extends React.Component\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        const position = this.props.position;\n        const radius = this.props.radius || 16;\n        const label = this.props.label || '';\n        const color = this.props.color || '#FFFFFF';\n        const outline = this.props.outline || '#000000';\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents || 'visiblePainted';\n\n        const NodeShapeRenderer = DefaultNodeShapeRenderer;\n        const NodeLabelRenderer = DefaultLabelRenderer;\n\n        return (\n            <g>\n                {NodeShapeRenderer &&\n                    <NodeShapeRenderer\n                        position={position}\n                        radius={radius}\n                        color={color}\n                        outline={outline}\n                        onMouseOver={onMouseOver ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_NODE;\n                            onMouseOver(e);\n                        } : null}\n                        onMouseOut={onMouseOut ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_NODE;\n                            onMouseOut(e);\n                        } : null}\n                        pointerEvents={pointerEvents} />}\n                {NodeLabelRenderer &&\n                    <NodeLabelRenderer\n                        position={position}\n                        label={label}\n                        color={outline} />}\n            </g>\n        );\n    }\n}\n\nexport default NodeRenderer;\n","/**\n * A class that represents any positioned, unique object in a graph. Usually\n * this is not instantiated, but rather extended. Look at {@link NodeElement}\n * and {@link EdgeElement} as examples.\n */\nclass GraphElement\n{\n    /**\n   * Creates an element with the unique id.\n   * \n   * @param {Number} elementID The unique id that represents the element.\n   */\n    constructor(elementID)\n    {\n        this._id = elementID;\n    }\n\n    /**\n   * Sets the element's id to the passed-in id.\n   * @param {String} elementID  The new id.\n   * @returns {this}\n   */\n    setGraphElementID(elementID)\n    {\n        this._id = elementID;\n        return this;\n    }\n\n    /**\n   * Compute the center point of the element and store the result in dst. The\n   * properties changed in dst are: x, y.\n   * @param  {Object} [dst={x: 0, y: 0}]    The object to store the result.\n   * @returns {Object}                       The passed-in dst.\n   */\n    getCenterPoint(dst = { x: 0, y: 0 })\n    {\n        dst.x = dst.y = 0;\n        return dst;\n    }\n\n    /**\n   * A unique identifier for this graph element\n   * @returns {String} The unique identifier for this element.\n   */\n    getGraphElementID() { return this._id; }\n\n    /**\n   * Computes the hash string that represents this element and its current state\n   * uniquely and deterministically. {@link NodeGraph} uses this to compute its\n   * hash code that distinguishes it from other graphs. The generated string\n   * should only be used to differentiate between other objects of the same hash\n   * function. In other words, every instance should only be compared to other\n   * instances of the same class (or extended class without override).\n   * @param  {Boolean} [usePosition=true] Whether to consider positioning as\n   *                                      part of the unique state.\n   * @returns {String}                     The hash string that represents this\n   *                                      current state.\n   */\n    getHashString(usePosition = true) { return this._id; }\n}\n\nexport default GraphElement;\n","import GraphElement from 'graph2/element/GraphElement.js';\nimport { guid, stringHash } from 'util/MathHelper.js';\n\n// const FROM_STATE_INDEX = 0;\nconst SYMBOL_INDEX = 1;\nconst TO_STATE_INDEX = 2;\n\nexport const EMPTY_SYMBOL = '&empty';\n\nexport class State\n{\n    constructor(label = '', src = null)\n    {\n        this._label = label;\n\n        this._src = src;\n        this._id = src instanceof GraphElement ? src.getGraphElementID() : guid();\n    }\n\n    copy()\n    {\n        const result = new State();\n        result._label = this._label;\n        result._src = this._src;\n        result._id = this._id;\n        return result;\n    }\n\n    getStateLabel() { return this._label; }\n\n    getStateID() { return this._id; }\n    getSource() { return this._src; }\n\n    getHashString()\n    {\n        return this._id;\n    }\n}\n\nexport class Transition\n{\n    constructor(from, to, symbols = [])\n    {\n        this._from = from;\n        this._to = to;\n        this._symbols = symbols;\n    }\n\n    copy()\n    {\n        const result = new Transition();\n        result._from = this._from;\n        result._to = this._to;\n        result._symbols = this._symbols.slice();\n        return result;\n    }\n\n    getSourceState() { return this._from; }\n    getDestinationState() { return this._to; }\n\n    addSymbol(symbol) { this._symbols.push(symbol); }\n    hasSymbol(symbol) { return this._symbols.includes(symbol); }\n    getSymbols() { return this._symbols; }\n\n    getHashString()\n    {\n        return this._from.getHashString() + ':' + this._symbols.join(',') + ':' + this._to.getHashString();\n    }\n}\n\nclass FSA\n{\n    constructor(deterministic = false)\n    {\n        //state id -> state\n        this._states = new Map();\n        //symbol -> symbol use counter\n        this._alphabet = new Map();\n        //transition key (from + to) -> transition object\n        this._transitions = new Map();\n        this._finalStates = new Set();\n        this._customSymbols = new Set();\n        this._startState = null;\n\n        this._deterministic = deterministic;\n        this._errors = [];\n    }\n\n    /**\n   * Performs a shallow copy of the 2 machines. Any changes to a state will be\n   * reflected in both. However, changes to transitions, alphabet, and final\n   * states will not propagate.\n   */\n    copy(fsa)\n    {\n        //You are already yourself, don't copy nothing.\n        if (fsa === this) return;\n\n        //Make room for the copy...\n        this.clear();\n\n        //Copy state\n        for (const [key, value] of fsa._states.entries())\n        {\n            const result = value.copy();\n            this._states.set(key, result);\n\n            //Copy start state\n            if (fsa.isStartState(value))\n            {\n                this._startState = result;\n            }\n            //Copy final states\n            if (fsa.isFinalState(value))\n            {\n                this._finalStates.add(result);\n            }\n        }\n        //Copy alphabet\n        for (const [key, value] of fsa._alphabet.entries())\n        {\n            this._alphabet.set(key, value);\n        }\n        //Copy transitions\n        for (const [key, value] of fsa._transitions.entries())\n        {\n            const result = value.copy();\n            result._from = this._states.get(value.getSourceState().getStateID());\n            result._to = this._states.get(value.getDestinationState().getStateID());\n            this._transitions.set(key, result);\n        }\n        //Copy custom symbols\n        for (const symbol of fsa._customSymbols)\n        {\n            this._customSymbols.add(symbol);\n        }\n\n        //Copy determinism\n        this._deterministic = fsa._deterministic;\n\n        //Copy errors\n        for (const error of fsa._errors)\n        {\n            //WARNING: if the error's store state objects, they need to be redirected to the copies\n            this._errors.push(error);\n        }\n    }\n\n    clear()\n    {\n        this._states.clear();\n        this._alphabet.clear();\n        this._transitions.clear();\n        this._finalStates.clear();\n        this._customSymbols.clear();\n        this._startState = null;\n\n        this._errors.length = 0;\n    }\n\n    setDeterministic(deterministic) { this._deterministic = deterministic; }\n    isDeterministic() { return this._deterministic; }\n\n    validate()\n    {\n        //Reset errors\n        this._errors.length = 0;\n\n        if (this._deterministic)\n        {\n            const foundSymbols = new Map();\n            for (const key of this._alphabet.keys())\n            {\n                foundSymbols.set(key, false);\n            }\n\n            for (const state of this._states.values())\n            {\n                //Get all outgoing transitions\n                const transitions = this.getOutgoingTransitions(state);\n                for (const transition of transitions)\n                {\n                    const symbol = transition[SYMBOL_INDEX];\n\n                    //We don't need to worry about empty symbols cause this is a DFA\n                    //So just assume every symbol is a valid one\n                    if (!foundSymbols.get(symbol))\n                    {\n                        foundSymbols.set(symbol, true);\n                    }\n                    else\n                    {\n                        //Found duplicate\n                        this._errors.push('duplicate symbol: ' + symbol);\n                        return false;\n                    }\n                }\n\n                //Reset foundSymbols for next state\n                for (const key of foundSymbols.keys())\n                {\n                    if (!foundSymbols.get(key))\n                    {\n                        //Found missing symbol for state\n                        this._errors.push('missing symbol: ' + key);\n                        return false;\n                    }\n\n                    //Reset found symbol\n                    foundSymbols.set(key, false);\n                }\n            }\n\n            //No errors found\n            this._errors.length = 0;\n            return true;\n        }\n        else\n        {\n            //It is a valid NFA already\n            this._errors.length = 0;\n            return true;\n        }\n    }\n    isValid() { return this._errors.length == 0; }\n    getErrors() { return this._errors; }\n\n    createState(label = '')\n    {\n        return this.addState(new State(label));\n    }\n\n    addState(state)\n    {\n        const stateID = state.getStateID();\n        if (this._states.has(stateID)) throw new Error('Already added state with id \\'' + stateID + '\\'');\n        //Make state as new start state if no other states exist...\n        if (this._states.size <= 0) this._startState = state;\n        //Add to state set\n        this._states.set(stateID, state);\n        return state;\n    }\n\n    removeState(state)\n    {\n        const stateID = state.getStateID();\n        if (!this._states.has(stateID)) return false;\n        this._states.delete(stateID);\n\n        //Deleted the start state, so must pick another one...\n        if (this._startState === state)\n        {\n            if (this._states.size <= 0)\n            {\n                //If no more states to choose from, don't choose anything\n                this._startState = null;\n            }\n            else\n            {\n                //Choose an arbitrary start state\n                this._startState = this._states.values().next().value;\n            }\n        }\n\n        return true;\n    }\n\n    hasStateWithLabel(label)\n    {\n        for (const state of this._states.values())\n        {\n            if (state.getStateLabel() == label)\n            {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    getStatesByLabel(label, dst = [])\n    {\n        for (const state of this._states.values())\n        {\n            if (state.getStateLabel() == label)\n            {\n                dst.push(state);\n            }\n        }\n        return dst;\n    }\n\n    getStateByID(id)\n    {\n        return this._states.get(id);\n    }\n\n    hasState(state) { return this._states.has(state.getStateID()); }\n\n    getStates() { return this._states.values(); }\n\n    getStateCount() { return this._states.size; }\n\n    addTransition(from, to, symbol)\n    {\n        if (!this.hasState(from)) throw new Error('Trying to add a transition to unknown state with label \\'' + from.getStateLabel() + '\\'');\n        if (!this.hasState(to)) throw new Error('Trying to add a transition to unknown state with label \\'' + to.getStateLabel() + '\\'');\n        if (!symbol) throw new Error('Cannot add transition for null symbol - use the empty symbol instead');\n\n        const transitionKey = from.getStateID() + '->' + to.getStateID();\n        if (this._transitions.has(transitionKey))\n        {\n            const transition = this._transitions.get(transitionKey);\n            if (!transition.hasSymbol(symbol))\n            {\n                transition.addSymbol(symbol);\n            }\n            else\n            {\n                //Didn't add anything...\n                return false;\n            }\n        }\n        else\n        {\n            this._transitions.set(transitionKey, new Transition(from, to, [symbol]));\n        }\n\n        //Add to alphabet...\n        this._incrSymbolCount(symbol);\n        return true;\n    }\n\n    removeTransition(from, to, symbol = null)\n    {\n        const transitionKey = from.getStateID() + '->' + to.getStateID();\n        if (!this._transitions.has(transitionKey)) return false;\n\n        const transition = this._transitions.get(transitionKey);\n        const symbols = transition.getSymbols();\n\n        //If deleting a specific symbol...\n        if (symbol)\n        {\n            const index = symbols.indexOf(symbol);\n            if (index >= 0)\n            {\n                //Update symbol counts...\n                this._decrSymbolCount(symbol);\n\n                symbols.splice(index, 1);\n                if (symbols.length <= 0) this._transitions.delete(transitionKey);\n                return true;\n            }\n            else\n            {\n                return false;\n            }\n        }\n        //If deleting a all associated symbols...\n        else\n        {\n            //Update symbol counts...\n            for (const symbol of symbols)\n            {\n                this._decrSymbolCount(symbol);\n            }\n\n            //Remove transition\n            this._transitions.delete(transitionKey);\n            return true;\n        }\n    }\n\n    hasTransition(from, to, symbol = null)\n    {\n        const transitionKey = from.getStateID() + '->' + to.getStateID();\n        if (!this._transitions.has(transitionKey)) return false;\n        //Not checking for specific symbols...\n        if (!symbol) return true;\n\n        //Find the symbol...\n        return this._transitions.get(transitionKey).hasSymbol(symbol);\n    }\n\n    getTransitionSymbols(from, to)\n    {\n        const transitionKey = from.getStateID() + '->' + to.getStateID();\n        if (!this._transitions.has(transitionKey)) return null;\n        return this._transitions.get(transitionKey).getSymbols();\n    }\n\n    getTransitions() { return this._transitions.values(); }\n\n    _incrSymbolCount(symbol)\n    {\n        //Don't add empty symbol to the alphabet\n        if (symbol === EMPTY_SYMBOL) return;\n\n        const symbolCount = this._alphabet.get(symbol) || 0;\n        this._alphabet.set(symbol, symbolCount + 1);\n    }\n\n    _decrSymbolCount(symbol)\n    {\n        if (!this._alphabet.has(symbol)) throw new Error('Unable to find valid transition symbol in alphabet');\n\n        //Empty symbol is not in the alphabet\n        if (symbol === EMPTY_SYMBOL) return;\n\n        const symbolCount = this._alphabet.get(symbol);\n        //Delete the symbol, since it is no longer used...\n        if (symbolCount <= 1)\n        {\n            if (!this.isCustomSymbol(symbol))\n            {\n                //Regular symbols are removed if unused...\n                this._alphabet.delete(symbol);\n            }\n            else\n            {\n                //Custom symbols stay in the alphabet, even if unused...\n                this._alphabet.set(symbol, 0);\n            }\n        }\n        else\n        {\n            //Still being used by someone...\n            this._alphabet.set(symbol, symbolCount - 1);\n        }\n    }\n\n    changeSymbol(symbol, newSymbol)\n    {\n        if (symbol === EMPTY_SYMBOL) throw new Error('Cannot change the empty symbol');\n        if (newSymbol === EMPTY_SYMBOL) throw new Error('Cannot change to the empty symbol');\n        if (this._alphabet.has(newSymbol)) throw new Error('Cannot change symbol to another existing symbol');\n\n        for (const transition of this._transitions.values())\n        {\n            const symbols = transition.getSymbols();\n            const index = symbols.indexOf(symbol);\n\n            //Change the symbol from the transition\n            if (index >= 0)\n            {\n                symbols[index] = newSymbol;\n            }\n        }\n\n        //Exchange symbol counts...\n        const count = this._alphabet.get(symbol);\n        this._alphabet.set(newSymbol, count);\n        this._alphabet.delete(symbol);\n\n        //Check if custom symbol...\n        if (this._customSymbols.has(symbol))\n        {\n            this._customSymbols.delete(symbol);\n            this._customSymbols.add(newSymbol);\n        }\n    }\n\n    removeSymbol(symbol)\n    {\n        const cache = [];\n        for (const [key, transition] of this._transitions.entries())\n        {\n            const symbols = transition.getSymbols();\n            const index = symbols.indexOf(symbol);\n\n            //Delete the symbol from the transition\n            if (index >= 0)\n            {\n                symbols.splice(index, 1);\n\n                //If no more symbols, make sure to delete it from the map later...\n                if (symbols.length <= 0)\n                {\n                    cache.push(key);\n                }\n            }\n        }\n\n        //Delete any transitions that have no more symbols...\n        for (const transitionKey of cache)\n        {\n            this._transitions.delete(transitionKey);\n        }\n\n        //Remove from alphabet if possible...\n        if (symbol !== EMPTY_SYMBOL)\n        {\n            if (this._customSymbols.has(symbol))\n            {\n                this._alphabet.set(symbol, 0);\n            }\n            else\n            {\n                this._alphabet.delete(symbol);\n            }\n        }\n    }\n\n    setCustomSymbol(symbol, custom = true)\n    {\n        if (symbol === EMPTY_SYMBOL) throw new Error('Cannot change the empty symbol as a custom symbol');\n\n        if (custom)\n        {\n            if (!this._customSymbols.has(symbol))\n            {\n                this._customSymbols.add(symbol);\n\n                //Add symbol to alphabet if missing...\n                if (!this._alphabet.has(symbol)) this._alphabet.set(symbol, 0);\n            }\n        }\n        else\n        {\n            if (this._customSymbols.has(symbol))\n            {\n                this._customSymbols.delete(symbol);\n\n                //If symbol is unused, delete it\n                if (this._alphabet.has(symbol) && this._alphabet.get(symbol) <= 0) this._alphabet.delete(symbol);\n            }\n        }\n    }\n\n    isCustomSymbol(symbol)\n    {\n        return this._customSymbols.has(symbol);\n    }\n\n    getCustomSymbols()\n    {\n        return this._customSymbols;\n    }\n\n    clearCustomSymbols()\n    {\n        this._customSymbols.clear();\n    }\n\n    isUsedSymbol(symbol)\n    {\n        return this._alphabet.has(symbol) && this._alphabet.get(symbol) > 0;\n    }\n\n    isSymbol(symbol)\n    {\n        return this._alphabet.has(symbol);\n    }\n\n    getAlphabet()\n    {\n        return this._alphabet.keys();\n    }\n\n    setStartState(state)\n    {\n        const stateID = state.getStateID();\n        if (!this._states.has(stateID))\n        {\n            //Add it to the state set\n            this._states.set(stateID, state);\n        }\n        this._startState = state;\n    }\n    isStartState(state) { return this._startState === state; }\n    getStartState() { return this._startState; }\n\n    setFinalState(state, final = true)\n    {\n        //Make final\n        if (final)\n        {\n            //If missing from state set, add it in...\n            if (!this._states.has(state.getStateID()))\n            {\n                this.addState(state);\n            }\n\n            this._finalStates.add(state);\n        }\n        else\n        {\n            //If missing from state set, it would be effectively the same thing as\n            //calling addState(state). So due to ambiguity, don't do it.\n            if (!this._states.has(state.getStateID())) throw new Error('Trying to change final for missing state \\'' + state.getStateLabel() + '\\'');\n\n            this._finalStates.delete(state);\n        }\n    }\n    isFinalState(state) { return this._finalStates.has(state); }\n    getFinalStates() { return this._finalStates; }\n\n    doTransition(state, symbol, forceNondeterminism = false, dst = [])\n    {\n        if (!state) return dst;\n        if (!(state instanceof State)) throw new Error('Invalid state instance type \\'' + (typeof state) + '\\'');\n        if (!this._states.has(state.getStateID())) throw new Error('Unable to find source state with id \\'' + state.getStateID() + '\\'');\n\n        if (!symbol) symbol = EMPTY_SYMBOL;\n\n        const fromTransitionKey = state.getStateID() + '->';\n        for (const key of this._transitions.keys())\n        {\n            if (key.startsWith(fromTransitionKey))\n            {\n                const transition = this._transitions.get(key);\n                if (transition.hasSymbol(symbol))\n                {\n                    dst.push(transition.getDestinationState());\n\n                    //There will only ever be 1 transition for deterministic machines\n                    if (!forceNondeterminism && this._deterministic) return dst;\n                }\n            }\n        }\n        return dst;\n    }\n\n    doTerminalTransition(state, symbol, dst = [])\n    {\n        if (!state) return dst;\n        if (!this._states.has(state.getStateID())) throw new Error('Unable to find source state with id \\'' + state.getStateID() + '\\'');\n\n        if (!symbol) symbol = EMPTY_SYMBOL;\n\n        const fromTransitionKey = state.getStateID() + '->';\n        for (const key of this._transitions.keys())\n        {\n            if (key.startsWith(fromTransitionKey))\n            {\n                const transition = this._transitions.get(key);\n                if (transition.hasSymbol(symbol))\n                {\n                    const toState = transition.getDestinationState();\n                    const result = this.doClosureTransition(toState);\n                    for (const s of result)\n                    {\n                        if (!dst.includes(s)) dst.push(s);\n                    }\n                }\n            }\n        }\n\n        return dst;\n    }\n\n    doClosureTransition(state, dst = [])\n    {\n        if (!state) return dst;\n\n        dst.push(state);\n        for (let i = 0; i < dst.length; ++i)\n        {\n            const transitions = this.getOutgoingTransitions(dst[i]);\n            for (const transition of transitions)\n            {\n                if (transition[SYMBOL_INDEX] === EMPTY_SYMBOL)\n                {\n                    const toState = transition[TO_STATE_INDEX];\n                    if (!dst.includes(toState))\n                    {\n                        dst.push(toState);\n                    }\n                }\n            }\n        }\n        return dst;\n    }\n\n    getOutgoingTransitions(state, dst = [])\n    {\n        if (!state) return dst;\n        if (!this._states.has(state.getStateID())) throw new Error('Unable to find source state with id \\'' + state.getStateID() + '\\'');\n\n        const fromTransitionKey = state.getStateID() + '->';\n        for (const key of this._transitions.keys())\n        {\n            if (key.startsWith(fromTransitionKey))\n            {\n                const transition = this._transitions.get(key);\n                const symbols = transition.getSymbols();\n                for (const symbol of symbols)\n                {\n                    dst.push([state, symbol, transition.getDestinationState()]);\n                }\n            }\n        }\n\n        return dst;\n    }\n\n    getHashCode()\n    {\n        let string = '';\n        for (const state of this._states.values())\n        {\n            string += state.getHashString() + ',';\n        }\n        string += '|';\n        for (const transition of this._transitions.values())\n        {\n            string += transition.getHashString() + ',';\n        }\n        string += '|';\n        for (const state of this._finalStates)\n        {\n            string += state.getHashString();\n        }\n        string += '|';\n        string += this._startState ? this._startState.getHashString() : '';\n        string += '|';\n        string += this._deterministic ? 'd' : 'n';\n        return stringHash(string);\n    }\n}\n\nexport default FSA;\n","import QuadraticEdge from 'graph2/element/QuadraticEdge.js';\n\nexport const SYMBOL_SEPARATOR = ' ';\nexport const EMPTY_CHAR = '\\u03B5';\n\nclass FSAEdge extends QuadraticEdge\n{\n    constructor(id, from, to = null)\n    {\n        super(id, from, to);\n    }\n\n    /** @override */\n    setEdgeLabel(label)\n    {\n        if (typeof label === 'string')\n        {\n            super.setEdgeLabel(label);\n        }\n        else\n        {\n            super.setEdgeLabel(EMPTY_CHAR);\n        }\n    }\n}\n\nexport default FSAEdge;\n","import { convertToDFA } from './ConvertFSA.js';\nimport { intersectDFA } from './IntersectFSA.js';\nimport { invertDFA } from './InvertDFA.js';\n// import FSA from '../FSA.js';\n\n/**\n * @deprecated\n * Use isEquivalentFSAWithWitnessString instead.\n */\nexport function isEquivalentFSA(fsa1, fsa2)\n{\n    const dfa1 = fsa1.isDeterministic() ? fsa1 : convertToDFA(fsa1);\n    const dfa2 = fsa2.isDeterministic() ? fsa2 : convertToDFA(fsa2);\n    return isEquivalentDFA(dfa1, dfa2).value;\n}\n\nexport function isEquivalentFSAWithWitness(fsa1, fsa2)\n{\n    const dfa1 = fsa1.isDeterministic() ? fsa1 : convertToDFA(fsa1);\n    const dfa2 = fsa2.isDeterministic() ? fsa2 : convertToDFA(fsa2);\n    return isEquivalentDFA(dfa1, dfa2);\n}\n\n/*\n* this function returns an object of the form {value:boolean, witnessString:string}\n* where value is true when two DFAs describe the same language and false otherwise.\n* witnessString is a string that shows one string that demonstrates the non-equivalence\n* of the two machines of our interest. witnessString is set to null when two DFAs are \n* equivalent or when their alphabet are not the same.\n*/\nexport function isEquivalentDFA(dfa1, dfa2)\n{\n    // L(dfa3) = L(dfa1) && !L(dfa2)\n    let dfa3 = intersectionOfComplement(dfa1, dfa2);\n    if (!dfa3) \n    {\n        //console.log(\"dfa1 and dfa2 use different alphabets\");\n        return {\n            value: false,\n            witnessString: null // this means the alphabet of two machines are not the same\n        };\n    }\n    let dfa3acceptssomething = isLanguageNotEmpty(dfa3);\n    if (dfa3acceptssomething) \n    {\n        //console.log(`dfa1 accepts ${dfa3acceptssomething} while dfa2 doesn't`);\n        return {\n            value: false,\n            witnessString: dfa3acceptssomething\n        };\n    }\n    let dfa4 = intersectionOfComplement(dfa2, dfa1);\n    if (!dfa4) \n    {\n        //console.log(\"dfa1 and dfa2 use different alphabets\");\n        return {\n            value: false,\n            witnessString: null // this means these two DFAs have different alphabet\n        };\n    }\n    let dfa4acceptssometing = isLanguageNotEmpty(dfa4);\n    if (dfa4acceptssometing) \n    {\n        //console.log(`dfa2 accepts ${dfa4acceptssomething} while dfa1 doesn't`);\n        return {\n            value: false,\n            witnessString: dfa4acceptssometing\n        }; \n    }\n\n    // if the user reached this statement, the two DFA's are equal and we should return {true, ''}\n    return {\n        value: true,\n        witnessString: null \n    };\n    // L(dfa4) = L(dfa2) && !L(dfa1)\n}\n\n// TODO: move helper functions to seperate file\n// intersection is closed for DFA\nfunction intersectionOfComplement(dfa1, dfa2)\n{\n    // Returns false if used alphabet is different, else returns the common alphabet\n    const commonAlphabet = haveTheSameUsedAlphabet(dfa1, dfa2);\n    if (!commonAlphabet)\n        return null;\n\n    const inverted = invertDFA(dfa2);\n    return intersectDFA(dfa1, inverted);\n}\n\nexport function isLanguageNotEmpty(dfa)\n{\n    //Perform BFS from start state. If a final state can be reached, then the language\n    //is not empty, and the path is a witness. Else if no final states are ever reached,\n    //the language is empty\n    const explored = [];\n    const frontier = [dfa.getStartState()];\n    const path = new Map();\n    path.set(dfa.getStartState(), '');\n\n    while (frontier.length) \n    {\n        let current = frontier.shift();\n        explored.push(current);\n        let pathUpTill = path.get(current);\n\n        if (dfa.isFinalState(current)) \n        {\n            return pathUpTill;\n        }\n        for (const transition of dfa.getOutgoingTransitions(current)) \n        {\n            let dest = transition[2];\n            if (!explored.includes(dest) && !frontier.includes(dest)) \n            {\n                frontier.push(dest);\n                let symbol = transition[1];\n                path.set(dest, pathUpTill + symbol);\n            }\n        }\n    }\n    return false;\n}\n\n// TODO: same function in intersectFSA\nfunction haveTheSameUsedAlphabet(m1, m2)\n{\n    let alphabet1 = new Set();\n    let alphabet2 = new Set();\n    for (const symbol of m1.getAlphabet()) \n    {\n        if (m1.isUsedSymbol(symbol)) \n        {\n            alphabet1.add(symbol);\n        }\n    }\n    for (const symbol of m2.getAlphabet()) \n    {\n        if (m2.isUsedSymbol(symbol)) \n        {\n            alphabet2.add(symbol);\n        }\n    }\n    if (alphabet1.size != alphabet2.size)\n        return false;\n    for (const symbol of alphabet1) \n    {\n        if (!alphabet2.has(symbol))\n            return false;\n    }\n    return alphabet1;\n}\n","import React from 'react';\n\nconst QUAD_RADIAN_THRESHOLD = 0.01;\nconst QUAD_REVERSE_OFFSET_THRESHOLD = 4;\nconst ARROW_WIDTH = 10;\nconst SIXTH_PI = Math.PI / 6;\nconst HALF_PI = Math.PI / 4;\nconst INPUT_MASK_EDGE_WIDTH = 8;\n\nexport const DIRECTED_FORWARD = 'forward';\nexport const DIRECTED_BACKWARD = 'backward';\nexport const DIRECTED_BOTH = 'both';\nexport const DIRECTED_NONE = 'undirected';\n\nexport const EVENT_SOURCE_FORWARD_ENDPOINT = 'forward-endpoint';\nexport const EVENT_SOURCE_BACKWARD_ENDPOINT = 'backward-endpoint';\nexport const EVENT_SOURCE_EDGE = 'edge';\nexport const EVENT_SOURCE_LABEL = 'label';\n\nexport const DefaultEndpointRenderer = props => (\n    <React.Fragment>\n        <path d={\n            'M ' +\n            (props.position.x - (props.length * Math.sin(props.angle - SIXTH_PI))) +\n            ' ' +\n            (props.position.y - (props.length * Math.cos(props.angle - SIXTH_PI))) +\n            ' ' +\n            'L ' + props.position.x + ' ' + props.position.y +\n            ' ' +\n            'L ' +\n            (props.position.x - (props.length * Math.sin(props.angle + SIXTH_PI))) +\n            ' ' +\n            (props.position.y - (props.length * Math.cos(props.angle + SIXTH_PI)))}\n        stroke={props.color}\n        fill=\"none\" />\n        <circle cx={props.position.x - (props.length * Math.cos(-props.angle + HALF_PI))} cy={props.position.y - (props.length * Math.sin(-props.angle + HALF_PI))}\n            r={props.length}\n            fill=\"transparent\"\n            cursor=\"pointer\"\n            onMouseOver={props.onMouseOver}\n            onMouseOut={props.onMouseOut}\n            pointerEvents={props.pointerEvents} />\n    </React.Fragment>\n);\n\nexport const DefaultLabelRenderer = props => (\n    <g transform={'translate(' + props.position.x + ',' + props.position.y + ')' +\n        ' ' +\n        'rotate(' + (props.direction * 180 / Math.PI) + ')'}>\n        {\n            props.labels && props.labels.length > 0 &&\n            props.labels.map((str, i) =>\n            {\n                const onMouseOver = props.onMouseOver;\n                const onMouseOut = props.onMouseOut;\n                return (\n                    <text key={str + '.' + i}\n                        transform={'translate(0,' + ((i + 1) * -15) + ')' +\n                            (props.reverse ? ' scale(-1,-1)' : '')}\n                        alignmentBaseline=\"central\"\n                        style={{ userSelect: 'none' }}\n                        textAnchor=\"middle\"\n                        fill={props.color}\n                        cursor=\"pointer\"\n                        onMouseOver={onMouseOver ? e => \n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.index = i;\n                            onMouseOver(e);\n                        } : null}\n                        onMouseOut={onMouseOut ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.index = i;\n                            onMouseOut(e);\n                        } : null}\n                        pointerEvents={props.pointerEvents}>\n                        {str}\n                    </text>\n                );\n            })\n        }\n    </g>\n);\n\nclass EdgeRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const directed = this.props.directed || DIRECTED_NONE;\n\n        const ForwardEndpointRenderer =\n            (directed === DIRECTED_FORWARD || directed === DIRECTED_BOTH) ?\n                (this.props.forwardEndpointRenderer ||\n                    this.props.endpointRenderer ||\n                    DefaultEndpointRenderer) : null;\n        const BackwardEndpointRenderer =\n            (directed === DIRECTED_BACKWARD || directed === DIRECTED_BOTH) ?\n                (this.props.backwardEndpointRenderer ||\n                    this.props.endpointRenderer ||\n                    DefaultEndpointRenderer) : null;\n        const EdgeLabelRenderer = this.props.labelRenderer || DefaultLabelRenderer;\n\n        const fromPoint = this.props.from;\n        const toPoint = this.props.to;\n        const centerPoint = this.props.center;\n        const label = this.props.label || '';\n        const direction = this.props.direction || 0;\n        const color = this.props.color || '#000000';\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents || 'visiblePainted';\n\n        let reverseLabel = false;\n        let fromAngle;\n        let toAngle;\n        let quadLine = null;\n\n        const dftx = fromPoint.x - toPoint.x;\n        const dfty = fromPoint.y - toPoint.y;\n        const dfcx = fromPoint.x - centerPoint.x;\n        const dfcy = fromPoint.y - centerPoint.y;\n        const ftrad = Math.atan2(dfty, dftx);\n        const fcrad = Math.atan2(dfcy, dfcx);\n        if (Math.abs(ftrad - fcrad) <= QUAD_RADIAN_THRESHOLD)\n        {\n            toAngle = Math.atan2(centerPoint.x - toPoint.x, centerPoint.y - toPoint.y) + Math.PI;\n            fromAngle = Math.atan2(centerPoint.x - fromPoint.x, centerPoint.y - fromPoint.y) + Math.PI;\n            quadLine = 'L ' + toPoint.x + ' ' + toPoint.y;\n            reverseLabel = false;\n        }\n        else\n        {\n            const cx = ((centerPoint.x * 4) - fromPoint.x - toPoint.x) / 2;\n            const cy = ((centerPoint.y * 4) - fromPoint.y - toPoint.y) / 2;\n            toAngle = Math.atan2(cx - toPoint.x, cy - toPoint.y) + Math.PI;\n            fromAngle = Math.atan2(cx - fromPoint.x, cy - fromPoint.y) + Math.PI;\n            quadLine = 'Q ' + cx + ' ' + cy + ' ' + toPoint.x + ' ' + toPoint.y;\n            reverseLabel = cy > centerPoint.y + QUAD_REVERSE_OFFSET_THRESHOLD;\n        }\n\n        const pathData = `M ${fromPoint.x} ${fromPoint.y} ${quadLine}`;\n        return (\n            <g>\n                <path d={pathData}\n                    stroke={color}\n                    fill=\"none\" />\n                <path d={pathData}\n                    stroke=\"transparent\"\n                    strokeWidth={`${INPUT_MASK_EDGE_WIDTH}px`}\n                    fill=\"none\"\n                    cursor=\"pointer\"\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.type = EVENT_SOURCE_EDGE;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.type = EVENT_SOURCE_EDGE;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n                {ForwardEndpointRenderer &&\n                    <ForwardEndpointRenderer\n                        position={toPoint}\n                        angle={toAngle}\n                        length={ARROW_WIDTH}\n                        color={color}\n                        onMouseOver={onMouseOver ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_FORWARD_ENDPOINT;\n                            onMouseOver(e);\n                        } : null}\n                        onMouseOut={onMouseOut ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_FORWARD_ENDPOINT;\n                            onMouseOut(e);\n                        } : null}\n                        pointerEvents={pointerEvents} />}\n                {BackwardEndpointRenderer &&\n                    <BackwardEndpointRenderer\n                        position={fromPoint}\n                        angle={fromAngle}\n                        length={ARROW_WIDTH}\n                        color={color}\n                        onMouseOver={onMouseOver ? e => \n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_BACKWARD_ENDPOINT;\n                            onMouseOver(e);\n                        } : null}\n                        onMouseOut={onMouseOut ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_BACKWARD_ENDPOINT;\n                            onMouseOut(e);\n                        } : null}\n                        pointerEvents={pointerEvents} />}\n                {EdgeLabelRenderer &&\n                    <EdgeLabelRenderer\n                        position={centerPoint}\n                        labels={label.split('\\n')}\n                        direction={direction}\n                        reverse={reverseLabel}\n                        color={color}\n                        onMouseOver={onMouseOver ? e => \n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_LABEL;\n                            onMouseOver(e);\n                        } : null}\n                        onMouseOut={onMouseOut ? e =>\n                        {\n                            const value = e.target['value'] || (e.target['value'] = {});\n                            value.type = EVENT_SOURCE_LABEL;\n                            onMouseOut(e);\n                        } : null}\n                        pointerEvents={pointerEvents} />}\n            </g>\n        );\n    }\n}\n\nexport default EdgeRenderer;\n","import FSA, { State } from '../FSA.js';\n\nexport function convertToNFA(fsa, dst = new FSA(false))\n{\n    if (!fsa.isDeterministic())\n    {\n        dst.copy(fsa);\n        return dst;\n    }\n\n    dst.setDeterministic(false);\n    return dst;\n}\n\nexport function convertToDFA(fsa, dst = new FSA(true))\n{\n    if (fsa.isDeterministic())\n    {\n        dst.copy(fsa);\n        return dst;\n    }\n\n    dst.setDeterministic(true);\n\n    const startState = fsa.getStartState();\n\n    const dfaData = {\n        nfaSource: fsa,\n        //To keep track of dfa states in terms of nfa sets\n        dfaStateMap: new Map(),\n        //Array of final dfa states\n        dfaFinalStates: [],\n        //To keep track of dfa transitions in terms of dfa states\n        dfaTransitionMap: new Map(),\n        //The resultant dfa start state\n        dfaStartState: null,\n        //The trap state for all missing transitions\n        dfaTrapState: null\n    };\n\n    //Make new DFA start state\n    const startStatesByClosure = fsa.doClosureTransition(startState);\n    dfaData.dfaStartState = getDFAStateFromNFAStates(startStatesByClosure, dfaData);\n    dfaData.dfaTrapState = getDFAStateFromNFAStates([], dfaData);\n\n    //For every state from the NFA's powerset, add it to DFA with correct transitions\n    const statePowerSet = getPowerSetOfStates(fsa.getStates());\n    for (const nfaStates of statePowerSet)\n    {\n        //As long as it is not the empty set...\n        if (nfaStates.length > 0)\n        {\n            expandNFAStatesToDFA(nfaStates, dfaData);\n        }\n    }\n\n    //Make sure any unused symbols are added as transitions for every state...\n    for (const dfaState of dfaData.dfaStateMap.values())\n    {\n        for (const symbol of fsa.getAlphabet())\n        {\n            //If transition for symbol does not exist...\n            const dfaTransitionKey = getDFATransitionKeyFromDFAStateAndSymbol(dfaState, symbol, dfaData);\n            if (!dfaData.dfaTransitionMap.has(dfaTransitionKey))\n            {\n                dfaData.dfaTransitionMap.set(dfaTransitionKey, [dfaState, symbol, dfaData.dfaTrapState]);\n            }\n        }\n    }\n\n    //Compiled dfa data to dst\n    dst.clear();\n    //Add states\n    for (const dfaState of dfaData.dfaStateMap.values())\n    {\n        dst.addState(dfaState);\n    }\n\n    //Set start state\n    dst.setStartState(dfaData.dfaStartState);\n    //Set final states\n    for (const finalState of dfaData.dfaFinalStates)\n    {\n        dst.setFinalState(finalState);\n    }\n    //Add transitions (will also add any symbols used to alphabet)\n    for (const transition of dfaData.dfaTransitionMap.values())\n    {\n        dst.addTransition(transition[0], transition[2], transition[1]);\n    }\n    return dst;\n}\n\nfunction expandNFAStatesToDFA(nfaStates, dfaData)\n{\n    let fromDFAState = getDFAStateFromNFAStates(nfaStates, dfaData);\n    let dfaState = null;\n\n    let nfaTerminals = [];\n\n    for (const symbol of dfaData.nfaSource.getAlphabet())\n    {\n        //Get all closed reachable states...\n        for (const fromNFAState of nfaStates)\n        {\n            dfaData.nfaSource.doTerminalTransition(fromNFAState, symbol, nfaTerminals);\n        }\n\n        //If has reachable states...\n        if (nfaTerminals.length > 0)\n        {\n            dfaState = getDFAStateFromNFAStates(nfaTerminals, dfaData);\n\n            //Create transition for reachable state\n            //Should guarantee to be unique for state and symbol pair\n            const dfaTransitionKey = getDFATransitionKeyFromDFAStateAndSymbol(fromDFAState, symbol, dfaData);\n            dfaData.dfaTransitionMap.set(dfaTransitionKey, [fromDFAState, symbol, dfaState]);\n        }\n\n        //Reset list\n        nfaTerminals.length = 0;\n    }\n}\n\nfunction getNFAStateKeyFromNFAStates(nfaStates, dfaData)\n{\n    let result = '';\n    for (const nfaState of dfaData.nfaSource.getStates())\n    {\n        if (nfaStates.includes(nfaState))\n        {\n            result += 'x';\n        }\n        else\n        {\n            result += '-';\n        }\n    }\n    return result;\n}\n\nfunction getDFATransitionKeyFromDFAStateAndSymbol(dfaState, symbol, dfaData)\n{\n    return dfaState.getStateID() + ';' + symbol;\n}\n\nfunction getDFAStateFromNFAStates(nfaStates, dfaData)\n{\n    const nfaStateKey = getNFAStateKeyFromNFAStates(nfaStates, dfaData);\n    let result = dfaData.dfaStateMap.get(nfaStateKey);\n\n    //If it doesn't exist, create it...\n    if (!result)\n    {\n        let final = false;\n        //Compute the label from nfa states in set notation...\n        let dfaStateLabel = '{';\n        for (const state of nfaStates)\n        {\n            if (dfaStateLabel.length > 1)\n            {\n                dfaStateLabel += ',';\n            }\n            dfaStateLabel += state.getStateLabel();\n\n            //Check if nfa state is final state...\n            if (!final)\n            {\n                final = dfaData.nfaSource.isFinalState(state);\n            }\n        }\n        dfaStateLabel += '}';\n\n        //Create the state\n        result = new State(dfaStateLabel);\n        dfaData.dfaStateMap.set(nfaStateKey, result);\n\n        //If any nfa states is a final state, make dfa state final...\n        if (final)\n        {\n            dfaData.dfaFinalStates.push(result);\n        }\n    }\n\n    return result;\n}\n\nfunction getPowerSetOfStates(states)\n{\n    var result = [[]];\n\n    for (const state of states)\n    {\n        for (let i = 0, len = result.length; i < len; ++i)\n        {\n            result.push(result[i].concat(state));\n        }\n    }\n    return result;\n}\n","import FSA from '../FSA.js';\n// TODO: add function headers-\n\n// TODO:explain intersected FSA\nexport function intersectFSA(fsa1, fsa2, dst = new FSA(true))\n{\n    throw new Error('Unsupported operation - not yet implemented');\n}\n\nexport function intersectDFA(dfa1, dfa2, dst = new FSA(true))\n{\n    if (!checkSameAlphabet(dfa1, dfa2))\n        throw new Error('Mismatched machine alphabet');\n\n    const alphabet = dfa1.getAlphabet();\n    const start1 = dfa1.getStartState();\n    const start2 = dfa2.getStartState();\n\n    if (!start1 && !start2)\n    {\n        dst.clear();\n        return dst;\n    }\n    else if (!start1)\n    {\n        return dst.copy(dfa2);\n    }\n    else if (!start2)\n    {\n        return dst.copy(dfa1);\n    }\n\n    const pairIDs = new Map();\n    const finalPairIDs = new Set();\n    const transitions = [];\n\n    //Add start state pair\n    const startPair = [start1, start2];\n    const startPairID = start1.getStateID() + ':' + start2.getStateID();\n    if (dfa1.isFinalState(start1) && dfa2.isFinalState(start2))\n    {\n        finalPairIDs.add(startPairID);\n    }\n    pairIDs.set(startPairID, startPair);\n\n    //Add remaining states by symbol\n    const remainingPairIDs = [];\n    remainingPairIDs.push(startPairID);\n    while (remainingPairIDs.length > 0)\n    {\n        const parentPairID = remainingPairIDs.pop();\n        const parentPair = pairIDs.get(parentPairID);\n        const parent1 = parentPair[0];\n        const parent2 = parentPair[1];\n\n        const result = [];\n        for (const symbol of alphabet)\n        {\n            let state1;\n            let state2;\n\n            dfa1.doTransition(parent1, symbol, false, result);\n            if (result.length !== 1)\n            {\n                throw new Error('Found non-deterministic transition from \\'' +\n                    parent1.getStateLabel() + '\\' for \\'' + symbol + '\\' - transitions to \\'' + result.join(',') + '\\'');\n            }\n            state1 = result[0];\n            result.length = 0;\n\n            dfa2.doTransition(parent2, symbol, false, result);\n            if (result.length !== 1)\n            {\n                throw new Error('Found non-deterministic transition from \\'' +\n                    parent2.getStateLabel() + '\\' for \\'' + symbol + '\\' - transitions to \\'' + result.join(',') + '\\'');\n            }\n            state2 = result[0];\n            result.length = 0;\n\n            //Get cartesian-product equivalent\n            const newPairID = state1.getStateID() + ':' + state2.getStateID();\n            if (!pairIDs.has(newPairID))\n            {\n                pairIDs.set(newPairID, [state1, state2]);\n                remainingPairIDs.push(newPairID);\n\n                //Only accept if both do\n                if (dfa1.isFinalState(state1) && dfa2.isFinalState(state2))\n                {\n                    finalPairIDs.add(newPairID);\n                }\n            }\n\n            //Add the transition\n            transitions.push([\n                /*FROM PAIR ID*/ parentPairID,\n                /*SYMBOL*/ symbol,\n                /*TO PAIR ID*/ newPairID\n            ]);\n        }\n    }\n\n    dst.clear();\n\n    //Add state/final pairs to the machine\n    const pairToState = new Map();\n    for (const [statePairID, statePair] of pairIDs.entries())\n    {\n        const state = dst.createState('(' + statePair[0].getStateLabel() + ',' + statePair[1].getStateLabel() + ')');\n        if (finalPairIDs.has(statePairID))\n        {\n            dst.setFinalState(state, true);\n        }\n        pairToState.set(statePairID, state);\n    }\n\n    //Add start pair to the machine\n    const startState = pairToState.get(startPairID);\n    if (!startState) throw new Error('Unable to find start state for pair');\n    dst.setStartState(startState);\n\n    //Add transitions to the machine\n    for (const transition of transitions)\n    {\n        const fromPairID = transition[0];\n        const symbol = transition[1];\n        const toPairID = transition[2];\n\n        const fromState = pairToState.get(fromPairID);\n        const toState = pairToState.get(toPairID);\n        if (!fromState || !toState) throw new Error('Cannot find state for pair');\n\n        dst.addTransition(fromState, toState, symbol);\n    }\n\n    return dst;\n}\n\nfunction checkSameAlphabet(fsa1, fsa2)\n{\n    const alphabet = new Set();\n    for (let symbol of fsa1.getAlphabet()) { alphabet.add(symbol); }\n\n    for (let symbol of fsa2.getAlphabet())\n    {\n        if (!alphabet.has(symbol))\n        {\n            return false;\n        }\n        else\n        {\n            alphabet.delete(symbol);\n        }\n    }\n\n    return alphabet.size <= 0;\n}\n","import GraphNode from './element/GraphNode.js';\nimport GraphEdge from './element/GraphEdge.js';\nimport { guid, stringHash } from 'util/MathHelper.js';\n\n/**\n * A class that represents a graph that coordinates nodes and edges.\n */\nclass NodeGraph\n{\n    /**\n     * Create a NodeGraph with the respective node and edge classes.\n     * @param {Class} [nodeClass=GraphNode] The class that represents a node.\n     * @param {Class} [edgeClass=GraphEdge] The class that represents an edge.\n     */\n    constructor(nodeClass = GraphNode, edgeClass = GraphEdge)\n    {\n        this._nodeClass = nodeClass;\n        this._edgeClass = edgeClass;\n\n        this._nodeMapping = new Map();\n        this._edgeMapping = new Map();\n    }\n\n    /**\n     * Removes all nodes and edges from the graph.\n     */\n    clear()\n    {\n        this.clearEdges();\n        this.clearNodes();\n    }\n\n    /**\n     * Checks whether there exists any number of nodes or edges.\n     * @returns {Boolean} Whether the graph is empty.\n     */\n    isEmpty()\n    {\n        return this._nodeMapping.size <= 0 && this._edgeMapping.size <= 0;\n    }\n\n    /**\n     * Computes the boundaries of the graph that surrounds all nodes and edges. If\n     * the graph is empty, a rectangle at the origin of size 1 is returned.\n     * @returns {Object}    The object which represents the bounding rectangle. It has\n     *                      the properties: minX, minY, maxX, maxY, width, height.\n     */\n    getBoundingRect()\n    {\n        if (this._nodeMapping.size <= 0) return {\n            minX: 0,\n            minY: 0,\n            maxX: 1,\n            maxY: 1,\n            width: 1,\n            height: 1\n        };\n\n        var minNX = Number.MAX_VALUE;\n        var minNY = Number.MAX_VALUE;\n        var maxNX = Number.MIN_VALUE;\n        var maxNY = Number.MIN_VALUE;\n\n        var maxNodeSize = 0;\n        for (const node of this._nodeMapping.values())\n        {\n            const x = node.x;\n            const y = node.y;\n            const size = node.getNodeSize();\n            if (size > maxNodeSize) maxNodeSize = size;\n\n            minNX = Math.min(minNX, x);\n            maxNX = Math.max(maxNX, x);\n\n            minNY = Math.min(minNY, y);\n            maxNY = Math.max(maxNY, y);\n        }\n\n        minNX -= maxNodeSize;\n        minNY -= maxNodeSize;\n        maxNX += maxNodeSize;\n        maxNY += maxNodeSize;\n\n        var minEX = Number.MAX_VALUE;\n        var minEY = Number.MAX_VALUE;\n        var maxEX = Number.MIN_VALUE;\n        var maxEY = Number.MIN_VALUE;\n\n        const startPoint = { x: 0, y: 0 };\n        const endPoint = { x: 0, y: 0 };\n        const centerPoint = { x: 0, y: 0 };\n        for (const edge of this._edgeMapping.values())\n        {\n            //Will store into point objects...\n            edge.getStartPoint(startPoint);\n            edge.getEndPoint(endPoint);\n            edge.getCenterPoint(centerPoint);\n\n            const sx = startPoint.x;\n            const sy = startPoint.y;\n            const ex = endPoint.x;\n            const ey = endPoint.y;\n            const cx = centerPoint.x;\n            const cy = centerPoint.y;\n\n            minEX = Math.min(minEX, sx, ex, cx);\n            maxEX = Math.max(maxEX, sx, ex, cx);\n\n            minEY = Math.min(minEY, sy, ey, cy);\n            maxEY = Math.max(maxEY, sy, ey, cy);\n        }\n\n        const result = {\n            minX: Math.min(minNX, minEX),\n            minY: Math.min(minNY, minEY),\n            maxX: Math.max(maxNX, maxEX),\n            maxY: Math.max(maxNY, maxEY),\n            width: 0,\n            height: 0\n        };\n        result.width = result.maxX - result.minX;\n        result.height = result.maxY - result.minY;\n        return result;\n    }\n\n    /**\n     * Computes a unique and persistent hash code that describes the current\n     * state.\n     * @param  {Boolean} [usePosition=true] Whether to consider the positioning as\n     *                                      part of the graph's state.\n     * @returns {Number}                    the hash code.\n     */\n    getHashCode(usePosition = true)\n    {\n        let string = '';\n        for (const node of this._nodeMapping.values())\n        {\n            string += node.getHashString(usePosition) + ',';\n        }\n        string += '|';\n        for (const edge of this._edgeMapping.values())\n        {\n            string += edge.getHashString(usePosition) + ',';\n        }\n        return stringHash(string);\n    }\n\n    // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= NODES\n\n    /**\n     * Create node for graph.\n     * @param  {Number} [x=0]       the initial x position\n     * @param  {Number} [y=0]       the initial y position\n     * @param  {String} [id=null]   the new node id (will be generated if null)\n     * @returns {GraphNdoe}         the new node\n     */\n    createNode(x = 0, y = 0, id = null)\n    {\n        return this.addNode(new (this._nodeClass)(id || guid(), x, y));\n    }\n\n    /**\n     * Add existing node to the graph. Any edges connected to the node are NOT\n     * deleted in the process. (so pls delete them first.)\n     * @param {GraphNode} node The node to be added.\n     * @returns {GraphNode} The node that was added to the graph.\n     */\n    addNode(node)\n    {\n        if (!node.getGraphElementID()) node.setGraphElementID(guid());\n        this._nodeMapping.set(node.getGraphElementID(), node);\n        return node;\n    }\n\n    /**\n     * Delete node from graph. Any edges whose source is the target node are also\n     * deleted.\n     * @param  {GraphNode} node        Target node to be deleted.\n     */\n    deleteNode(node)\n    {\n        const elementID = node.getGraphElementID();\n        if (this._nodeMapping.has(elementID))\n        {\n            this._nodeMapping.delete(elementID);\n\n            const nullSourceEdges = [];\n            //Find connected edges without sources...\n            for (const edge of this.getEdges())\n            {\n                if (edge.getEdgeFrom() === node)\n                {\n                    nullSourceEdges.push(edge);\n                }\n                else if (edge.getEdgeTo() === node)\n                {\n                    edge.setEdgeTo(null);\n                }\n            }\n            //Delete sourceless edges...\n            for (const edge of nullSourceEdges)\n            {\n                this.deleteEdge(edge);\n            }\n        }\n    }\n\n    clearNodes() { this._nodeMapping.clear(); }\n\n    getNodeByElementID(elementID)\n    {\n        if (this._nodeMapping.has(elementID))\n        {\n            return this._nodeMapping.get(elementID);\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    getNodesByLabel(label, dst = [])\n    {\n        for (const node of this.getNodes())\n        {\n            if (node.getNodeLabel() === label)\n            {\n                dst.push(node);\n            }\n        }\n        return dst;\n    }\n\n    getNodes() { return Array.from(this._nodeMapping.values()); }\n    getNodeCount() { return this._nodeMapping.size; }\n    getNodeClass() { return this._nodeClass; }\n\n    // =-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-= EDGES\n\n    /**\n     * This is more like addEdge() without adding it to the graph and just returns the result.\n     * This should only be called once when completing an edge.\n     * @deprecated\n     */\n    formatEdge(edge)\n    {\n        return edge;\n    }\n\n    /**\n     * Create edge for graph. The id argument can be used to set the id to a\n     * pre-defined value instead of generating a new one.\n     * @param  {GraphNode} from                     the source graph node for the edge\n     * @param  {GraphNode|InputPointer} [to=null]   the destination graph node for the edge\n     * @param  {String} [id=null]                   the new edge id (will be generated if null)\n     * @returns {GraphEdge}                         the new edge\n     */\n    createEdge(from, to = null, id = null)\n    {\n        return this.addEdge(new (this._edgeClass)(id || guid(), from, to));\n    }\n\n    /**\n     * Add existing edge to the graph.\n     * \n     * Assumes that the passed-in edge does not have conflicting id's within this graph.\n     * @param {GraphEdge} edge    the edge to be added.\n     * @returns {GraphEdge}       the edge that was added to the graph.\n     */\n    addEdge(edge)\n    {\n        if (!edge.getGraphElementID()) edge.setGraphElementID(guid());\n        this._edgeMapping.set(edge.getGraphElementID(), edge);\n        return edge;\n    }\n\n    /**\n     * Delete edge from graph. The from and to nodes of the target edge are not\n     * modified.\n     * @param  {GraphEdge} edge      target edge to be deleted.\n     */\n    deleteEdge(edge)\n    {\n        const elementID = edge.getGraphElementID();\n        if (this._edgeMapping.has(elementID))\n        {\n            this._edgeMapping.delete(elementID);\n        }\n    }\n\n    clearEdges() { this._edgeMapping.clear(); }\n\n    getEdgeByElementID(elementID)\n    {\n        if (this._edgeMapping.has(elementID))\n        {\n            return this._edgeMapping.get(elementID);\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    getEdgesByLabel(label, dst = [])\n    {\n        for (const edge of this.getEdges())\n        {\n            if (edge.getEdgeLabel() === label)\n            {\n                dst.push(edge);\n            }\n        }\n        return dst;\n    }\n\n    getEdges() { return Array.from(this._edgeMapping.values()); }\n    getEdgeCount() { return this._edgeMapping.size; }\n    getEdgeClass() { return this._edgeClass; }\n}\n\nexport default NodeGraph;\n","import GraphEdge from './GraphEdge.js';\nimport { getDirectionalVector, getMidPoint } from 'util/MathHelper.js';\n\n/**\n * A class that represents the curved edge elements of a graph.\n * \n * @see {@link NodeGraph}\n * @extends GraphEdge\n */\nclass QuadraticEdge extends GraphEdge\n{\n    /**\n     * Creates a quadratic edge with the unique id.\n     * @constructor\n     * @param {String} id           The element id for this node.\n     * @param {GraphNode} from      The from node of the edge.\n     * @param {GraphNode} [to=null] The to node of the edge.\n     */\n    constructor(id, from, to = null)\n    {\n        super(id, from, to);\n\n        //radians = the angle in radians, where 0 is the normal of midpoint\n        //length = the distance from midpoint\n        this._quad = {\n            radians: 0,\n            length: to ? 0 : this.getPlaceholderLength(),\n            coords: { x: 0, y: 0 }\n        };\n    }\n\n    /** @override */\n    setEdgeTo(node)\n    {\n        const prevNode = this._to;\n        if (node !== prevNode)\n        {\n            const result = super.setEdgeTo(node);\n            if (!node)\n            {\n                this.setQuadraticByCoords(prevNode.x, prevNode.y);\n            }\n            else if (node === this._from)\n            {\n                this._quad.length = this._from.getNodeSize() + this.getPlaceholderLength();\n            }\n            return result;\n        }\n        return super.setEdgeTo(node);\n    }\n\n    /**\n     * Set the angle of the curve in radians\n     * @param {Number} radians the radians the quadratic should be curved\n     * @returns {this}\n     */\n    setQuadraticRadians(radians)\n    {\n        this._quad.radians = radians;\n        return this;\n    }\n\n    /**\n     * Set the distance of the curve from the midpoint\n     * @param {Number} length the \"height\" of the curve\n     * @returns {this}\n     */\n    setQuadraticLength(length)\n    {\n        this._quad.length = length;\n        return this;\n    }\n\n    /**\n     * Calculates and sets the quadratic vertex to pass through the position.\n     * This will update the radians and length of the curve.\n     * @param {Number} x the x coordinate\n     * @param {Number} y the y coordinate\n     * @returns {this}\n     */\n    setQuadraticByCoords(x, y)\n    {\n        const from = this._from;\n        const to = this._to;\n\n        if (!to)\n        {\n            /*\n            Quad is re-used to determine edge angle for placeholder.\n            This can be used specifically for quad since regular quad is\n            dependent on edge to to NOT be null, which placeholder assumes\n            to BE null. Also, quad.length is ignored, because the\n            length should always be getPlaceholderLength(). This is\n            resolved by getStartPoint(), getEndPoint(), etc.\n            */\n            const dx = this._from.x - x;\n            const dy = this._from.y - y;\n            const radians = -Math.atan2(dx, dy) - (Math.PI / 2);\n            this._quad.radians = radians;\n            return this;\n        }\n\n        const fromx = from.x;\n        const fromy = from.y;\n        const tox = to.x;\n        const toy = to.y;\n\n        let dx = tox - fromx;\n        let dy = toy - fromy;\n        const midpointx = fromx + dx / 2;\n        const midpointy = fromy + dy / 2;\n\n        // Remember: y-axis is flipped because canvas coord-space is -y => +y\n        // Therefore, dy needs to be flipped\n        const angleOffset = Math.atan2(-dy, dx);\n        dx = x - midpointx;\n        dy = y - midpointy;\n\n        const PI = Math.PI;\n        const HALFPI = PI / 2;\n        // 0 rad = to the right\n        // Also: angleOffset is the offset from midpoint angle, the orthogonal base vector\n        // This is because the from and to could be flipped, and\n        // therefore give a negative, or at least a reversed angle.\n        let radians = Math.atan2(dy, dx) + angleOffset;\n        let length = Math.sqrt(dx * dx + dy * dy);\n        if (length < 0) length = 0;\n\n        // -PI / 2 is outward\n        const outrad = radians - (-HALFPI);\n        // PI / 2 is inward\n        const inrad = radians - (HALFPI);\n        // TODO: Should be dependent on length, instead of a constant.\n        const maxdr = PI / 20;\n\n        if (Math.abs(length) < 8)\n        {\n            radians = 0;\n            length = 0;\n        }\n        else if (outrad < maxdr && outrad > -maxdr)\n        {\n            // -PI / 2 is outward\n            radians = -HALFPI;\n        }\n        else if (-inrad < maxdr && -inrad > -maxdr)\n        {\n            // PI / 2 is inward\n            radians = HALFPI;\n        }\n\n        this._quad.radians = radians;\n        this._quad.length = length;\n        return this;\n    }\n\n    getQuadraticLength() { return this._quad.length; }\n    getQuadraticRadians() { return this._quad.radians; }\n    getQuadratic() { return this._quad; }\n    isQuadratic() { return !this.isPlaceholder() && this._quad.length !== 0; }\n\n    getQuadraticAsCoords()\n    {\n        const from = this._from;\n        const to = this._to;\n        const dst = this._quad.coords;\n        if (from == null || to == null)\n        {\n            dst.x = 0;\n            dst.y = 0;\n        }\n        else\n        {\n            /*\n            //To mark dirty...\n            _capture: {\n                fx: 0, fy: 0,\n                tx: 0, ty: 0,\n                ql: 0, qr: 0\n            }\n            */\n            getDirectionalVector(from.x, from.y, to.x, to.y, this._quad.length, this._quad.radians, dst);\n        }\n        return dst;\n    }\n\n    /** @override */\n    getEdgeDirection()\n    {\n        let result = 0;\n        if (this.isQuadratic())\n        {\n            const coords = this.getQuadraticAsCoords();\n            result = Math.atan2(coords.y, coords.x) + Math.PI / 2;\n        }\n        else\n        {\n            result = super.getEdgeDirection();\n        }\n\n        return result;\n    }\n\n    /** @override */\n    getStartPoint(dst = { x: 0, y: 0 })\n    {\n        const from = this._from;\n        const to = this._to;\n\n        if (!from) throw new Error('Source of edge cannot be null.');\n        if (!to)\n        {\n            //Make sure to use quad for placeholder direction\n            const radians = this._quad.radians;\n            const px = Math.cos(radians);\n            const py = Math.sin(radians);\n            const nodeSize = from.getNodeSize();\n            dst.x = from.x + px * nodeSize;\n            dst.y = from.y + py * nodeSize;\n            return dst;\n        }\n\n        //Check if edge is following something other than a node...then remain flat\n        if (typeof to['getNodeSize'] !== 'function' || !this.isQuadratic())\n        {\n            getDirectionalVector(from.x, from.y, to.x, to.y, from.getNodeSize(), 0, dst);\n            dst.x += from.x;\n            dst.y += from.y;\n            return dst;\n        }\n        else\n        {\n            getMidPoint(from.x, from.y, to.x, to.y, dst);\n            const qcoords = this.getQuadraticAsCoords();\n            const qx = dst.x + qcoords.x;\n            const qy = dst.y + qcoords.y;\n            getDirectionalVector(from.x, from.y, qx, qy, from.getNodeSize(), this.isSelfLoop() ? (Math.PI / 4) : 0, dst);\n            dst.x += from.x;\n            dst.y += from.y;\n            return dst;\n        }\n    }\n\n    /** @override */\n    getCenterPoint(dst = { x: 0, y: 0 })\n    {\n        const from = this._from;\n        const to = this._to;\n\n        if (!from) throw new Error('Source of edge cannot be null.');\n        if (!to)\n        {\n            //Make sure to use quad for placeholder direction (not magnitude)\n            const px = Math.cos(this._quad.radians);\n            const py = Math.sin(this._quad.radians);\n            const placeholderLength = from.getNodeSize() + this.getPlaceholderLength() / 2;\n            dst.x = from.x + px * placeholderLength;\n            dst.y = from.y + py * placeholderLength;\n            return dst;\n        }\n\n        getMidPoint(from.x, from.y, to.x, to.y, dst);\n\n        if (this.isQuadratic())\n        {\n            const qcoords = this.getQuadraticAsCoords();\n            dst.x += qcoords.x;\n            dst.y += qcoords.y;\n        }\n\n        return dst;\n    }\n\n    /** @override */\n    getEndPoint(dst = { x: 0, y: 0 })\n    {\n        const from = this._from;\n        const to = this._to;\n\n        if (!from) throw new Error('Source of edge cannot be null.');\n        if (!to)\n        {\n            //Make sure to use quadCoords for placeholder direction (not magnitude)\n            const radians = this._quad.radians;\n            const px = Math.cos(radians);\n            const py = Math.sin(radians);\n            const placeholderLength = from.getNodeSize() + this.getPlaceholderLength();\n            dst.x = from.x + px * placeholderLength;\n            dst.y = from.y + py * placeholderLength;\n            return dst;\n        }\n\n        //Get end point for non-nodes...\n        if (typeof to['getNodeSize'] !== 'function')\n        {\n            return to;\n        }\n        //Get end point for straight edges...\n        else if (!this.isQuadratic())\n        {\n            getDirectionalVector(to.x, to.y, from.x, from.y, to.getNodeSize(), 0, dst);\n            dst.x += to.x;\n            dst.y += to.y;\n            return dst;\n        }\n        //Get end point for quadratics...\n        else\n        {\n            getMidPoint(from.x, from.y, to.x, to.y, dst);\n            const qcoords = this.getQuadraticAsCoords();\n            const qx = dst.x + qcoords.x;\n            const qy = dst.y + qcoords.y;\n            getDirectionalVector(to.x, to.y, qx, qy, to.getNodeSize(), this.isSelfLoop() ? -(Math.PI / 4.0) : 0, dst);\n            dst.x += to.x;\n            dst.y += to.y;\n            return dst;\n        }\n    }\n\n    /** @override */\n    getHashString(usePosition = true)\n    {\n        if (usePosition)\n        {\n            return super.getHashString(usePosition) + ':' + this._quad.radians + ',' + this._quad.length;\n        }\n        else\n        {\n            return super.getHashString(usePosition);\n        }\n    }\n}\n\nexport default QuadraticEdge;\n","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\nimport { lerp } from 'util/MathHelper.js';\nimport { EVENT_SOURCE_NODE } from 'graph2/renderer/NodeRenderer.js';\n\nexport const GRAPH_EVENT_NODE_CREATE = 'node-create';\nexport const GRAPH_EVENT_NODE_DELETE = 'node-delete';\nexport const GRAPH_EVENT_NODE_DELETE_ALL = 'node-delete-all';\nexport const GRAPH_EVENT_NODE_LABEL_CHANGE = 'edge-label-change';\nexport const GRAPH_EVENT_NODE_MOVE = 'node-move';\nexport const GRAPH_EVENT_NODE_MOVE_ALL = 'node-move-all';\nexport const GRAPH_EVENT_NODE_EDIT_WHILE_DELETE = 'error-node-edit-while-delete';\n\nconst NODE_POSITION_INTERPOLATION_DELTA = 0.6;\nconst SHOULD_DELETE_NODE_WITH_EMPTY_LABEL = false;\n\nclass GraphNodeInputHandler extends AbstractInputHandler\n{\n    constructor(inputController, graphController)\n    {\n        super();\n        this._inputController = inputController;\n        this._graphController = graphController;\n\n        this._cachedPosition = { x: 0, y: 0 };\n    }\n\n    /** @override */\n    onInputEvent(pointer)\n    {\n        const inputController = this._inputController;\n        const currentTargetType = inputController.getCurrentTargetType();\n\n        if (inputController.isTrashMode())\n        {\n            if (currentTargetType === EVENT_SOURCE_NODE)\n            {\n                const currentTargetSource = inputController.getCurrentTargetSource();\n                const graphController = this._graphController;\n                graphController.getGraph().deleteNode(currentTargetSource);\n                graphController.emitGraphEvent(GRAPH_EVENT_NODE_DELETE, { target: currentTargetSource });\n                return true;\n            }\n        }\n\n        if (!inputController.isMoveMode(pointer.getInputAdapter()) && currentTargetType === EVENT_SOURCE_NODE)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n            const graphController = this._graphController;\n            graphController.openLabelEditor(currentTargetSource, currentTargetSource.getNodeLabel(),\n                (target, value, hasChanged) => \n                {\n                    if (SHOULD_DELETE_NODE_WITH_EMPTY_LABEL && !value)\n                    {\n                        graphController.getGraph().deleteNode(currentTargetSource);\n                        graphController.emitGraphEvent(GRAPH_EVENT_NODE_DELETE, { target: currentTargetSource });\n                    }\n                    else if (hasChanged)\n                    {\n                        graphController.emitGraphEvent(GRAPH_EVENT_NODE_LABEL_CHANGE, { target: currentTargetSource });\n                    }\n                });\n            return true;\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onAltInputEvent(pointer)\n    {\n        return this.onInputEvent(pointer);\n    }\n\n    /** @override */\n    onDblInputEvent(pointer)\n    {\n        const inputController = this._inputController;\n        if (inputController.hasActiveTarget()) return false;\n        if (inputController.isTrashMode()) return false;\n\n        const currentTargetType = inputController.getCurrentTargetType();\n        if (!currentTargetType)\n        {\n            const graphController = this._graphController;\n            const labelFormatter = graphController.getLabelFormatter();\n            const graph = graphController.getGraph();\n            const node = graph.createNode(pointer.x, pointer.y);\n            if (labelFormatter)\n            {\n                node.setNodeLabel(labelFormatter.getDefaultNodeLabel());\n            }\n            graphController.emitGraphEvent(GRAPH_EVENT_NODE_CREATE, { target: node });\n        }\n    }\n\n    /** @override */\n    onDragStart(pointer)\n    {\n        const inputController = this._inputController;\n        if (inputController.hasActiveTarget()) return false;\n        if (inputController.isTrashMode())\n        {\n            // Don't delete stuff if moving...\n            this._graphController.emitGraphEvent(GRAPH_EVENT_NODE_EDIT_WHILE_DELETE);\n            return false;\n        }\n        \n        const currentTargetType = inputController.getCurrentTargetType();\n        if (inputController.isMoveMode(pointer.getInputAdapter()) && currentTargetType === EVENT_SOURCE_NODE)\n        {\n            const selectionBox = inputController.getSelectionBox();\n            const currentTargetSource = inputController.getCurrentTargetSource();\n            if (selectionBox && selectionBox.hasSelection())\n            {\n                if (!selectionBox.isTargetInSelection(currentTargetSource))\n                {\n                    selectionBox.clearSelection();\n                }\n                else\n                {\n                    this._cachedPosition.x = pointer.x;\n                    this._cachedPosition.y = pointer.y;\n                }\n            }\n            inputController.bindActiveTarget(currentTargetSource, currentTargetType, false);\n            return true;\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onDragMove(pointer)\n    {\n        const inputController = this._inputController;\n        const selectionBox = inputController.getSelectionBox();\n        const targetSource = inputController.getActiveTargetSource();\n        if (selectionBox && selectionBox.hasSelection())\n        {\n            const dx = pointer.x - this._cachedPosition.x;\n            const dy = pointer.y - this._cachedPosition.y;\n            for (const node of selectionBox.getSelection())\n            {\n                node.x += dx;\n                node.y += dy;\n            }\n            this._cachedPosition.x = pointer.x;\n            this._cachedPosition.y = pointer.y;\n        }\n        else\n        {\n            this.moveNodeTo(this._graphController.getGraph(), targetSource, pointer.x, pointer.y);\n        }\n    }\n\n    /** @override */\n    onDragStop(pointer)\n    {\n        const inputController = this._inputController;\n        const graphController = this._graphController;\n        const selectionBox = inputController.getSelectionBox();\n\n        const targetSource = inputController.getActiveTargetSource();\n        inputController.unbindActiveTarget();\n\n        if (inputController.isTrashMode())\n        {\n            if (selectionBox.hasSelection())\n            {\n                const graph = graphController.getGraph();\n                const dst = [];\n                for (const node of selectionBox.getSelection())\n                {\n                    graph.deleteNode(node);\n                    dst.push(node);\n                }\n                selectionBox.clearSelection();\n                graphController.emitGraphEvent(GRAPH_EVENT_NODE_DELETE_ALL, { target: dst });\n            }\n            else\n            {\n                graphController.getGraph().deleteNode(targetSource);\n                graphController.emitGraphEvent(GRAPH_EVENT_NODE_DELETE, { target: targetSource });\n            }\n            return;\n        }\n\n        if (selectionBox.hasSelection())\n        {\n            graphController.emitGraphEvent(GRAPH_EVENT_NODE_MOVE_ALL, { target: selectionBox.getSelection() });\n        }\n        else\n        {\n            graphController.emitGraphEvent(GRAPH_EVENT_NODE_MOVE, { target: targetSource });\n        }\n    }\n\n    moveNodeTo(graph, node, x, y)\n    {\n        x = lerp(node.x, x, NODE_POSITION_INTERPOLATION_DELTA);\n        y = lerp(node.y, y, NODE_POSITION_INTERPOLATION_DELTA);\n\n        const nodeSize = node.getNodeSize();\n        for (const other of graph.getNodes())\n        {\n            //Update node collision\n            if (node === other) continue;\n\n            const dx = x - other.x;\n            const dy = y - other.y;\n            const angle = Math.atan2(dy, dx);\n\n            const diameter = (nodeSize * 2);\n            const nextDX = other.x + (Math.cos(angle) * diameter) - x;\n            const nextDY = other.y + (Math.sin(angle) * diameter) - y;\n\n            if (dx * dx + dy * dy < nodeSize * nodeSize * 4)\n            {\n                x += nextDX;\n                y += nextDY;\n            }\n        }\n\n        node.x = x;\n        node.y = y;\n    }\n}\n\nexport default GraphNodeInputHandler;","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\nimport { lerp } from 'util/MathHelper.js';\n\nimport { EVENT_SOURCE_FORWARD_ENDPOINT, EVENT_SOURCE_EDGE, EVENT_SOURCE_LABEL } from 'graph2/renderer/EdgeRenderer.js';\nimport { EVENT_SOURCE_NODE } from 'graph2/renderer/NodeRenderer.js';\n\nexport const GRAPH_EVENT_EDGE_CREATE = 'edge-create';\nexport const GRAPH_EVENT_EDGE_DELETE = 'edge-delete';\nexport const GRAPH_EVENT_EDGE_LABEL_CHANGE = 'edge-label-change';\nexport const GRAPH_EVENT_EDGE_TO_CHANGE = 'edge-to-change';\nexport const GRAPH_EVENT_EDGE_QUAD_CHANGE = 'edge-quad-change';\nexport const GRAPH_EVENT_EDGE_EDIT_WHILE_DELETE = 'error-edge-edit-while-delete';\n\nconst EDGE_POSITION_INTERPOLATION_DELTA = 0.6;\n\nclass GraphEdgeInputHandler extends AbstractInputHandler\n{\n    constructor(inputController, graphController)\n    {\n        super();\n\n        this._inputController = inputController;\n        this._graphController = graphController;\n\n        this._cachedEdgeQuads = {\n            radians: 0,\n            length: 0\n        };\n        this._cachedEdgeTo = null;\n        this._cachedPointer = { x: 0, y: 0 };\n        this._newEdge = false;\n\n        this._shouldDeleteEdgePlaceholder = false;\n        this._shouldDeleteEdgeWithEmptyLabel = false;\n    }\n\n    setShouldDeleteEdgePlaceholder(flag)\n    {\n        this._shouldDeleteEdgePlaceholder = flag;\n        return this;\n    }\n\n    setShouldDeleteEdgeWithEmptyLabel(flag)\n    {\n        this._shouldDeleteEdgeWithEmptyLabel = flag;\n        return this;\n    }\n\n    /** @override */\n    onInputEvent(pointer)\n    {\n        const inputController = this._inputController;\n        const currentTargetType = inputController.getCurrentTargetType();\n\n        if (inputController.isTrashMode())\n        {\n            if (currentTargetType === EVENT_SOURCE_EDGE ||\n                currentTargetType === EVENT_SOURCE_FORWARD_ENDPOINT ||\n                currentTargetType === EVENT_SOURCE_LABEL)\n            {\n                const currentTargetSource = inputController.getCurrentTargetSource();\n                const graphController = this._graphController;\n                graphController.getGraph().deleteEdge(currentTargetSource);\n                graphController.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, {target: currentTargetSource});\n                return true;\n            }\n        }\n\n        if (currentTargetType === EVENT_SOURCE_LABEL || currentTargetType === EVENT_SOURCE_EDGE)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n            const graphController = this._graphController;\n            graphController.openLabelEditor(currentTargetSource, currentTargetSource.getEdgeLabel(),\n                (target, value, hasChanged) => \n                {\n                    if (this._shouldDeleteEdgeWithEmptyLabel && !value)\n                    {\n                        graphController.getGraph().deleteEdge(currentTargetSource);\n                        graphController.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, {target: currentTargetSource});\n                    }\n                    else if (hasChanged)\n                    {\n                        graphController.emitGraphEvent(GRAPH_EVENT_EDGE_LABEL_CHANGE, {target: currentTargetSource});\n                    }\n                });\n            return true;\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onAltInputEvent(pointer)\n    {\n        return this.onInputEvent(pointer);\n    }\n\n    /** @override */\n    onDragStart(pointer)\n    {\n        const inputController = this._inputController;\n        if (inputController.hasActiveTarget()) return false;\n        if (inputController.isTrashMode())\n        {\n            //Don't delete stuff if moving...\n            this._graphController.emitGraphEvent(GRAPH_EVENT_EDGE_EDIT_WHILE_DELETE);\n            return false;\n        }\n\n        const currentTargetType = inputController.getCurrentTargetType();\n        if (!inputController.isMoveMode(pointer.getInputAdapter()) && currentTargetType === EVENT_SOURCE_NODE)\n        {\n            const graphController = this._graphController;\n            const graph = graphController.getGraph();\n\n            const currentTargetSource = inputController.getCurrentTargetSource();\n\n            this._cachedEdgeQuads.radians = 0;\n            this._cachedEdgeQuads.length = 0;\n            this._cachedEdgeTo = null;\n            this._newEdge = true;\n            this._cachedPointer.x = pointer.x;\n            this._cachedPointer.y = pointer.y;\n\n            const targetEdge = graph.createEdge(currentTargetSource, this._cachedPointer);\n\n            inputController.bindActiveTarget(targetEdge, EVENT_SOURCE_FORWARD_ENDPOINT, false);\n            inputController.setNodeEventsOnly(true);\n            return true;\n        }\n        else if (currentTargetType === EVENT_SOURCE_FORWARD_ENDPOINT)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n\n            this._cachedEdgeQuads.radians = currentTargetSource.getQuadraticRadians();\n            this._cachedEdgeQuads.length = currentTargetSource.getQuadraticLength();\n            this._cachedEdgeTo = currentTargetSource.getEdgeTo();\n            this._newEdge = false;\n            this._cachedPointer.x = pointer.x;\n            this._cachedPointer.y = pointer.y;\n\n            currentTargetSource.setQuadraticRadians(0);\n            currentTargetSource.setQuadraticLength(0);\n            currentTargetSource.setEdgeTo(this._cachedPointer);\n\n            inputController.bindActiveTarget(currentTargetSource, currentTargetType, false);\n            inputController.setNodeEventsOnly(true);\n            return true;\n        }\n        else if (currentTargetType === EVENT_SOURCE_EDGE)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n\n            this._cachedEdgeQuads.radians = currentTargetSource.getQuadraticRadians();\n            this._cachedEdgeQuads.length = currentTargetSource.getQuadraticLength();\n            this._cachedEdgeTo = currentTargetSource.getEdgeTo();\n            this._newEdge = false;\n            this._cachedPointer.x = pointer.x;\n            this._cachedPointer.y = pointer.y;\n\n            inputController.bindActiveTarget(currentTargetSource, currentTargetType, false);\n            return true;\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onDragMove(pointer)\n    {\n        const inputController = this._inputController;\n        const targetSource = inputController.getActiveTargetSource();\n        const targetType = inputController.getActiveTargetType();\n\n        if (targetType === EVENT_SOURCE_EDGE)\n        {\n            targetSource.setQuadraticByCoords(pointer.x, pointer.y);\n        }\n        else if (targetType === EVENT_SOURCE_FORWARD_ENDPOINT)\n        {\n            this.handleDragMoveForEndpoint(targetSource, targetType, pointer, inputController);\n        }\n    }\n\n    handleDragMoveForEndpoint(targetSource, targetType, pointer, inputController)\n    {\n        const immediateTargetType = inputController.getImmediateTargetType();\n        if (immediateTargetType === EVENT_SOURCE_NODE)\n        {\n            const immediateTargetSource = inputController.getImmediateTargetSource();\n            \n            // Restore the previously cached edge quadratics\n            if (targetSource.getEdgeTo() === this._cachedEdgeTo)\n            {\n                targetSource.setQuadraticRadians(this._cachedEdgeQuads.radians);\n                targetSource.setQuadraticLength(this._cachedEdgeQuads.length);\n            }\n            // Angle the self-loop edge towards the pointer\n            else if (targetSource.getEdgeFrom() === immediateTargetSource)\n            {\n                const from = targetSource.getEdgeFrom();\n                const dx = from.x - pointer.x;\n                const dy = from.y - pointer.y;\n                const radians = Math.PI + Math.atan2(dy, dx);\n                targetSource.setQuadraticRadians(radians);\n                targetSource.setEdgeTo(immediateTargetSource);\n            }\n            else\n            {\n                targetSource.setQuadraticRadians(0);\n                targetSource.setQuadraticLength(0);\n                targetSource.setEdgeTo(immediateTargetSource);\n            }\n        }\n        else\n        {\n            this._cachedPointer.x = lerp(this._cachedPointer.x, pointer.x, EDGE_POSITION_INTERPOLATION_DELTA);\n            this._cachedPointer.y = lerp(this._cachedPointer.y, pointer.y, EDGE_POSITION_INTERPOLATION_DELTA);\n\n            if (targetSource.getEdgeTo() !== this._cachedPointer)\n            {\n                targetSource.setQuadraticRadians(0);\n                targetSource.setQuadraticLength(0);\n\n                targetSource.setEdgeTo(this._cachedPointer);\n            }\n        }\n    }\n\n    /** @override */\n    onDragStop(pointer)\n    {\n        const inputController = this._inputController;\n        const targetSource = inputController.getActiveTargetSource();\n        const targetType = inputController.getActiveTargetType();\n        const isNewEdge = this._newEdge;\n\n        inputController.unbindActiveTarget();\n        if (targetType === EVENT_SOURCE_FORWARD_ENDPOINT)\n        {\n            inputController.setNodeEventsOnly(false);\n        }\n\n        const graphController = this._graphController;\n        if (inputController.isTrashMode())\n        {\n            graphController.getGraph().deleteEdge(targetSource);\n            graphController.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, {target: targetSource});\n            return;\n        }\n\n        if (targetType === EVENT_SOURCE_EDGE)\n        {\n            graphController.emitGraphEvent(GRAPH_EVENT_EDGE_QUAD_CHANGE, {target: targetSource});\n        }\n        else\n        {\n            const edgeTo = targetSource.getEdgeTo();\n            if (!edgeTo || edgeTo === this._cachedPointer)\n            {\n                if (this._shouldDeleteEdgePlaceholder)\n                {\n                    graphController.getGraph().deleteEdge(targetSource);\n                    graphController.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, {target: targetSource});\n                    return;\n                }\n                else\n                {\n                    targetSource.setEdgeTo(null);\n\n                    if (isNewEdge)\n                    {\n                        const labelFormatter = graphController.getLabelFormatter();\n                        if (labelFormatter)\n                        {\n                            targetSource.setEdgeLabel(labelFormatter.getDefaultEdgeLabel());\n                        }\n                        graphController.emitGraphEvent(GRAPH_EVENT_EDGE_CREATE, {target: targetSource});\n                    }\n                    else\n                    {\n                        graphController.emitGraphEvent(GRAPH_EVENT_EDGE_TO_CHANGE, {target: targetSource});\n                    }\n                }\n            }\n            else if (edgeTo !== this._cachedEdgeTo)\n            {\n                const labelFormatter = graphController.getLabelFormatter();\n                if (isNewEdge && labelFormatter)\n                {\n                    targetSource.setEdgeLabel(labelFormatter.getDefaultEdgeLabel());\n                }\n                graphController.openLabelEditor(targetSource, isNewEdge ? null : targetSource.getEdgeLabel(),\n                    (target, value, hasChanged) => \n                    {\n                        if (this._shouldDeleteEdgeWithEmptyLabel && !value)\n                        {\n                            graphController.getGraph().deleteEdge(targetSource);\n                            graphController.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, {target: targetSource});\n                        }\n                        else if (isNewEdge)\n                        {\n                            graphController.emitGraphEvent(GRAPH_EVENT_EDGE_CREATE, {target: targetSource});\n                        }\n                        else if (hasChanged)\n                        {\n                            graphController.emitGraphEvent(GRAPH_EVENT_EDGE_TO_CHANGE, {target: targetSource});\n                        }\n                    });\n            }\n        }\n    }\n}\n\nexport default GraphEdgeInputHandler;","import React from 'react';\n\nexport const EVENT_SOURCE_START_MARKER = 'start-marker';\n\nclass StartMarkerRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const position = this.props.position;\n        const radians = this.props.radians || Math.PI;\n        const offset = this.props.offset || 0;\n        const size = this.props.size || 24;\n        const color = this.props.color || '#000000';\n\n        const dx = Math.cos(radians);\n        const dy = Math.sin(radians);\n        const x = position.x + dx * offset;\n        const y = position.y + dy * offset;\n\n        // FIXME: this does not work for ALL arbitrary angles...\n        const radiusX = dx * size;\n        const diameterX = radiusX * 2;\n        // const radiusY = dy * size;\n\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        return (\n            <g>\n                <path\n                    d={'M' + x + ' ' + y +\n                        ' L' + (x + diameterX) + ' ' + (y + Math.sin(radians + Math.PI / 2) * size * 2) +\n                        ' L' + (x + diameterX) + ' ' + (y - Math.sin(radians + Math.PI / 2) * size * 2) +\n                        ' Z'}\n                    fill=\"transparent\"\n                    stroke={color}\n                    cursor=\"pointer\"\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.type = EVENT_SOURCE_START_MARKER;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.type = EVENT_SOURCE_START_MARKER;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n            </g>\n        );\n    }\n}\n\nexport default StartMarkerRenderer;\n","import React from 'react';\n\nclass RunningManIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M13.49 5.48c1.1 0 2-.9 2-2s-.9-2-2-2-2 .9-2 2 .9 2 2 2zm-3.6 13.9l1-4.4 2.1 2v6h2v-7.5l-2.1-2 .6-3c1.3 1.5 3.3 2.5 5.5 2.5v-2c-1.9 0-3.5-1-4.3-2.4l-1-1.6c-.4-.6-1-1-1.7-1-.3 0-.5.1-.8.1l-5.2 2.2v4.7h2v-3.4l1.8-.7-1.6 8.1-4.9-1-.4 2 7 1.4z\"/>\n            </svg>\n        );\n    }\n}\nexport default RunningManIcon;\n","import IndexedNodeGraph from 'graph2/IndexedNodeGraph.js';\n\nimport FSANode from './element/FSANode.js';\nimport FSAEdge from './element/FSAEdge.js';\n\nclass FSAGraph extends IndexedNodeGraph\n{\n    constructor()\n    {\n        super(FSANode, FSAEdge);\n    }\n}\n\nexport default FSAGraph;\n","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\nimport { lerp } from 'util/MathHelper.js';\n\nimport { EVENT_SOURCE_START_MARKER } from '../renderer/StartMarkerRenderer.js';\nimport { EVENT_SOURCE_NODE } from '../renderer/NodeRenderer.js';\n\nexport const GRAPH_EVENT_START_MARKER_CHANGE = 'start-marker-change';\n\nconst START_MARKER_POSITION_INTERPOLATION_DELTA = 0.6;\n\nclass GraphStartMarkerInputHandler extends AbstractInputHandler\n{\n    constructor(inputController, graphController)\n    {\n        super();\n\n        this._inputController = inputController;\n        this._graphController = graphController;\n\n        this._ghostMarker = null;\n        this._cachedMarkerTarget = null;\n        this._cachedPointer = { x: 0, y: 0 };\n    }\n\n    /** @override */\n    onDragStart(pointer)\n    {\n        const inputController = this._inputController;\n        const currentTargetType = inputController.getCurrentTargetType();\n\n        if (currentTargetType === EVENT_SOURCE_START_MARKER)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n            this._cachedMarkerTarget = currentTargetSource;\n            this._cachedPointer.x = pointer.x;\n            this._cachedPointer.y = pointer.y;\n            this._ghostMarker = this._cachedPointer;\n\n            inputController.bindActiveTarget(currentTargetSource, EVENT_SOURCE_START_MARKER, true);\n            inputController.setNodeEventsOnly(true);\n            return true;\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onDragMove(pointer)\n    {\n        const inputController = this._inputController;\n        const targetType = inputController.getActiveTargetType();\n\n        if (targetType === EVENT_SOURCE_START_MARKER)\n        {\n            const immediateTargetType = inputController.getImmediateTargetType();\n            if (immediateTargetType === EVENT_SOURCE_NODE)\n            {\n                const immediateTargetSource = inputController.getImmediateTargetSource();\n\n                this._ghostMarker = immediateTargetSource;\n            }\n            else\n            {\n                this._cachedPointer.x = lerp(this._cachedPointer.x, pointer.x, START_MARKER_POSITION_INTERPOLATION_DELTA);\n                this._cachedPointer.y = lerp(this._cachedPointer.y, pointer.y, START_MARKER_POSITION_INTERPOLATION_DELTA);\n\n                if (this._ghostMarker !== this._cachedPointer)\n                {\n                    this._ghostMarker = this._cachedPointer;\n                }\n            }\n        }\n    }\n\n    /** @override */\n    onDragStop(pointer)\n    {\n        const inputController = this._inputController;\n        const targetType = inputController.getActiveTargetType();\n        inputController.unbindActiveTarget();\n\n        if (targetType === EVENT_SOURCE_START_MARKER)\n        {\n            if (!this._ghostMarker || this._ghostMarker === this._cachedPointer)\n            {\n                // Don't do anything, cause it should already be correct...\n            }\n            else\n            {\n                this._graphController.getGraph().setStartNode(this._ghostMarker);\n                this._graphController.emitGraphEvent(GRAPH_EVENT_START_MARKER_CHANGE, { target: this._ghostMarker });\n            }\n\n            this._ghostMarker = null;\n        }\n    }\n\n    getGhostMarker() { return this._ghostMarker; }\n}\n\nexport default GraphStartMarkerInputHandler;","\nfunction getReachableState(graph)\n{\n    let reachable = [];\n    let startNode = graph.getStartNode();\n    reachable.push(startNode);\n    for(let i = 0; i < reachable.length; i++)\n    {\n        for (const edge of graph.getEdges())\n        {\n            if(edge._from == reachable[i])\n            {\n                if(!reachable.includes(edge._to))\n                {\n                    reachable.push(edge._to);\n                }\n            }\n        }\n    }\n    return reachable;\n}\n\nclass GraphLayout\n{\n    static applyLayout(graph, type='circle')\n    {\n        if (type != 'circle') throw new Error('Invalid layout type');\n        //seperate node to reachable and unreachable\n        const reachableNode= getReachableState(graph);\n        function unreachable(node)\n        {\n            return !reachableNode.includes(node);\n        }\n        const unreachableNode = graph.getNodes().filter(unreachable);\n\n        //get num of nodes\n        const numOfReachable = reachableNode.length;\n        const numOfUnreachable = unreachableNode.length;\n        const numOfNode = graph.getNodes().length;\n        const maxNum = Math.max(numOfReachable, numOfUnreachable);\n        if(numOfNode == 0)\n        {\n            return;\n        }\n        //set radius\n        var radius;\n        if(numOfReachable < 10 && numOfUnreachable < 10)\n        {\n            radius = maxNum/4 * 50 + 30;\n        }\n        else\n        {\n            radius = (maxNum/5) * 40 + 30;\n        }\n\n        let currentStep = 0;\n        if (numOfReachable == 1)\n        {\n            let degree = 2* Math.PI/numOfNode;\n            for(const node of graph.getNodes())\n            {\n                node.y = Math.sin(degree*currentStep + Math.PI)*radius;\n                node.x = Math.cos(degree*currentStep + Math.PI)*radius;\n                currentStep += 1;\n            }\n        }\n        else \n        {\n            const degree_re = 2* Math.PI/numOfReachable;\n            const degree_un = 2* Math.PI/numOfUnreachable;\n\n            currentStep = 0;\n            for(const node of reachableNode)\n            {\n                node.y = Math.sin(degree_re*currentStep + Math.PI)*radius;\n                node.x = Math.cos(degree_re*currentStep + Math.PI)*radius;\n                currentStep += 1;\n            }\n            currentStep = 0;\n            for(const node of unreachableNode)\n            {\n                node.y = Math.sin(degree_un*currentStep + Math.PI)*(radius + 100);\n                node.x = Math.cos(degree_un*currentStep + Math.PI)*(radius + 100);\n                currentStep += 1;\n            }\n        }\n    /*for(const node of graph.getNodes())\n    {\n      node.y = Math.sin(degree*currentStep + Math.PI)*radius;\n      node.x = Math.cos(degree*currentStep + Math.PI)*radius;\n      currentStep += 1\n    }*/\n    }\n\n\n}\n\nexport default GraphLayout;\n","import FSA from '../FSA.js';\n\nexport function invertDFA(fsa, dst = new FSA(true))\n{\n    dst.copy(fsa);\n\n    const toBeRejected = new Set(dst.getFinalStates());\n    for (const state of dst.getStates())\n    {\n        if (toBeRejected.has(state))\n        {\n            dst.setFinalState(state, false);\n        }\n        else\n        {\n            dst.setFinalState(state, true);\n        }\n    }\n\n    return dst;\n}\n","class AbstractEventHandler\n{\n    constructor() {}\n\n    applyUndo(undoManager)\n    {\n        throw new Error('Undo operation for handler not supported');\n    }\n\n    applyRedo(undoManager)\n    {\n        throw new Error('Redo operation for handler not supported');\n    }\n}\n\nexport default AbstractEventHandler;\n","import React from 'react';\n\nclass ZoomInIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z\"/>\n                <path d=\"M12 10h-2v2H9v-2H7V9h2V7h1v2h2v1z\"/>\n            </svg>\n        );\n    }\n}\nexport default ZoomInIcon;\n","import React from 'react';\n\nclass ZoomOutIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14zM7 9h5v1H7z\"/>\n            </svg>\n        );\n    }\n}\nexport default ZoomOutIcon;\n","import React from 'react';\nimport Style from './ZoomWidget.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport ZoomInIcon from 'components/iconset/ZoomInIcon.js';\nimport ZoomOutIcon from 'components/iconset/ZoomOutIcon.js';\n\nclass ZoomWidget extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onZoomIn = this.onZoomIn.bind(this);\n        this.onZoomOut = this.onZoomOut.bind(this);\n    }\n\n    onZoomIn(e)\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n        const viewScale = -viewportAdapter.getScale() * 0.4;\n        viewportAdapter.addScale(viewScale);\n    }\n\n    onZoomOut(e)\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n        const viewScale = viewportAdapter.getScale() * 0.75;\n        viewportAdapter.addScale(viewScale);\n    }\n\n    /** @override */\n    render()\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n        const viewScale = 'x' + (1 / (viewportAdapter.getScale() || 1)).toFixed(2);\n\n        return (\n            <div id={this.props.id}\n                className={Style.zoom_container +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                <IconButton className={Style.zoom_button} title=\"Zoom In\" onClick={this.onZoomIn}>\n                    <ZoomInIcon/>\n                </IconButton>\n                <IconButton className={Style.zoom_button} title=\"Zoom Out\" onClick={this.onZoomOut}>\n                    <ZoomOutIcon/>\n                </IconButton>\n                <label className={Style.zoom_label}>{viewScale}</label>\n            </div>\n        );\n    }\n}\n\nexport default ZoomWidget;\n","import React from 'react';\n\nclass PinpointIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm8.94 3c-.46-4.17-3.77-7.48-7.94-7.94V1h-2v2.06C6.83 3.52 3.52 6.83 3.06 11H1v2h2.06c.46 4.17 3.77 7.48 7.94 7.94V23h2v-2.06c4.17-.46 7.48-3.77 7.94-7.94H23v-2h-2.06zM12 19c-3.87 0-7-3.13-7-7s3.13-7 7-7 7 3.13 7 7-3.13 7-7 7z\"/>\n            </svg>\n        );\n    }\n}\nexport default PinpointIcon;\n","import React from 'react';\nimport Style from './FocusCenterWidget.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport PinpointIcon from 'components/iconset/PinpointIcon.js';\n\nconst OFFSET_EPSILON = 0.1;\n\nclass FocusCenterWidget extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(e)\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n        viewportAdapter.setOffset(0, 0);\n    }\n\n    /** @override */\n    render()\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n\n        return (\n            <IconButton id={this.props.id}\n                className={Style.center_focus_button +\n                    ' ' + this.props.className}\n                style={this.props.style}\n                title={'Center Workspace'}\n                disabled={Math.abs(viewportAdapter.getOffsetX()) < OFFSET_EPSILON &&\n                    Math.abs(viewportAdapter.getOffsetY()) < OFFSET_EPSILON}\n                onClick={this.onClick}>\n                <PinpointIcon />\n            </IconButton>\n        );\n    }\n}\n\nexport default FocusCenterWidget;\n","import React from 'react';\nimport Style from './ViewportNavigationLayer.css';\n\nimport ZoomWidget from '../widgets/ZoomWidget.js';\nimport FocusCenterWidget from '../widgets/FocusCenterWidget.js';\n\nclass ViewportNavigationLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const viewportAdapter = this.props.viewportAdapter;\n\n        return (\n            <div id={this.props.id}\n                className={Style.navbar_container +\n\t\t\t\t\t' ' + this.props.className}\n                style={this.props.style}>\n                <ZoomWidget className={Style.navbar_widget_container}\n                    viewportAdapter={viewportAdapter} />\n                <FocusCenterWidget className={Style.navbar_widget}\n                    viewportAdapter={viewportAdapter} />\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default ViewportNavigationLayer;","import React from 'react';\n\nclass JSONFileIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 56 56\">\n                <path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n                <polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n                <path fill=\"#9777A8\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n                <path fill=\"#FFFFFF\" d={'M17.021,42.719v7.848c0,0.474-0.087,0.873-0.26,1.196s-0.405,0.583-0.697,0.779 s-0.627,0.333-1.005,0.41c-0.378,0.077-0.768,0.116-1.169,0.116c-0.2,0-0.436-0.021-0.704-0.062s-0.547-0.104-0.834-0.191 s-0.563-0.185-0.827-0.294s-0.487-0.232-0.67-0.369l0.697-1.107c0.091,0.063,0.221,0.13,0.39,0.198s0.354,0.132,0.554,0.191 s0.41,0.111,0.629,0.157s0.424,0.068,0.615,0.068c0.483,0,0.868-0.094,1.155-0.28s0.439-0.504,0.458-0.95v-7.711H17.021z'}/>\n                <path fill=\"#FFFFFF\" d={'M25.184,50.238c0,0.364-0.075,0.718-0.226,1.06s-0.362,0.643-0.636,0.902s-0.61,0.467-1.012,0.622 s-0.856,0.232-1.367,0.232c-0.219,0-0.444-0.012-0.677-0.034s-0.467-0.062-0.704-0.116c-0.237-0.055-0.463-0.13-0.677-0.226 s-0.398-0.212-0.554-0.349l0.287-1.176c0.128,0.073,0.289,0.144,0.485,0.212s0.398,0.132,0.608,0.191s0.419,0.107,0.629,0.144 s0.405,0.055,0.588,0.055c0.556,0,0.982-0.13,1.278-0.39s0.444-0.645,0.444-1.155c0-0.31-0.104-0.574-0.314-0.793 s-0.472-0.417-0.786-0.595s-0.654-0.355-1.019-0.533s-0.706-0.388-1.025-0.629s-0.583-0.526-0.793-0.854s-0.314-0.738-0.314-1.23 c0-0.446,0.082-0.843,0.246-1.189s0.385-0.641,0.663-0.882s0.602-0.426,0.971-0.554s0.759-0.191,1.169-0.191 c0.419,0,0.843,0.039,1.271,0.116s0.774,0.203,1.039,0.376c-0.055,0.118-0.118,0.248-0.191,0.39s-0.142,0.273-0.205,0.396 s-0.118,0.226-0.164,0.308s-0.073,0.128-0.082,0.137c-0.055-0.027-0.116-0.063-0.185-0.109s-0.166-0.091-0.294-0.137 s-0.296-0.077-0.506-0.096s-0.479-0.014-0.807,0.014c-0.183,0.019-0.355,0.07-0.52,0.157s-0.31,0.193-0.438,0.321 s-0.228,0.271-0.301,0.431s-0.109,0.313-0.109,0.458c0,0.364,0.104,0.658,0.314,0.882s0.47,0.419,0.779,0.588 s0.647,0.333,1.012,0.492s0.704,0.354,1.019,0.581s0.576,0.513,0.786,0.854S25.184,49.7,25.184,50.238z'}/>\n                <path fill=\"#FFFFFF\" d={'M35.082,47.914c0,0.848-0.107,1.595-0.321,2.242s-0.511,1.185-0.889,1.613s-0.82,0.752-1.326,0.971 s-1.06,0.328-1.661,0.328s-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971s-0.675-0.966-0.889-1.613s-0.321-1.395-0.321-2.242 s0.107-1.593,0.321-2.235s0.511-1.178,0.889-1.606s0.82-0.754,1.326-0.978s1.06-0.335,1.661-0.335s1.155,0.111,1.661,0.335 s0.948,0.549,1.326,0.978s0.675,0.964,0.889,1.606S35.082,47.066,35.082,47.914z M30.844,51.729c0.337,0,0.658-0.066,0.964-0.198 s0.579-0.349,0.82-0.649s0.431-0.695,0.567-1.183s0.21-1.082,0.219-1.784c-0.009-0.684-0.08-1.265-0.212-1.743 s-0.314-0.873-0.547-1.183s-0.497-0.533-0.793-0.67s-0.608-0.205-0.937-0.205c-0.337,0-0.658,0.063-0.964,0.191 s-0.579,0.344-0.82,0.649s-0.431,0.699-0.567,1.183c-0.137,0.483-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.267,0.212,1.75 s0.314,0.877,0.547,1.183s0.497,0.528,0.793,0.67S30.516,51.729,30.844,51.729z'}/>\n                <path fill=\"#FFFFFF\" d=\"M44.68,42.924V53h-1.668l-3.951-6.945V53h-1.668V42.924h1.668l3.951,6.945v-6.945H44.68z\"/>\n                <path fill=\"#9777A8\" d=\"M19.5,19v-4c0-0.551,0.448-1,1-1c0.553,0,1-0.448,1-1s-0.447-1-1-1c-1.654,0-3,1.346-3,3v4 c0,1.103-0.897,2-2,2c-0.553,0-1,0.448-1,1s0.447,1,1,1c1.103,0,2,0.897,2,2v4c0,1.654,1.346,3,3,3c0.553,0,1-0.448,1-1 s-0.447-1-1-1c-0.552,0-1-0.449-1-1v-4c0-1.2-0.542-2.266-1.382-3C18.958,21.266,19.5,20.2,19.5,19z\"/>\n                <circle fill=\"#9777A8\" cx=\"27.5\" cy=\"18.5\" r=\"1.5\"/>\n                <path fill=\"#9777A8\" d=\"M39.5,21c-1.103,0-2-0.897-2-2v-4c0-1.654-1.346-3-3-3c-0.553,0-1,0.448-1,1s0.447,1,1,1 c0.552,0,1,0.449,1,1v4c0,1.2,0.542,2.266,1.382,3c-0.84,0.734-1.382,1.8-1.382,3v4c0,0.551-0.448,1-1,1c-0.553,0-1,0.448-1,1 s0.447,1,1,1c1.654,0,3-1.346,3-3v-4c0-1.103,0.897-2,2-2c0.553,0,1-0.448,1-1S40.053,21,39.5,21z\"/>\n                <path fill=\"#9777A8\" d=\"M27.5,24c-0.553,0-1,0.448-1,1v3c0,0.552,0.447,1,1,1s1-0.448,1-1v-3 C28.5,24.448,28.053,24,27.5,24z\"/>\n            </svg>\n        );\n    }\n}\nexport default JSONFileIcon;\n","import React from 'react';\n\nclass BoxAddIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\" />\n            </svg>\n        );\n    }\n}\nexport default BoxAddIcon;\n","import Importer from 'util/file/import/Importer.js';\n\nclass SessionImporter extends Importer\n{\n    constructor(app)\n    {\n        super();\n\n        this._app = app;\n    }\n\n    onParseSession(session, fileData)\n    {\n        return fileData;\n    }\n\n    onPreImportSession(session)\n    {\n        session.getApp().getUndoManager().captureEvent();\n    }\n\n    onImportSession(session, sessionData)\n    {\n        \n    }\n\n    onPostImportSession(session)\n    {\n        session.getApp().getUndoManager().captureEvent();\n    }\n\n    /** @override */\n    importFileData(fileName, fileType, fileData)\n    {\n        const app = this._app;\n        const session = app.getSession();\n        const currentModule = session.getCurrentModule();\n        const result = this.onParseSession(session, fileData);\n\n        this.onPreImportSession(session);\n\n        this.onImportSession(session, result);\n\n        let projectName;\n        if (fileName)\n        {\n            projectName = fileName.substring(0, fileName.length - fileType.length);\n        }\n        else\n        {\n            projectName = result['_metadata']['name'];\n        }\n        \n        app.getSession().setProjectName(projectName);\n\n        this.onPostImportSession(session);\n\n        return currentModule;\n    }\n}\n\nexport default SessionImporter;\n","class Importer\n{\n    constructor() {}\n\n    /**\n     * Try to import the target file. Assumes that isValidFile() returns true.\n     * \n     * @param {String} fileName the name of the target file\n     * @param {String} fileType the associated file extension\n     * @param {String} fileData the file content to import\n     * @returns {Promise} a Promise that resolves if imported without errors\n     */\n    importFileData(fileName, fileType, fileData)\n    {\n        return Promise.resolve(fileData);\n    }\n    \n    getDataType() { return 'text'; }\n}\nexport default Importer;\n","import React from 'react';\n\nconst HIGHLIGHT_LINE_WIDTH = 3;\nconst HIGHLIGHT_LINE_ARRAY = [8, 6];\nconst HIGHLIGHT_OFFSET = 0;\n\nclass GraphHighlightRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const center = this.props.center;\n        const stroke = this.props.color || '#CCCCCC';\n        const radius = this.props.radius || 24;\n        \n        return (\n            <React.Fragment>\n                <circle className=\"graph-ui\"\n                    cx={center.x} cy={center.y} r={radius}\n                    stroke={stroke}\n                    strokeDashoffset={HIGHLIGHT_OFFSET}\n                    strokeDasharray={HIGHLIGHT_LINE_ARRAY}\n                    strokeWidth={HIGHLIGHT_LINE_WIDTH}\n                    fill=\"none\"\n                    pointerEvents=\"none\" />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default GraphHighlightRenderer;\n","import React from 'react';\n\nimport GraphHighlightRenderer from '../../renderer/GraphHighlightRenderer.js';\n\nconst HIGHLIGHT_OFFSET = 4;\n\nclass GraphHighlightLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const highlights = [];\n\n        const nodes = this.props.nodes;\n        if (nodes)\n        {\n            for(const node of nodes)\n            {\n                highlights.push(\n                    <GraphHighlightRenderer\n                        key={node.getGraphElementID()}\n                        center={node}\n                        radius={node.getNodeSize() + HIGHLIGHT_OFFSET}/>\n                );\n            }\n        }\n\n        const edges = this.props.edges;\n        if (edges)\n        {\n            for(const edge of edges)\n            {\n                highlights.push(\n                    <GraphHighlightRenderer\n                        key={edge.getGraphElementID()}\n                        center={edge.getCenterPoint()}/>\n                );\n            }\n        }\n\n        return (\n            <g>\n                {highlights}\n            </g>\n        );\n    }\n}\n\nexport default GraphHighlightLayer;","/**\n * @module UserUtil\n * @desc Contains utility functions for user-related actions.\n */\n\n/**\n * Clears the graph with user-prompts.\n * @param {*} app the current app.\n * @param {*} graphOnly whether to only clear the graph only.\n * @param {*} callback a callback for when it is done.\n */\nexport function userClearGraph(app, graphOnly=false, callback=null)\n{\n    if (window.confirm(I18N.toString('alert.graph.clear')))\n    {\n        const module = app.getCurrentModule();\n        module.getGraphController().getGraph().clear();\n        if (!graphOnly)\n        {\n            app.getUndoManager().clear();\n            app.getSession().setProjectName(null);\n        }\n        else\n        {\n            app.getUndoManager().captureEvent();\n        }\n        if (callback) callback();\n    }\n}\n","import NodeGraph from 'graph2/NodeGraph.js';\n\n/**\n * A class that represents a node graph with indexed and ordered node list.\n * This means that there exists a first node, which would be used for the\n * start node, if that semantically makes sense for your graph.\n */\nclass IndexedNodeGraph extends NodeGraph\n{\n    /**\n     * Create an IndexedNodeGraph with the respective node and edge classes.\n     * @param {Class} [nodeClass]\n     * @param {Class} [edgeClass]\n     */\n    constructor(nodeClass, edgeClass)\n    {\n        super(nodeClass, edgeClass);\n\n        this._nodes = [];\n    }\n\n    /**\n     * Sets the first node, which is at index 0, to the passed-in node. The node must\n     * already exist in the graph.\n     * @param {GraphNode} node the node to be first\n     */\n    setStartNode(node)\n    {\n        if (this._nodes.length <= 0) throw new Error('Cannot set start node to empty graph');\n\n        // There is only one node, and that is already the start node\n        if (this._nodes.length === 1) return;\n\n        const i = this._nodes.indexOf(node);\n        if (i > 0)\n        {\n            // This does a swap; we could do a prepend but that's more costly...\n            const prev = this._nodes[0];\n            this._nodes[0] = node;\n            this._nodes[i] = prev;\n        }\n        else if (i < 0)\n        {\n            throw new Error('Cannot set start node for unknown node');\n        }\n    }\n\n    /**\n     * Gets the first node, which is at index 0, for the graph.\n     */\n    getStartNode() { return this._nodes.length > 0 ? this._nodes[0] : null; }\n\n    /**\n     * Gets the node by its index. The index must be between 0 and the node count.\n     * @param {Number} index \n     */\n    getNodeByIndex(index)\n    {\n        return this._nodes[index];\n    }\n\n    /** @override */\n    addNode(node)\n    {\n        this._nodes.push(node);\n        return super.addNode(node);\n    }\n\n    /** @override */\n    deleteNode(node)\n    {\n        super.deleteNode(node);\n        const i = this._nodes.indexOf(node);\n        if (i >= 0) this._nodes.splice(i, 1);\n    }\n\n    /** @override */\n    clearNodes()\n    {\n        super.clearNodes();\n        this._nodes.length = 0;\n    }\n\n    /** @override */\n    getNodes()\n    {\n        return this._nodes;\n    }\n}\n\nexport default IndexedNodeGraph;\n","export const FILE_TYPE_PNG = 'png';\nexport const FILE_TYPE_JPG = 'jpg';\nexport const FILE_TYPE_SVG = 'svg';\n\nexport function downloadText(filename, textData)\n{\n    downloadURL(filename, getTextDataURI(textData));\n}\n\nfunction createBlobFromSVG(svg)\n{\n    const serializer = new XMLSerializer();\n    const svgString = serializer.serializeToString(svg);\n    const blob = new Blob([svgString], { type: 'image/svg+xml' });\n    return blob;\n}\n\nexport function downloadImageFromSVG(filename, filetype, svg, width, height)\n{\n    const blob = createBlobFromSVG(svg);\n    switch (filetype)\n    {\n    case FILE_TYPE_PNG:\n    case FILE_TYPE_JPG:\n        {\n            const url = URL.createObjectURL(blob);\n\n            const canvas = document.createElement('canvas');\n            const ctx = canvas.getContext('2d');\n            const pixelRatio = window.devicePixelRatio || 1;\n            canvas.width = width * pixelRatio;\n            canvas.height = height * pixelRatio;\n            canvas.style.width = width + 'px';\n            canvas.style.height = height + 'px';\n            ctx.setTransform(pixelRatio, 0, 0, pixelRatio, 0, 0);\n\n            const image = new Image();\n            image.onload = () => \n            {\n                ctx.drawImage(image, 0, 0);\n                URL.revokeObjectURL(url);\n\n                const imageURI = canvas.toDataURL('image/' + filetype).replace('image/' + filetype, 'image/octet-stream');\n                downloadURL(filename + '.' + filetype, imageURI);\n            };\n            image.src = url;\n        }\n        break;\n    case FILE_TYPE_SVG:\n        {\n            const reader = new FileReader();\n            reader.onload = () => \n            {\n                downloadURL(filename + '.' + filetype, reader.result);\n            };\n            reader.readAsDataURL(blob);\n        }\n        break;\n    default:\n        throw new Error('Unknown file type \\'' + filetype + '\\'');\n    }\n}\n\nexport function downloadURL(filename, url)\n{\n    const element = document.createElement('a');\n    const headerIndex = url.indexOf(';');\n    url = url.substring(0, headerIndex + 1) + 'headers=Content-Disposition%3A%20attachment%3B%20filename=' + filename + ';' + url.substring(headerIndex + 1);\n    element.setAttribute('href', url);\n    element.setAttribute('download', filename);\n\n    element.style.display = 'none';\n    document.body.appendChild(element);\n\n    element.click();\n    document.body.removeChild(element);\n}\n\nfunction getTextDataURI(data)\n{\n    return 'data:text/plain; charset=utf-8,' + encodeURIComponent(data);\n}\n","import React from 'react';\n\nclass PageContentIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z\"/>\n            </svg>\n        );\n    }\n}\nexport default PageContentIcon;\n","import React from 'react';\n\nclass AddIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z\"/>\n            </svg>\n        );\n    }\n}\nexport default AddIcon;\n","import React from 'react';\n\nclass SubtractIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11H7v-2h10v2z\"/>\n            </svg>\n        );\n    }\n}\nexport default SubtractIcon;\n","import React from 'react';\n\nclass CheckCircleIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M16.59 7.58L10 14.17l-3.59-3.58L5 12l5 5 8-8zM12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\"/>\n            </svg>\n        );\n    }\n}\nexport default CheckCircleIcon;\n","import React from 'react';\n\nclass CrossCircleIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M14.59 8L12 10.59 9.41 8 8 9.41 10.59 12 8 14.59 9.41 16 12 13.41 14.59 16 16 14.59 13.41 12 16 9.41 14.59 8zM12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z\"/>\n            </svg>\n        );\n    }\n}\nexport default CrossCircleIcon;\n","import React from 'react';\n\nclass PendingIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M19 8l-4 4h3c0 3.31-2.69 6-6 6-1.01 0-1.97-.25-2.8-.7l-1.46 1.46C8.97 19.54 10.43 20 12 20c4.42 0 8-3.58 8-8h3l-4-4zM6 12c0-3.31 2.69-6 6-6 1.01 0 1.97.25 2.8.7l1.46-1.46C15.03 4.46 13.57 4 12 4c-4.42 0-8 3.58-8 8H1l4 4 4-4H6z\"/>\n            </svg>\n        );\n    }\n}\nexport default PendingIcon;\n","/**\n * Represents and handles the transformations to the interactible viewport of\n * the SVG element.\n */\nclass ViewportAdapter\n{\n    constructor()\n    {\n        this._element = null;\n        this._offsetX = 0;\n        this._offsetY = 0;\n        this._nextOffsetX = 0;\n        this._nextOffsetY = 0;\n        this._offsetDamping = 0.1;\n\n        this._scaleFactor = 1;\n        this._minScale = 1;\n        this._maxScale = 1;\n    }\n\n    setElement(element)\n    {\n        this._element = element;\n        return this;\n    }\n\n    setMinScale(scale)\n    {\n        this._minScale = scale;\n        if (this._scaleFactor < this._minScale) this._scaleFactor = this._minScale;\n        return this;\n    }\n\n    setMaxScale(scale)\n    {\n        this._maxScale = scale;\n        if (this._scaleFactor > this._maxScale) this._scaleFactor = this._maxScale;\n        return this;\n    }\n\n    setOffsetDamping(damping)\n    {\n        this._offsetDamping = damping;\n        return this;\n    }\n\n    update()\n    {\n        const dx = this._nextOffsetX - this._offsetX;\n        this._offsetX += dx * this._offsetDamping;\n        const dy = this._nextOffsetY - this._offsetY;\n        this._offsetY += dy * this._offsetDamping;\n    }\n\n    transformScreenToView(clientX, clientY)\n    {\n        if (!this._element) return {x: clientX - this._offsetX, y: clientY - this._offsetY};\n\n        const ctm = this._element.getScreenCTM();\n        return {\n            x: (clientX - ctm.e) / ctm.a - this._offsetX,\n            y: (clientY - ctm.f) / ctm.d - this._offsetY\n        };\n    }\n\n    setOffset(x, y, immediate=false)\n    {\n        if (immediate)\n        {\n            this._nextOffsetX = this._offsetX = x;\n            this._nextOffsetY = this._offsetY = y;\n        }\n        else\n        {\n            this._nextOffsetX = x;\n            this._nextOffsetY = y;\n        }\n    }\n\n    addOffset(dx, dy, immediate=false)\n    {\n        if (immediate)\n        {\n            this._offsetX += dx;\n            this._offsetY += dy;\n            this._nextOffsetX = this._offsetX;\n            this._nextOffsetY = this._offsetY;\n        }\n        else\n        {\n            this._nextOffsetX += dx;\n            this._nextOffsetY += dy;\n        }\n    }\n\n    setScale(scale) { this._scaleFactor = Math.min(this._maxScale, Math.max(this._minScale, scale)); }\n    addScale(dscale) { this._scaleFactor = Math.min(this._maxScale, Math.max(this._minScale, this._scaleFactor + dscale)); }\n    getOffsetX() { return this._offsetX; }\n    getOffsetY() { return this._offsetY; }\n    getOffsetDamping() { return this._offsetDamping; }\n    getScale() { return this._scaleFactor; }\n    getMinScale() { return this._minScale; }\n    getMaxScale() { return this._maxScale; }\n    getElement() { return this._element; }\n}\n\nexport default ViewportAdapter;\n","class InputContext\n{\n    constructor()\n    {\n        this._inputHandlers = [];\n    }\n\n    addInputHandler(inputHandler, priority = -1)\n    {\n        if (priority < 0)\n        {\n            this._inputHandlers.push(inputHandler);\n        }\n        else\n        {\n            if (this._inputHandlers.length <= priority)\n            {\n                this._inputHandlers.length = priority + 1;\n            }\n\n            if (this._inputHandlers[priority])\n            {\n                this._inputHandlers.splice(1, 0, inputHandler);\n            }\n            else\n            {\n                this._inputHandlers[priority] = inputHandler;\n            }\n        }\n\n        return this;\n    }\n\n    removeInputHandler(inputHandler)\n    {\n        const index = this._inputHandlers.indexOf(inputHandler);\n        if (index >= 0)\n        {\n            this._inputHandlers[index] = null;\n        }\n        return this;\n    }\n\n    clearInputHandlers() { this._inputHandlers.length = 0; }\n\n    handleEvent(eventName, ...eventArgs)\n    {\n        //Let others handle this event...\n        for (const inputHandler of this._inputHandlers)\n        {\n            if (!inputHandler) continue;\n            const handlerEventCallback = inputHandler[eventName];\n            if (typeof handlerEventCallback === 'function')\n            {\n                if (handlerEventCallback.apply(inputHandler, eventArgs))\n                {\n                    return inputHandler;\n                }\n            }\n        }\n\n        return null;\n    }\n\n    getInputHandlers() { return this._inputHandlers; }\n}\n\nexport default InputContext;","/**\n * Used by InputAdapter to hold input event data.\n */\nclass InputPointer\n{\n    constructor(inputAdapter, viewportAdapter, element)\n    {\n        this._inputAdapter = inputAdapter;\n        this._viewportAdapter = viewportAdapter;\n        this._element = element;\n\n        this._active = false;\n        this._x = 0;\n        this._y = 0;\n\n        this._inputpos = { x: 0, y: 0 };\n    }\n\n    get x() { return this._x; }\n    get y() { return this._y; }\n\n    setPosition(x, y)\n    {\n        this._x = x;\n        this._y = y;\n        return this;\n    }\n\n    beginInput()\n    {\n        this._active = true;\n        this._inputpos.x = this._x;\n        this._inputpos.y = this._y;\n    }\n\n    /**\n     * Returns the position which the input began at. This is mutable.\n     */\n    getInputEventPosition() { return this._inputpos; }\n\n    changeInputEventPosition(x, y)\n    {\n        this._inputpos.x = x;\n        this._inputpos.y = y;\n    }\n\n    endInput() { this._active = false; }\n    isActive() { return this._active; }\n\n    getDistanceSquToInitial()\n    {\n        const pos = this._inputpos;\n        const dx = pos.x - this._x;\n        const dy = pos.y - this._y;\n        return dx * dx + dy * dy;\n    }\n\n    /**\n     * The DOM element for which this pointer provides context for; this should be\n     * the same element as in the input adapter.\n     */\n    getElement() { return this._element; }\n\n    /**\n     * The viewport for this pointer operates within; this should be the same\n     * viewport as in the input adapter.\n     */\n    getViewportAdapter() { return this._viewportAdapter; }\n\n    /**\n     * The input adapter that controls this pointer's properties\n     */\n    getInputAdapter() { return this._inputAdapter; }\n}\n\nexport default InputPointer;\n","import InputContext from './InputContext.js';\nimport InputPointer from './InputPointer.js';\n\nconst LONG_TAP_TICKS = 600;\nconst DOUBLE_TAP_TICKS = 600;\nconst SCROLL_SENSITIVITY = 1.0 / 300.0;\nconst CURSOR_RADIUS = 4;\nconst CURSOR_RADIUS_SQU = CURSOR_RADIUS * CURSOR_RADIUS;\nconst DRAGGING_BUFFER = 18;\nconst DRAGGING_BUFFER_SQU = DRAGGING_BUFFER * DRAGGING_BUFFER;\n\n/**\n * Provides an interface for input handlers to interact with a HTMLElement.\n * Each listenable element should correspond to only a single InputAdapter.\n */\nclass InputAdapter extends InputContext\n{\n    constructor(viewportAdapter)\n    {\n        super();\n        \n        this._viewportAdapter = viewportAdapter;\n\n        this._contexts = [];\n        this._activeDragHandler = null;\n\n        this._element = null;\n        this._cursor = {\n            _mousemove: null,\n            _mouseup: null,\n            _touchmove: null,\n            _touchend: null,\n            _timer: null\n        };\n        this._pointer = null;\n\n        //Although dragging could be in pointer, it should be here to allow\n        //the adapter to be independent of pointer.\n        this._dragging = false;\n        this._altinput = false;\n\n        this._holdInputDelay = LONG_TAP_TICKS;\n        this._dblInputDelay = DOUBLE_TAP_TICKS;\n        this._scrollSensitivity = SCROLL_SENSITIVITY;\n        this._minTapRadius = CURSOR_RADIUS_SQU * 16;\n        this._draggingRadiusSqu = CURSOR_RADIUS_SQU + DRAGGING_BUFFER_SQU;\n\n        this._prevEmptyInput = false;\n        this._prevEmptyTime = 0;\n        this._prevEmptyX = 0;\n        this._prevEmptyY = 0;\n\n        this.onContextMenu = this.onContextMenu.bind(this);\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onMouseMove = this.onMouseMove.bind(this);\n        this.onTouchStart = this.onTouchStart.bind(this);\n        this.onWheel = this.onWheel.bind(this);\n\n        this.onMouseDownThenMove = this.onMouseDownThenMove.bind(this);\n        this.onMouseDownThenUp = this.onMouseDownThenUp.bind(this);\n        this.onTouchStartThenMove = this.onTouchStartThenMove.bind(this);\n        this.onTouchStartThenEnd = this.onTouchStartThenEnd.bind(this);\n\n        this.onDelayedInputDown = this.onDelayedInputDown.bind(this);\n    }\n\n    bindContext(context)\n    {\n        if (!(context instanceof InputContext))\n            throw new Error('Cannot bind invalid context - must be an instance of InputContext');\n\n        this._contexts.unshift(context);\n        return this;\n    }\n\n    bindContextAsLast(context)\n    {\n        if (!(context instanceof InputContext))\n            throw new Error('Cannot bind invalid context - must be an instance of InputContext');\n\n        this._contexts.push(context);\n        return this;\n    }\n\n    unbindContext(context = null)\n    {\n        if (context)\n        {\n            const index = this._contexts.indexOf(context);\n            if (index >= 0)\n            {\n                this._contexts.splice(index, 1);\n                return context;\n            }\n            else\n            {\n                return null;\n            }\n        }\n        else\n        {\n            return this._contexts.shift();\n        }\n    }\n\n    clearContexts()\n    {\n        this._contexts.length = 0;\n    }\n\n    hasContexts()\n    {\n        return this._contexts.length > 0;\n    }\n\n    getCurrentContext()\n    {\n        if (this._contexts.length > 0)\n        {\n            return this._contexts[this._contexts.length - 1];\n        }\n        else\n        {\n            return this;\n        }\n    }\n\n    initialize(element)\n    {\n        if (!(element instanceof SVGElement)) throw new Error('Missing SVG element for input adapter\\'s viewport');\n        if (this._element) throw new Error('Trying to initialize an InputAdapter already initialized');\n\n        this._viewportAdapter.setElement(this._element = element);\n        this._pointer = new InputPointer(this, this._viewportAdapter, this._element);\n\n        this._element.addEventListener('mousedown', this.onMouseDown);\n        this._element.addEventListener('mousemove', this.onMouseMove);\n        this._element.addEventListener('touchstart', this.onTouchStart);\n        this._element.addEventListener('touchmove', this.onTouchMove);\n        this._element.addEventListener('contextmenu', this.onContextMenu);\n        this._element.addEventListener('wheel', this.onWheel);\n    }\n\n    destroy()\n    {\n        if (!this._element) throw new Error('Trying to destroy an InputAdapter that is not yet initialized');\n\n        this._element.removeEventListener('mousedown', this.onMouseDown);\n        this._element.removeEventListener('mousemove', this.onMouseMove);\n        this._element.removeEventListener('touchstart', this.onTouchStart);\n        this._element.removeEventListener('contextmenu', this.onContextMenu);\n        this._element.removeEventListener('wheel', this.onWheel);\n\n        this._element = null;\n    }\n\n    update()\n    {\n        if (this._element)\n        {\n            //Smooth transition offset\n            this._viewportAdapter.update();\n        }\n    }\n\n    /** @override */\n    handleEvent(eventName, ...eventArgs)\n    {\n        for (const context of this._contexts)\n        {\n            const result = context.handleEvent(eventName, ...eventArgs);\n            if (result)\n            {\n                return result;\n            }\n        }\n\n        return super.handleEvent(eventName, ...eventArgs);\n    }\n\n    onMouseDown(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        const cursor = this._cursor;\n\n        //Blur any element in focus\n        document.activeElement.blur();\n        this._element.focus();\n\n        //Make sure mouse move is deleted, just in case\n        if (cursor._mousemove)\n        {\n            document.removeEventListener('mousemove', cursor._mousemove);\n            cursor._mousemove = null;\n        }\n        //Make sure mouse up is deleted, just in case\n        if (cursor._mouseup)\n        {\n            document.removeEventListener('mouseup', cursor._mouseup);\n            cursor._mouseup = null;\n        }\n\n        //HACK: To allow Mac's to use ctrl+click as right clicks\n        const button = e.ctrlKey ? 2 : e.button;\n\n        //Is this a valid mouse down?\n        if (this.onInputDown(e.clientX, e.clientY, button))\n        {\n            //Start mouse down logic...\n            cursor._mousemove = this.onMouseDownThenMove;\n            cursor._mouseup = this.onMouseDownThenUp;\n\n            document.addEventListener('mousemove', cursor._mousemove);\n            document.addEventListener('mouseup', cursor._mouseup);\n        }\n\n        return false;\n    }\n\n    onMouseMove(e)\n    {\n        const mouse = this._viewportAdapter.transformScreenToView(e.clientX, e.clientY);\n        const pointer = this._pointer;\n        pointer.setPosition(mouse.x, mouse.y);\n\n        if (this.handleEvent('onMoveInputEvent', pointer))\n        {\n            e.stopPropagation();\n            e.preventDefault();\n\n            this.cancelInputEvent();\n        }\n    }\n\n    onMouseDownThenMove(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        this.onInputMove(e.clientX, e.clientY);\n\n        return false;\n    }\n\n    onMouseDownThenUp(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        const cursor = this._cursor;\n\n        //Make sure mouse move is deleted, just in case\n        if (cursor._mousemove)\n        {\n            document.removeEventListener('mousemove', cursor._mousemove);\n            cursor._mousemove = null;\n        }\n        //Make sure mouse up is deleted, just in case\n        if (cursor._mouseup)\n        {\n            document.removeEventListener('mouseup', cursor._mouseup);\n            cursor._mouseup = null;\n        }\n\n        this.onInputUp(e.clientX, e.clientY);\n\n        return false;\n    }\n\n    onTouchStart(e)\n    {\n        if (e.changedTouches.length == 1)\n        {\n            e.stopPropagation();\n            e.preventDefault();\n\n            const cursor = this._cursor;\n\n            //Blur any element in focus\n            document.activeElement.blur();\n            this._element.focus();\n\n            //Make sure touch move is deleted, just in case\n            if (cursor._touchmove)\n            {\n                document.removeEventListener('touchmove', cursor._touchmove);\n                cursor._touchmove = null;\n            }\n            //Make sure touch end is deleted, just in case\n            if (cursor._touchend)\n            {\n                document.removeEventListener('touchend', cursor._touchend);\n                cursor._touchend = null;\n            }\n\n            const touch = e.changedTouches[0];\n            //Is this a valid touch start?\n            if (this.onInputDown(touch.clientX, touch.clientY, 0))\n            {\n                //Start touch start logic...\n                cursor._touchmove = this.onTouchStartThenMove;\n                cursor._touchend = this.onTouchStartThenEnd;\n\n                document.addEventListener('touchmove', cursor._touchmove);\n                document.addEventListener('touchend', cursor._touchend);\n            }\n\n            return false;\n        }\n    }\n\n    onTouchStartThenEnd(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        const cursor = this._cursor;\n\n        //Make sure mouse move is deleted, just in case\n        if (cursor._touchmove)\n        {\n            document.removeEventListener('touchmove', cursor._touchmove);\n            cursor._touchmove = null;\n        }\n        //Make sure mouse up is deleted, just in case\n        if (cursor._touchend)\n        {\n            document.removeEventListener('touchend', cursor._touchend);\n            cursor._touchend = null;\n        }\n\n        const touch = e.changedTouches[0];\n        this.onInputUp(touch.clientX, touch.clientY);\n\n        return false;\n    }\n\n    onTouchStartThenMove(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        const touch = e.changedTouches[0];\n        this.onInputMove(touch.clientX, touch.clientY);\n\n        return false;\n    }\n\n    onContextMenu(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        return false;\n    }\n\n    onWheel(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        const pointer = this._pointer;\n        const dy = e.deltaY * this._scrollSensitivity;\n        const prev = this._viewportAdapter.getScale();\n        const next = prev + dy;\n\n        //Let others handle this event...\n        if (!this.handleEvent('onZoomChange', pointer, next, prev))\n        {\n            this._viewportAdapter.setScale(next);\n        }\n\n        return false;\n    }\n\n    onInputDown(x, y, button)\n    {\n        //Setup for hold timer...\n        const cursor = this._cursor;\n        const pointer = this._pointer;\n        const mouse = this._viewportAdapter.transformScreenToView(x, y);\n        pointer.setPosition(mouse.x, mouse.y);\n\n        this._dragging = false;\n        this._altinput = button == 2;\n\n        //Let others handle this event...\n        if (!this.handleEvent('onPreInputEvent', pointer))\n        {\n            pointer.beginInput();\n            cursor._timer = setTimeout(this.onDelayedInputDown, this._holdInputDelay);\n            return true;\n        }\n\n        return false;\n    }\n\n    onDelayedInputDown()\n    {\n        //That means the input is remaining still (like a hold)...\n        if (!this._dragging)\n        {\n            this._altinput = true;\n        }\n    }\n\n    onInputMove(x, y)\n    {\n        const pointer = this._pointer;\n        const mouse = this._viewportAdapter.transformScreenToView(x, y);\n        pointer.setPosition(mouse.x, mouse.y);\n\n        if (!this._dragging)\n        {\n            if (pointer.getDistanceSquToInitial() > this._draggingRadiusSqu)\n            {\n                this._dragging = true;\n\n                //Let others handle this event...\n                const inputEventPosition = pointer.getInputEventPosition();\n                const result = this.handleEvent('onDragStart', pointer, inputEventPosition.x, inputEventPosition.y);\n                if (!result)\n                {\n                    this._dragging = false;\n\n                    //TODO: you could NOT cancel the event and just update the target?\n                    //If so, who is the initial target then?\n\n                    //Stop the input event early...\n                    this.cancelInputEvent();\n                }\n                else\n                {\n                    this._activeDragHandler = result;\n                }\n            }\n            else\n            {\n                //Still a click or hold...\n            }\n        }\n        else\n        {\n            //Continue to drag...\n            if (this._activeDragHandler)\n            {\n                this._activeDragHandler.onDragMove(pointer);\n            }\n        }\n    }\n\n    onInputUp(x, y)\n    {\n        const cursor = this._cursor;\n        const timer = cursor._timer;\n        if (timer)\n        {\n            clearTimeout(timer);\n            cursor._timer = null;\n        }\n\n        //Update pointer target to final position\n        const pointer = this._pointer;\n        const mouse = this._viewportAdapter.transformScreenToView(x, y);\n        pointer.setPosition(mouse.x, mouse.y);\n\n        if (this._dragging)\n        {\n            //Stop dragging!\n            if (this._activeDragHandler)\n            {\n                this._activeDragHandler.onDragStop(pointer);\n                this._activeDragHandler = null;\n            }\n        }\n        else\n        {\n            if (this._altinput)\n            {\n                //Alt Tap!\n                this.handleEvent('onAltInputEvent', pointer);\n            }\n            else\n            {\n                //If the input was not consumed...\n                if (!this.handleEvent('onInputEvent', pointer))\n                {\n                    //Try for double tap...\n                    const dx = x - this._prevEmptyX;\n                    const dy = y - this._prevEmptyY;\n                    const dist = dx * dx + dy * dy;\n                    const dt = Date.now() - this._prevEmptyTime;\n                    if (this._prevEmptyInput &&\n                        dist < this._minTapRadius &&\n                        dt < this._dblInputDelay)\n                    {\n                        //Double tap!\n                        this.handleEvent('onDblInputEvent', pointer);\n\n                        this._prevEmptyInput = false;\n                    }\n                    else\n                    {\n                        this._prevEmptyInput = true;\n                        this._prevEmptyTime = Date.now();\n                        this._prevEmptyX = x;\n                        this._prevEmptyY = y;\n                    }\n                }\n            }\n        }\n\n        pointer.endInput();\n        this.handleEvent('onPostInputEvent', pointer);\n    }\n\n    cancelInputEvent()\n    {\n        const pointer = this._pointer;\n        const cursor = this._cursor;\n\n        //Make sure mouse move is deleted, just in case\n        if (cursor._mousemove)\n        {\n            document.removeEventListener('mousemove', cursor._mousemove);\n            cursor._mousemove = null;\n        }\n        //Make sure mouse up is deleted, just in case\n        if (cursor._mouseup)\n        {\n            document.removeEventListener('mouseup', cursor._mouseup);\n            cursor._mouseup = null;\n        }\n\n        const timer = cursor._timer;\n        if (timer)\n        {\n            clearTimeout(timer);\n            cursor._timer = null;\n        }\n\n        pointer.endInput();\n        this.handleEvent('onPostInputEvent', pointer);\n    }\n\n    getContexts() { return this._contexts; }\n    getActiveElement() { return this._element; }\n    getViewportAdapter() { return this._viewportAdapter; }\n    getPointerX() { return this._pointer ? this._pointer.x : 0; }\n    getPointerY() { return this._pointer ? this._pointer.y : 0; }\n    isPointerActive() { return this._pointer ? this._pointer.isActive() : false; }\n    isUsingTouch() { return this._cursor._touchmove || this._cursor._touchend; }\n    isAltInput() { return this._altinput; }\n    isDragging() { return this._dragging; }\n}\n\nexport default InputAdapter;","import React from 'react';\nimport Style from './ViewportComponent.css';\n\nimport ViewportAdapter from '../ViewportAdapter.js';\nimport InputAdapter from '../InputAdapter.js';\nimport AbstractInputHandler from '../AbstractInputHandler.js';\n\nconst DEFAULT_VIEW_SIZE = 300;\nconst SMOOTH_OFFSET_DAMPING = 0.4;\nconst MIN_SCALE = 0.1;\nconst MAX_SCALE = 10;\n\nclass ViewportComponent extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._ref = React.createRef();\n\n        this._viewportAdapter = new ViewportAdapter()\n            .setMinScale(MIN_SCALE)\n            .setMaxScale(MAX_SCALE)\n            .setOffsetDamping(SMOOTH_OFFSET_DAMPING);\n        this._inputAdapter = new InputAdapter(this._viewportAdapter);\n    }\n\n    addInputHandler(inputHandler)\n    {\n        if (!(inputHandler instanceof AbstractInputHandler)) throw new Error('input handler must be an instanceof AbstractInputHandler');\n        this._inputAdapter.addInputHandler(inputHandler);\n        return this;\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        this._inputAdapter.initialize(this._ref.current);\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        this._inputAdapter.destroy();\n    }\n\n    /** @override */\n    componentDidUpdate()\n    {\n        this._inputAdapter.update();\n    }\n\n    getSVGTransformString()\n    {\n        const viewport = this._viewportAdapter;\n        return 'translate(' + viewport.getOffsetX() + ' ' + viewport.getOffsetY() + ')';\n    }\n\n    getSVGViewBoxString(baseViewSize)\n    {\n        const viewport = this._viewportAdapter;\n        const viewSize = baseViewSize * Math.max(Number.MIN_VALUE, viewport.getScale());\n        const halfViewSize = viewSize / 2;\n        return (-halfViewSize) + ' ' + (-halfViewSize) + ' ' + viewSize + ' ' + viewSize;\n    }\n\n    getSVGElement()\n    {\n        return this._ref.current;\n    }\n\n    getInputAdapter()\n    {\n        return this._inputAdapter;\n    }\n\n    getViewportAdapter()\n    {\n        return this._inputAdapter.getViewportAdapter();\n    }\n\n    /** @override */\n    render()\n    {\n        const viewBox = this.getSVGViewBoxString(this.props.viewSize || DEFAULT_VIEW_SIZE);\n        const transform = this.getSVGTransformString();\n\n        return (\n            <svg ref={this._ref}\n                id={this.props.id}\n                className={Style.viewport_component + ' ' + this.props.className}\n                style={this.props.style}\n                viewBox={viewBox}>\n                <g transform={transform}>\n                    {this.props.children}\n                </g>\n            </svg>\n        );\n    }\n}\n\nexport default ViewportComponent;","import GraphNode from 'graph2/element/GraphNode.js';\n\nconst DEFAULT_MOVE_MODE_FIRST = true;\n\nclass InputController\n{\n    constructor()\n    {\n        this._trashMode = false;\n        this._nodeOnly = false;\n        this._moveModeFirst = DEFAULT_MOVE_MODE_FIRST;\n        this._handlingInput = false;\n\n        /*\n            This is the current target for the event. If this is a multi-stage event,\n            such as dragging, then this will only refer to the first target, the source\n            of the event.\n        */\n        this._target = {\n            source: null,\n            type: null\n        };\n\n        /*\n            This is the active target. It can only be manually set by binding source and\n            type through bindActiveTarget(). This allows future input handling to ignore\n            this target for intersection tests, etc.\n\n            NOTE: You must bind AND unbind the active target.\n        */\n        this._activeTarget = {\n            source: null,\n            type: null,\n            input: true\n        };\n\n        /*\n            This is the immediate target under the cursor. Regardless of input event, this\n            will always refer to the element directly intersecting the cursor. The active target\n            with the proper options may be ignored as possible candidates.\n        */\n        this._immediateTarget = {\n            source: null,\n            type: null\n        };\n\n        // This is only used if set.\n        this._selectionBox = null;\n\n        // Although not used here, it is used to connect to components.\n        this.onMouseOver = this.onMouseOver.bind(this);\n        this.onMouseOut = this.onMouseOut.bind(this);\n    }\n\n    setSelectionBox(selectionBox)\n    {\n        this._selectionBox = selectionBox;\n        return this;\n    }\n\n    setTrashMode(flag)\n    {\n        this._trashMode = flag;\n        return this;\n    }\n\n    setNodeEventsOnly(flag)\n    {\n        this._nodeOnly = flag;\n        return this;\n    }\n\n    setMoveModeFirst(flag)\n    {\n        this._moveModeFirst = flag;\n        return this;\n    }\n\n    /** @override */\n    onPreInputEvent(pointer)\n    {\n        this._handlingInput = true;\n\n        this.updateCurrentTarget(this._immediateTarget.source, this._immediateTarget.type);\n        return false;\n    }\n\n    /** @override */\n    onPostInputEvent(pointer)\n    {\n        this.updateCurrentTarget(null, null);\n        this._handlingInput = false;\n    }\n\n    onMouseOver(e)\n    {\n        const target = e.target;\n        const value = target['value'];\n        this._immediateTarget.source = value.source;\n        this._immediateTarget.type = value.type;\n\t\t\n        // Although you can access this, it cannot be a property for \"active\" targets.\n        // This is because those properties are used for comparison and equality. The\n        // extra data could be used for that, but it's up to you to manage that.\n        this._immediateTarget.data = value;\n    }\n\n    onMouseOut(e)\n    {\n        this._immediateTarget.source = null;\n        this._immediateTarget.type = null;\n\n        this._immediateTarget.data = null;\n    }\n\n    bindActiveTarget(targetSource, targetType, pointerEvent = true)\n    {\n        this._activeTarget.source = targetSource;\n        this._activeTarget.type = targetType;\n        this._activeTarget.input = pointerEvent;\n    }\n\n    unbindActiveTarget()\n    {\n        this._activeTarget.source = null;\n        this._activeTarget.type = null;\n        this._activeTarget.input = false;\n    }\n\n    updateCurrentTarget(targetSource, targetType)\n    {\n        this._target.source = targetSource;\n        this._target.type = targetType;\n    }\n\n    getActiveTargetSource() { return this._activeTarget.source; }\n    getActiveTargetType() { return this._activeTarget.type; }\n    hasActiveTarget() { return this._activeTarget.type !== null; }\n\n    hasPointerEvents(targetSource)\n    {\n        if (this._activeTarget.source === targetSource) return this._activeTarget.input;\n        if (this._nodeOnly) return targetSource instanceof GraphNode;\n        return true;\n    }\n\n    getCurrentTargetSource() { return this._target.source; }\n    getCurrentTargetType() { return this._target.type; }\n    hasCurrentTarget() { return this._target.type !== null; }\n\n    getImmediateTargetSource() { return this._immediateTarget.source; }\n    getImmediateTargetType() { return this._immediateTarget.type; }\n    hasImmediateTarget() { return this._immediateTarget.type !== null; }\n\n    isTrashMode() { return this._trashMode; }\n    isMoveMode(inputAdapter) { return !(this._moveModeFirst ^ !inputAdapter.isAltInput()); }\n    isNodeEventsOnly() { return this._nodeOnly; }\n    isMoveModeFirst() { return this._moveModeFirst; }\n\n    isHandlingInput() { return this._handlingInput; }\n\n    getSelectionBox() { return this._selectionBox; }\n}\n\nexport default InputController;","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\n\nclass ViewportInputHandler extends AbstractInputHandler\n{\n    constructor(inputController)\n    {\n        super();\n\n        this._inputController = inputController;\n\n        this._cachedPosition = {x: 0, y: 0};\n    }\n\n    /** @override */\n    onDragStart(pointer)\n    {\n        const inputController = this._inputController;\n        if (inputController.hasActiveTarget()) return false;\n        if (inputController.hasCurrentTarget()) return false;\n        if (!inputController.isMoveMode(pointer.getInputAdapter())) return false;\n\n        const inputEventPosition = pointer.getInputEventPosition();\n        this._cachedPosition.x = inputEventPosition.x;\n        this._cachedPosition.y = inputEventPosition.y;\n        return true;\n    }\n  \n    /** @override */\n    onDragMove(pointer)\n    {\n        const dx = pointer.x - this._cachedPosition.x;\n        const dy = pointer.y - this._cachedPosition.y;\n\n        const viewport = pointer.getViewportAdapter();\n        viewport.addOffset(dx, dy, true);\n\n        /*\n\t\t// We don't want to update it due to how viewports are positioned.\n\t\tthis._cachedPosition.x = pointer.x;\n\t\tthis._cachedPosition.y = pointer.y;\n\t\t*/\n    }\n  \n    /** @override */\n    onDragStop(pointer)\n    {\n        // Do nothing.\n    }\n}\n\nexport default ViewportInputHandler;","import React from 'react';\n\nimport ViewportComponent from 'util/input/components/ViewportComponent.js';\n\nimport InputController from 'graph2/controller/InputController.js';\nimport InputContext from 'util/input/InputContext.js';\n\nimport ViewportInputHandler from 'graph2/inputhandler/ViewportInputHandler.js';\n\nclass GraphView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._inputController = new InputController();\n        this._inputContext = new InputContext();\n\n        this._viewportComponent = React.createRef();\n\n        this._viewportInputHandler = new ViewportInputHandler(this._inputController);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const inputContext = this._inputContext;\n        const viewport = this._viewportComponent.current;\n        const inputAdapter = viewport.getInputAdapter();\n        inputContext\n            .addInputHandler(this._inputController)\n            .addInputHandler(this._viewportInputHandler, 10);\n        inputAdapter.bindContext(inputContext);\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        const inputContext = this._inputContext;\n        const viewport = this._viewportComponent.current;\n        const inputAdapter = viewport.getInputAdapter();\n        inputContext.clearInputHandlers();\n        inputAdapter.unbindContext(inputContext);\n    }\n\n    moveViewToPosition(x, y)\n    {\n        // Center view at position; inverted due to graph-to-screen space\n        this.getViewportAdapter().setOffset(-x, -y);\n    }\n\n    getInputController() { return this._inputController; }\n    getInputContext() { return this._inputContext; }\n\n    getViewportComponent() { return this._viewportComponent.current; }\n    getInputAdapter() { return this._viewportComponent.current.getInputAdapter(); }\n    getViewportAdapter() { return this._viewportComponent.current.getViewportAdapter(); }\n\n    /** @override */\n    render()\n    {\n        const inputController = this._inputController;\n        const viewport = this._viewportComponent.current;\n        const renderGraph = this.props.renderGraph;\n        const renderOverlay = this.props.renderOverlay;\n\n        return (\n            <div id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}>\n                <ViewportComponent ref={this._viewportComponent}>\n                    {renderGraph && viewport && renderGraph(this, viewport, inputController)}\n                </ViewportComponent>\n                {renderOverlay && viewport && renderOverlay(this, viewport, inputController)}\n            </div>\n        );\n    }\n}\n\nexport default GraphView;\n","import React from 'react';\n\nclass TrashCanDetailedIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 26 26\">\n                <path d=\"M 11.5 -0.03125 C 9.542969 -0.03125 7.96875 1.59375 7.96875 3.5625 L 7.96875 4 L 4 4 C 3.449219 4 3 4.449219 3 5 L 3 6 L 2 6 L 2 8 L 4 8 L 4 23 C 4 24.644531 5.355469 26 7 26 L 19 26 C 20.644531 26 22 24.644531 22 23 L 22 8 L 24 8 L 24 6 L 23 6 L 23 5 C 23 4.449219 22.550781 4 22 4 L 18.03125 4 L 18.03125 3.5625 C 18.03125 1.59375 16.457031 -0.03125 14.5 -0.03125 Z M 11.5 2.03125 L 14.5 2.03125 C 15.304688 2.03125 15.96875 2.6875 15.96875 3.5625 L 15.96875 4 L 10.03125 4 L 10.03125 3.5625 C 10.03125 2.6875 10.695313 2.03125 11.5 2.03125 Z M 6 8 L 11.125 8 C 11.25 8.011719 11.371094 8.03125 11.5 8.03125 L 14.5 8.03125 C 14.628906 8.03125 14.75 8.011719 14.875 8 L 20 8 L 20 23 C 20 23.5625 19.5625 24 19 24 L 7 24 C 6.4375 24 6 23.5625 6 23 Z M 8 10 L 8 22 L 10 22 L 10 10 Z M 12 10 L 12 22 L 14 22 L 14 10 Z M 16 10 L 16 22 L 18 22 L 18 10 Z \"/>\n            </svg>\n        );\n    }\n}\nexport default TrashCanDetailedIcon;\n","import React from 'react';\nimport Style from './TrashCanWidget.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport TrashCanDetailedIcon from 'components/iconset/TrashCanDetailedIcon.js';\n\nconst DOUBLE_TAP_TIME = 250;\n\nclass TrashCanWidget extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._ref = React.createRef();\n        this._buttonElement = React.createRef();\n\n        this.state = {\n            active: false,\n            forceActive: false\n        };\n\n        this._doubleTapTimeout = null;\n\n        this.onMouseEnter = this.onMouseEnter.bind(this);\n        this.onMouseLeave = this.onMouseLeave.bind(this);\n        this.onClick = this.onClick.bind(this);\n\n        // This is kinda a hack to lose trash mode focus...\n        this.onAnyMouseDownNotConsumed = this.onAnyMouseDownNotConsumed.bind(this);\n    }\n\n    onMouseEnter(e)\n    {\n        if (this.state.forceActive) return;\n\n        this.setState({ active: true }, () =>\n        {\n            const onChange = this.props.onChange;\n            if (onChange) onChange(true);\n        });\n    }\n\n    onMouseLeave(e)\n    {\n        if (this.state.forceActive) return;\n\n        this.setState({ active: false }, () =>\n        {\n            const onChange = this.props.onChange;\n            if (onChange) onChange(false);\n        });\n    }\n\n    onClick(e)\n    {\n        e.stopPropagation();\n        e.preventDefault();\n\n        if (this._doubleTapTimeout)\n        {\n            // This is a double tap!\n            clearTimeout(this._doubleTapTimeout);\n            this._doubleTapTimeout = null;\n\n            this.setState({ active: false, forceActive: false }, () =>\n            {\n                const onClear = this.props.onClear;\n                if (onClear) onClear();\n                const onChange = this.props.onChange;\n                if (onChange) onChange(false);\n            });\n        }\n        else\n        {\n            // This is a single tap!\n            this.setState((prev, props) =>\n            {\n                const result = !prev.forceActive;\n\n                this._doubleTapTimeout = setTimeout(() =>\n                {\n                    this._doubleTapTimeout = null;\n                }, DOUBLE_TAP_TIME);\n\n                if (result)\n                {\n                    document.documentElement.addEventListener('mousedown', this.onAnyMouseDownNotConsumed);\n                }\n\n                return {\n                    active: result,\n                    forceActive: result\n                };\n            }, () =>\n            {\n                const onChange = this.props.onChange;\n                if (onChange) onChange(this.state.active);\n            });\n        }\n    }\n\n    onAnyMouseDownNotConsumed(e)\n    {\n        if (this.state.forceActive && this._buttonElement.current !== e.target)\n        {\n            e.stopPropagation();\n            e.preventDefault();\n\n            document.documentElement.removeEventListener('mousedown', this.onAnyMouseDownNotConsumed);\n            \n            this.setState({ active: false, forceActive: false }, () =>\n            {\n                const onChange = this.props.onChange;\n                if (onChange) onChange(false);\n            });\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const visible = this.props.visible;\n        const active = this.state.active;\n        const hide = !active && !visible;\n\n        return (\n            <IconButton ref={this._ref}\n                refButton={this._buttonElement}\n                id={this.props.id}\n                className={Style.trash_container +\n                    (active ? ' active ' : '') +\n                    (hide ? ' hide ' : '') +\n                    ' ' + this.props.className}\n                style={this.props.style}\n                title={'Delete'}\n                onMouseEnter={this.onMouseEnter}\n                onMouseLeave={this.onMouseLeave}\n                onClick={this.onClick}>\n                <TrashCanDetailedIcon />\n            </IconButton>\n        );\n    }\n}\n\nexport default TrashCanWidget;\n","import React from 'react';\n\nclass MoveIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M13,6V11H18V7.75L22.25,12L18,16.25V13H13V18H16.25L12,22.25L7.75,18H11V13H6V16.25L1.75,12L6,7.75V11H11V6H7.75L12,1.75L16.25,6H13Z\"/>\n            </svg>\n        );\n    }\n}\nexport default MoveIcon;\n","import React from 'react';\nimport Style from './ModeTrayWidget.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport EditPencilIcon from 'components/iconset/EditPencilIcon.js';\nimport MoveIcon from 'components/iconset/MoveIcon.js';\n\nexport const MODE_ACTION = 0;\nexport const MODE_MOVE = 1;\n\nclass ModeTrayWidget extends React.Component\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        const visible = this.props.visible;\n        const mode = this.props.mode;\n        const onChange = this.props.onChange;\n        const hide = !visible;\n\n        return (\n            <div id={this.props.id}\n                className={Style.tray_container +\n                    (hide ? ' hide ' : '') +\n                    ' ' + this.props.className}\n                style={this.props.style}>\n                <IconButton className={Style.tray_button +\n                    (mode === MODE_ACTION ? ' active ' : '')}\n                onClick={() => \n                {\n                    if (onChange) onChange(MODE_ACTION);\n                }}\n                title={I18N.toString('cursor.actionmode')}>\n                    <EditPencilIcon />\n                </IconButton>\n                <IconButton className={Style.tray_button +\n                    (mode === MODE_MOVE ? ' active ' : '')}\n                onClick={() => \n                {\n                    if (onChange) onChange(MODE_MOVE);\n                }}\n                title={I18N.toString('cursor.movemode')}>\n                    <MoveIcon />\n                </IconButton>\n            </div>\n        );\n    }\n}\nexport default ModeTrayWidget;\n","import React from 'react';\nimport Style from './ViewportEditLayer.css';\n\nimport TrashCanWidget from '../widgets/TrashCanWidget.js';\nimport ModeTrayWidget, { MODE_ACTION, MODE_MOVE } from '../widgets/ModeTrayWidget.js';\n\nclass ViewportEditLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onTrashChange = this.onTrashChange.bind(this);\n        this.onTrashClear = this.onTrashClear.bind(this);\n        this.onModeChange = this.onModeChange.bind(this);\n    }\n\n    onTrashChange(flag)\n    {\n        this.props.inputController.setTrashMode(flag);\n        if (flag)\n        {\n            this.props.session.getApp().getDrawerComponent().setViewportColor('var(--color-viewport-error)');\n        }\n        else\n        {\n            this.props.session.getApp().getDrawerComponent().setViewportColor(null);\n        }\n    }\n\n    onTrashClear()\n    {\n        this.props.graphController.clearGraph();\n    }\n\n    onModeChange(value)\n    {\n        this.props.inputController.setMoveModeFirst(value === MODE_MOVE);\n    }\n\n    /** @override */\n    render()\n    {\n        const inputController = this.props.inputController;\n        const graphController = this.props.graphController;\n        const viewport = this.props.viewport;\n        const graph = graphController.getGraph();\n\n        let moveMode = null;\n        if (inputController)\n        {\n            if (inputController.isHandlingInput())\n            {\n                moveMode = inputController.isMoveMode(viewport.getInputAdapter()) ? MODE_MOVE : MODE_ACTION;\n            }\n            else\n            {\n                moveMode = inputController.isMoveModeFirst() ? MODE_MOVE : MODE_ACTION;\n            }\n        }\n\n        return (\n            <div id={this.props.id}\n                className={Style.view_container +\n\t\t\t\t\t' ' + this.props.className}\n                style={this.props.style}>\n                <TrashCanWidget className={Style.view_widget}\n                    style={{ bottom: 0, right: 0 }}\n                    visible={!graph.isEmpty() && viewport &&\n\t\t\t\t\t\t(!viewport.getInputAdapter().isUsingTouch() || !viewport.getInputAdapter().isDragging())}\n                    onChange={this.onTrashChange}\n                    onClear={this.onTrashClear} />\n                <ModeTrayWidget className={Style.view_widget}\n                    style={{ bottom: 0, left: 0 }}\n                    visible={inputController}\n                    mode={moveMode}\n                    onChange={this.onModeChange} />\n                {this.props.children}\n            </div>\n        );\n    }\n}\n\nexport default ViewportEditLayer;","//https://www.flaticon.com/free-icon/png_136523\nimport React from 'react';\n\nclass PNGIcon extends React.Component\n{\n  constructor(props)\n  {\n    super(props);\n  }\n\n  render()\n  {\n    return <svg className=\"png-icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 56 56\">\n      <g>\n        <path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n        <path fill=\"#659C35\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n        <polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n        <g>\n          <path fill=\"#FFFFFF\" d=\"M17.385,53h-1.641V42.924h2.898c0.428,0,0.852,0.068,1.271,0.205 c0.419,0.137,0.795,0.342,1.128,0.615c0.333,0.273,0.602,0.604,0.807,0.991s0.308,0.822,0.308,1.306 c0,0.511-0.087,0.973-0.26,1.388c-0.173,0.415-0.415,0.764-0.725,1.046c-0.31,0.282-0.684,0.501-1.121,0.656 s-0.921,0.232-1.449,0.232h-1.217V53z M17.385,44.168v3.992h1.504c0.2,0,0.398-0.034,0.595-0.103 c0.196-0.068,0.376-0.18,0.54-0.335c0.164-0.155,0.296-0.371,0.396-0.649c0.1-0.278,0.15-0.622,0.15-1.032 c0-0.164-0.023-0.354-0.068-0.567c-0.046-0.214-0.139-0.419-0.28-0.615c-0.142-0.196-0.34-0.36-0.595-0.492 c-0.255-0.132-0.593-0.198-1.012-0.198H17.385z\"/>\n          <path fill=\"#FFFFFF\" d=\"M31.316,42.924V53h-1.668l-3.951-6.945V53h-1.668V42.924h1.668l3.951,6.945v-6.945H31.316z\"/>\n          <path fill=\"#FFFFFF\" d={\"M41.16,47.805v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417 \" +\n            \"S39.052,52.954,38.747,53c-0.306,0.046-0.608,0.068-0.909,0.068c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971 \" +\n            \"c-0.378-0.429-0.675-0.966-0.889-1.613c-0.214-0.647-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235 \" +\n            \"c0.214-0.643,0.51-1.178,0.889-1.606c0.378-0.429,0.822-0.754,1.333-0.978c0.51-0.224,1.062-0.335,1.654-0.335 \" +\n            \"c0.547,0,1.057,0.091,1.531,0.273c0.474,0.183,0.897,0.456,1.271,0.82l-1.135,1.012c-0.219-0.265-0.47-0.456-0.752-0.574 \" +\n            \"c-0.283-0.118-0.574-0.178-0.875-0.178c-0.337,0-0.659,0.063-0.964,0.191c-0.306,0.128-0.579,0.344-0.82,0.649 \" +\n            \"c-0.242,0.306-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777 \" +\n            \"c0.132,0.501,0.314,0.911,0.547,1.23s0.497,0.556,0.793,0.711c0.296,0.155,0.608,0.232,0.937,0.232c0.1,0,0.234-0.007,0.403-0.021 \" +\n            \"c0.168-0.014,0.337-0.036,0.506-0.068c0.168-0.032,0.33-0.075,0.485-0.13c0.155-0.055,0.269-0.132,0.342-0.232v-2.488h-1.709 v-1.121H41.16z\"}/>\n        </g>\n        <circle fill=\"#F3D55B\" cx=\"18.931\" cy=\"14.431\" r=\"4.569\"/>\n        <polygon fill=\"#88C057\" points=\"6.5,39 17.5,39 49.5,39 49.5,28 39.5,18.5 29,30 23.517,24.517 \t\"/>\n      </g>\n    </svg>;\n  }\n}\n\nexport default PNGIcon;\n","//https://www.flaticon.com/free-icon/jpg_136524\nimport React from 'react';\n\nclass JPGIcon extends React.Component\n{\n  constructor(props)\n  {\n    super(props);\n  }\n\n  render()\n  {\n    return <svg className=\"jpg-icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 56 56\">\n      <g>\n        <path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n        <polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n        <circle fill=\"#F3D55B\" cx=\"18.931\" cy=\"14.431\" r=\"4.569\"/>\n        <polygon fill=\"#26B99A\" points=\"6.5,39 17.5,39 49.5,39 49.5,28 39.5,18.5 29,30 23.517,24.517 \t\"/>\n        <path fill=\"#14A085\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n        <g>\n          <path fill=\"#FFFFFF\" d={\"M21.426,42.65v7.848c0,0.474-0.087,0.873-0.26,1.196c-0.173,0.323-0.406,0.583-0.697,0.779 \" +\n            \"c-0.292,0.196-0.627,0.333-1.005,0.41C19.085,52.961,18.696,53,18.295,53c-0.201,0-0.436-0.021-0.704-0.062 \" +\n            \"c-0.269-0.041-0.547-0.104-0.834-0.191s-0.563-0.185-0.827-0.294c-0.265-0.109-0.488-0.232-0.67-0.369l0.697-1.107 \" +\n            \"c0.091,0.063,0.221,0.13,0.39,0.198c0.168,0.068,0.353,0.132,0.554,0.191c0.2,0.06,0.41,0.111,0.629,0.157 \" +\n            \"s0.424,0.068,0.615,0.068c0.483,0,0.868-0.094,1.155-0.28s0.439-0.504,0.458-0.95V42.65H21.426z\"}/>\n          <path fill=\"#FFFFFF\" d={\"M25.514,52.932h-1.641V42.855h2.898c0.428,0,0.852,0.068,1.271,0.205 \" +\n            \"c0.419,0.137,0.795,0.342,1.128,0.615c0.333,0.273,0.602,0.604,0.807,0.991s0.308,0.822,0.308,1.306 \" +\n            \"c0,0.511-0.087,0.973-0.26,1.388c-0.173,0.415-0.415,0.764-0.725,1.046c-0.31,0.282-0.684,0.501-1.121,0.656 \" +\n            \"s-0.921,0.232-1.449,0.232h-1.217V52.932z M25.514,44.1v3.992h1.504c0.2,0,0.398-0.034,0.595-0.103 \" +\n            \"c0.196-0.068,0.376-0.18,0.54-0.335s0.296-0.371,0.396-0.649c0.1-0.278,0.15-0.622,0.15-1.032c0-0.164-0.023-0.354-0.068-0.567 \" +\n            \"c-0.046-0.214-0.139-0.419-0.28-0.615c-0.142-0.196-0.34-0.36-0.595-0.492C27.5,44.166,27.163,44.1,26.744,44.1H25.514z\"}/>\n          <path fill=\"#FFFFFF\" d={\"M39.5,47.736v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417 \" +\n            \"s-0.583,0.187-0.889,0.232C36.781,52.978,36.479,53,36.178,53c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971 \" +\n            \"c-0.378-0.429-0.675-0.966-0.889-1.613c-0.214-0.647-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235 \" +\n            \"c0.214-0.643,0.51-1.178,0.889-1.606c0.378-0.429,0.822-0.754,1.333-0.978c0.51-0.224,1.062-0.335,1.654-0.335 \" +\n            \"c0.547,0,1.057,0.091,1.531,0.273c0.474,0.183,0.897,0.456,1.271,0.82l-1.135,1.012c-0.219-0.265-0.47-0.456-0.752-0.574 \" +\n            \"c-0.283-0.118-0.574-0.178-0.875-0.178c-0.337,0-0.659,0.063-0.964,0.191c-0.306,0.128-0.579,0.344-0.82,0.649 \" +\n            \"c-0.242,0.306-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777 \" +\n            \"c0.132,0.501,0.314,0.911,0.547,1.23s0.497,0.556,0.793,0.711c0.296,0.155,0.608,0.232,0.937,0.232c0.1,0,0.234-0.007,0.403-0.021 \" +\n            \"c0.168-0.014,0.337-0.036,0.506-0.068c0.168-0.032,0.33-0.075,0.485-0.13c0.155-0.055,0.269-0.132,0.342-0.232v-2.488h-1.709 \" +\n            \"v-1.121H39.5z\"}/>\n        </g>\n      </g>\n    </svg>;\n  }\n}\n\nexport default JPGIcon;\n","import React from 'react';\n\nclass SVGIcon extends React.Component\n{\n  constructor(props)\n  {\n    super(props);\n  }\n\n  /** @override */\n  render()\n  {\n    return <svg className=\"svg-icon\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 56 56\">\n    \t<g>\n    \t\t<path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074\n    \t\tc0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n    \t\t<polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n    \t\t<path fill=\"#E57E25\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n    \t\t<g>\n    \t\t\t<path fill=\"#FFFFFF\"\n    \t\t\t\td=\"M21.459,50.238c0,0.364-0.075,0.718-0.226,1.06s-0.362,0.643-0.636,0.902s-0.61,0.467-1.012,0.622\n    \t\t\ts-0.856,0.232-1.367,0.232c-0.219,0-0.444-0.012-0.677-0.034s-0.467-0.062-0.704-0.116s-0.463-0.13-0.677-0.226\n    \t\t\ts-0.398-0.212-0.554-0.349l0.287-1.176c0.128,0.073,0.289,0.144,0.485,0.212s0.398,0.132,0.608,0.191s0.419,0.107,0.629,0.144\n    \t\t\ts0.405,0.055,0.588,0.055c0.556,0,0.982-0.13,1.278-0.39c0.296-0.26,0.444-0.645,0.444-1.155c0-0.31-0.104-0.574-0.314-0.793\n    \t\t\ts-0.472-0.417-0.786-0.595s-0.654-0.355-1.019-0.533s-0.706-0.388-1.025-0.629s-0.583-0.526-0.793-0.854s-0.314-0.738-0.314-1.23\n    \t\t\tc0-0.446,0.082-0.843,0.246-1.189s0.385-0.641,0.663-0.882s0.602-0.426,0.971-0.554s0.759-0.191,1.169-0.191\n    \t\t\tc0.419,0,0.843,0.039,1.271,0.116s0.774,0.203,1.039,0.376c-0.055,0.118-0.118,0.248-0.191,0.39s-0.142,0.273-0.205,0.396\n    \t\t\ts-0.118,0.226-0.164,0.308s-0.073,0.128-0.082,0.137c-0.055-0.027-0.116-0.063-0.185-0.109s-0.166-0.091-0.294-0.137\n    \t\t\ts-0.296-0.077-0.506-0.096s-0.479-0.014-0.807,0.014c-0.183,0.019-0.355,0.07-0.52,0.157s-0.31,0.193-0.438,0.321\n    \t\t\ts-0.228,0.271-0.301,0.431s-0.109,0.313-0.109,0.458c0,0.364,0.104,0.658,0.314,0.882s0.47,0.419,0.779,0.588\n    \t\t\ts0.647,0.333,1.012,0.492s0.704,0.354,1.019,0.581s0.576,0.513,0.786,0.854S21.459,49.7,21.459,50.238z\"/>\n    \t\t\t<path fill=\"#FFFFFF\" d=\"M25.861,53.055L22.73,42.924h1.873l2.338,8.695l2.475-8.695h1.859l-3.281,10.131H25.861z\"/>\n    \t\t\t<path fill=\"#FFFFFF\"\n    \t\t\t\td=\"M40.668,47.805v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417\n    \t\t\tS38.561,52.954,38.255,53s-0.608,0.068-0.909,0.068c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971\n    \t\t\ts-0.675-0.966-0.889-1.613s-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235s0.511-1.178,0.889-1.606s0.822-0.754,1.333-0.978\n    \t\t\ts1.062-0.335,1.654-0.335c0.547,0,1.058,0.091,1.531,0.273s0.897,0.456,1.271,0.82l-1.135,1.012\n    \t\t\tc-0.219-0.265-0.47-0.456-0.752-0.574s-0.574-0.178-0.875-0.178c-0.337,0-0.658,0.063-0.964,0.191s-0.579,0.344-0.82,0.649\n    \t\t\ts-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777s0.314,0.911,0.547,1.23\n    \t\t\ts0.497,0.556,0.793,0.711s0.608,0.232,0.937,0.232c0.101,0,0.234-0.007,0.403-0.021s0.337-0.036,0.506-0.068\n    \t\t\ts0.33-0.075,0.485-0.13s0.269-0.132,0.342-0.232v-2.488h-1.709v-1.121H40.668z\"/>\n    \t\t</g>\n    \t\t<path fill=\"#C8BDB8\"\n    \t\t\td=\"M45.5,22v-6h-6v2h-6v-4h-10v4h-6v-2h-6v6h6v-2h3.548c-4.566,2.636-7.548,7.588-7.548,13\n    \t\tc0,0.552,0.447,1,1,1s1-0.448,1-1c0-5.246,3.229-9.999,8-11.995V24h10v-2.995c4.771,1.997,8,6.75,8,11.995c0,0.552,0.447,1,1,1\n    \t\ts1-0.448,1-1c0-5.412-2.982-10.364-7.548-13H39.5v2H45.5z M15.5,20h-2v-2h2V20z M31.5,22h-6v-3.754V16h6v2.246V22z M41.5,18h2v2h-2\n    \t\tV18z\"/>\n    \t</g>\n    </svg>;\n  }\n}\n\nexport default SVGIcon;\n","import React from 'react';\n\nclass PNGFileIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 56 56\">\n                <path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n                <path fill=\"#659C35\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n                <polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n                <path fill=\"#FFFFFF\" d=\"M17.385,53h-1.641V42.924h2.898c0.428,0,0.852,0.068,1.271,0.205 c0.419,0.137,0.795,0.342,1.128,0.615c0.333,0.273,0.602,0.604,0.807,0.991s0.308,0.822,0.308,1.306 c0,0.511-0.087,0.973-0.26,1.388c-0.173,0.415-0.415,0.764-0.725,1.046c-0.31,0.282-0.684,0.501-1.121,0.656 s-0.921,0.232-1.449,0.232h-1.217V53z M17.385,44.168v3.992h1.504c0.2,0,0.398-0.034,0.595-0.103 c0.196-0.068,0.376-0.18,0.54-0.335c0.164-0.155,0.296-0.371,0.396-0.649c0.1-0.278,0.15-0.622,0.15-1.032 c0-0.164-0.023-0.354-0.068-0.567c-0.046-0.214-0.139-0.419-0.28-0.615c-0.142-0.196-0.34-0.36-0.595-0.492 c-0.255-0.132-0.593-0.198-1.012-0.198H17.385z\"/>\n                <path fill=\"#FFFFFF\" d=\"M31.316,42.924V53h-1.668l-3.951-6.945V53h-1.668V42.924h1.668l3.951,6.945v-6.945H31.316z\"/>\n                <path fill=\"#FFFFFF\" d={'M41.16,47.805v3.896c-0.21,0.265-0.444,0.48-0.704,0.649s-0.533,0.308-0.82,0.417 S39.052,52.954,38.747,53c-0.306,0.046-0.608,0.068-0.909,0.068c-0.602,0-1.155-0.109-1.661-0.328s-0.948-0.542-1.326-0.971 c-0.378-0.429-0.675-0.966-0.889-1.613c-0.214-0.647-0.321-1.395-0.321-2.242s0.107-1.593,0.321-2.235 c0.214-0.643,0.51-1.178,0.889-1.606c0.378-0.429,0.822-0.754,1.333-0.978c0.51-0.224,1.062-0.335,1.654-0.335 c0.547,0,1.057,0.091,1.531,0.273c0.474,0.183,0.897,0.456,1.271,0.82l-1.135,1.012c-0.219-0.265-0.47-0.456-0.752-0.574 c-0.283-0.118-0.574-0.178-0.875-0.178c-0.337,0-0.659,0.063-0.964,0.191c-0.306,0.128-0.579,0.344-0.82,0.649 c-0.242,0.306-0.431,0.699-0.567,1.183s-0.21,1.075-0.219,1.777c0.009,0.684,0.08,1.276,0.212,1.777 c0.132,0.501,0.314,0.911,0.547,1.23s0.497,0.556,0.793,0.711c0.296,0.155,0.608,0.232,0.937,0.232c0.1,0,0.234-0.007,0.403-0.021 c0.168-0.014,0.337-0.036,0.506-0.068c0.168-0.032,0.33-0.075,0.485-0.13c0.155-0.055,0.269-0.132,0.342-0.232v-2.488h-1.709 v-1.121H41.16z'}/>\n                <circle fill=\"#F3D55B\" cx=\"18.931\" cy=\"14.431\" r=\"4.569\"/>\n                <polygon fill=\"#88C057\" points=\"6.5,39 17.5,39 49.5,39 49.5,28 39.5,18.5 29,30 23.517,24.517 \t\"/>\n            </svg>\n        );\n    }\n}\nexport default PNGFileIcon;\n","import SessionExporter from 'session/SessionExporter.js';\n\nimport * as ColorHelper from 'util/ColorHelper.js';\n\nimport PNGIcon from 'deprecated/icons/flat/PNGIcon.js';\nimport JPGIcon from 'deprecated/icons/flat/JPGIcon.js';\nimport SVGIcon from 'deprecated/icons/flat/SVGIcon.js';\nimport BWIcon from 'components/iconset/flat/PNGFileIcon.js';\n\nexport const IMAGE_TYPE_PNG = 'png';\nexport const IMAGE_TYPE_JPG = 'jpg';\nexport const IMAGE_TYPE_SVG = 'svg';\nexport const IMAGE_TYPE_BW = 'bw';\n\nconst EXPORT_PADDING_X = 30;\nconst EXPORT_PADDING_Y = 0;\n\nclass NodalGraphImageExporter extends SessionExporter\n{\n    constructor(imageType = IMAGE_TYPE_PNG)\n    {\n        super();\n        this._imageType = imageType;\n    }\n\n    /** @override */\n    exportTarget(exportType, target)\n    {\n        const session = target;\n        const currentModule = session.getCurrentModule();\n        const fileName = session.getProjectName();\n        const workspace = session.getCurrentModule().getGraphView().getViewportComponent();\n        const svgElement = workspace.getSVGElement();\n        const workspaceDim = svgElement.viewBox.baseVal;\n        const width = workspaceDim.width;\n        const height = workspaceDim.height;\n        const svg = this.processSVGForExport(svgElement, width, height, currentModule);\n\n        const fileExt = this._imageType === IMAGE_TYPE_BW ? IMAGE_TYPE_PNG : this._imageType;\n        return Promise.resolve({\n            name: fileName + '.' + fileExt,\n            type: 'image',\n            data: svg,\n            width: width,\n            height: height,\n            'image-type': fileExt\n        });\n    }\n\n    processColorAttribute(themeManager, attributeValue)\n    {\n        if (!attributeValue) return attributeValue;\n\n        const startIndex = attributeValue.indexOf('var(--');\n        if (startIndex < 0) return attributeValue;\n\n        const stopIndex = attributeValue.indexOf(')', startIndex);\n        const value = attributeValue.substring(startIndex + 4, stopIndex);\n        const style = themeManager.getStyleByName(value);\n        let result = style ? style.getValue() : '#000000';\n\n        if (this._imageType === IMAGE_TYPE_BW)\n        {\n            const rgb = ColorHelper.HEXtoRGB(result);\n            ColorHelper.grayscaleRGB(rgb, rgb);\n            result = ColorHelper.RGBtoHEX(rgb);\n        }\n\n        return result;\n    }\n\n    processSVGForExport(element, width, height, currentModule)\n    {\n        const graphController = currentModule.getGraphController();\n\n        const viewport = currentModule.getGraphView().getViewportAdapter();\n        const offsetX = viewport.getOffsetX();\n        const offsetY = viewport.getOffsetY();\n        const bounds = graphController.getGraph().getBoundingRect();\n        const dx = bounds.minX + offsetX - EXPORT_PADDING_X;\n        const dy = bounds.minY + offsetY - EXPORT_PADDING_Y;\n        const w = bounds.width + EXPORT_PADDING_X * 2;\n        const h = bounds.height + EXPORT_PADDING_Y * 2;\n        const clone = element.cloneNode(true);\n        clone.setAttribute('viewBox', dx + ' ' + dy + ' ' + w + ' ' + h);\n        clone.setAttribute('width', width);\n        clone.setAttribute('height', height);\n\n        // Apply the workspace font (refer to Workspace.css)\n        clone.setAttribute('font-size', '16px');\n        clone.setAttribute('font-family', 'monospace');\n        clone.setAttribute('style', '.graph-ui {display: none;}');\n\n        // Go through and replace all colors...\n        const themeManager = currentModule.getApp().getThemeManager();\n        for (const element of clone.getElementsByTagName('*'))\n        {\n            const strokeValue = element.getAttribute('stroke');\n            const strokeResult = this.processColorAttribute(themeManager, strokeValue);\n            if (strokeValue !== strokeResult) element.setAttribute('stroke', strokeResult);\n\n            const fillValue = element.getAttribute('fill');\n            const fillResult = this.processColorAttribute(themeManager, fillValue);\n            if (fillValue !== fillResult) element.setAttribute('fill', fillResult);\n        }\n\n        //Remove unwanted ui elements from image\n        const uiElements = clone.getElementsByClassName('graph-ui');\n        while (uiElements.length > 0)\n        {\n            // This will propagate changes to uiElements, so be careful\n            const e = uiElements[0];\n            e.remove();\n        }\n\n        return clone;\n    }\n\n    /** @override */\n    getIconClass()\n    {\n        switch (this._imageType)\n        {\n        case IMAGE_TYPE_PNG: return PNGIcon;\n        case IMAGE_TYPE_JPG: return JPGIcon;\n        case IMAGE_TYPE_SVG: return SVGIcon;\n        case IMAGE_TYPE_BW: return BWIcon;\n        default: return null;\n        }\n    }\n\n    /** @override */\n    getLabel()\n    {\n        switch (this._imageType)\n        {\n        case IMAGE_TYPE_PNG: return I18N.toString('file.export.png');\n        case IMAGE_TYPE_JPG: return I18N.toString('file.export.jpg');\n        case IMAGE_TYPE_SVG: return I18N.toString('file.export.svg');\n        case IMAGE_TYPE_BW: return I18N.toString('file.export.bw');\n        default: return super.getLabel();\n        }\n    }\n\n    /** @override */\n    getTitle()\n    {\n        switch (this._imageType)\n        {\n        case IMAGE_TYPE_PNG: return I18N.toString('file.export.png.hint');\n        case IMAGE_TYPE_JPG: return I18N.toString('file.export.jpg.hint');\n        case IMAGE_TYPE_SVG: return I18N.toString('file.export.svg.hint');\n        case IMAGE_TYPE_BW: return I18N.toString('file.export.bw.hint');\n        default: return super.getTitle();\n        }\n    }\n\n    getImageType()\n    {\n        return this._imageType;\n    }\n}\n\nexport const IMAGE_EXPORTERS = [\n    new NodalGraphImageExporter(IMAGE_TYPE_PNG),\n    new NodalGraphImageExporter(IMAGE_TYPE_JPG),\n    new NodalGraphImageExporter(IMAGE_TYPE_SVG),\n    new NodalGraphImageExporter(IMAGE_TYPE_BW)\n];\n\nexport function registerImageExporters(exportManager)\n{\n    for (const exporter of IMAGE_EXPORTERS)\n    {\n        exportManager.registerExporter(exporter, 'image-' + exporter.getImageType());\n    }\n}\n\nexport default NodalGraphImageExporter;\n","import React from 'react';\n\nconst FILL_OPACITY = 0.1;\n\nclass BoxRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const visible = this.props.visible;\n        const fromX = this.props.fromX || 0;\n        const fromY = this.props.fromY || 0;\n        const toX = this.props.toX || fromX + 1;\n        const toY = this.props.toY || fromY + 1;\n        const color = this.props.color || '#000000';\n\n        const dx = toX - fromX;\n        const dy = toY - fromY;\n\n        return (\n            <g>\n                {visible &&\n                    <rect className=\"graph-ui\"\n                        x={Math.min(toX, fromX)}\n                        y={Math.min(toY, fromY)}\n                        width={Math.abs(dx)}\n                        height={Math.abs(dy)}\n                        stroke={color}\n                        fill={color}\n                        fillOpacity={FILL_OPACITY} />}\n            </g>\n        );\n    }\n}\n\nexport default BoxRenderer;\n","class SelectionBox\n{\n    constructor()\n    {\n        this._boundingBox = {\n            fromX: 0, fromY: 0,\n            toX: 0, toY: 0,\n            visible: false\n        };\n\n        this.targets = [];\n    }\n\n    getBoundingBox() { return this._boundingBox; }\n\n    getSelection(graph, forceUpdate = false)\n    {\n        if (forceUpdate)\n        {\n            const box = this._boundingBox;\n            const mx = Math.max(box.toX, box.fromX);\n            const my = Math.max(box.toY, box.fromY);\n            const lx = Math.min(box.toX, box.fromX);\n            const ly = Math.min(box.toY, box.fromY);\n            this.clearSelection();\n            getNodesWithin(graph, lx, ly, mx, my, this.targets);\n        }\n\n        return this.targets;\n    }\n\n    beginSelection(graph, x, y)\n    {\n        const box = this._boundingBox;\n        box.fromX = box.toX = x;\n        box.fromY = box.toY = y;\n        this.clearSelection();\n\n        box.visible = true;\n    }\n\n    updateSelection(graph, x, y)\n    {\n        const box = this._boundingBox;\n        box.toX = x;\n        box.toY = y;\n        this.getSelection(graph, true);\n    }\n\n    endSelection(graph, x, y)\n    {\n        const box = this._boundingBox;\n        box.toX = x;\n        box.toY = y;\n        this.getSelection(graph, true);\n\n        box.visible = false;\n    }\n\t\n    isTargetInSelection(target) { return this.targets.includes(target); }\n    hasSelection() { return this.targets.length > 0; }\n    clearSelection() { this.targets.length = 0; }\n    isVisible() { return this._boundingBox.visible; }\n}\n\nfunction getNodesWithin(graph, x1, y1, x2, y2, dst)\n{\n    const fromX = Math.min(x1, x2);\n    const fromY = Math.min(y1, y2);\n    const toX = Math.max(x1, x2);\n    const toY = Math.max(y1, y2);\n\n    for (const node of graph.getNodes())\n    {\n        if (node.x >= fromX && node.x < toX &&\n\t\t\tnode.y >= fromY && node.y < toY)\n        {\n            dst.push(node);\n        }\n    }\n    return dst;\n}\n\nexport default SelectionBox;\n","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\n\nclass SelectionBoxInputHandler extends AbstractInputHandler\n{\n    constructor(inputController, graphController, selectionBox)\n    {\n        super();\n\n        this._inputController = inputController;\n        this._graphController = graphController;\n        this._selectionBox = selectionBox;\n    }\n\n    /** @override */\n    onPreInputEvent(pointer)\n    {\n        const inputController = this._inputController;\n        const selectionBox = this._selectionBox;\n        if (selectionBox.hasSelection())\n        {\n            if (!inputController.isMoveMode(pointer.getInputAdapter()) || !selectionBox.isTargetInSelection(inputController.getImmediateTargetSource()))\n            {\n                selectionBox.clearSelection();\n            }\n        }\n\n        return false;\n    }\n\n    /** @override */\n    onDragStart(pointer)\n    {\n        const inputController = this._inputController;\n        if (inputController.hasActiveTarget()) return false;\n        if (inputController.isMoveMode(pointer.getInputAdapter())) return false;\n        if (inputController.hasCurrentTarget()) return false;\n\n        const inputEventPosition = pointer.getInputEventPosition();\n        this._selectionBox.beginSelection(this._graphController.getGraph(), inputEventPosition.x, inputEventPosition.y);\n        return true;\n    }\n  \n    /** @override */\n    onDragMove(pointer)\n    {\n        if (this._selectionBox.isVisible())\n        {\n            this._selectionBox.updateSelection(this._graphController.getGraph(), pointer.x, pointer.y);\n        }\n    }\n  \n    /** @override */\n    onDragStop(pointer)\n    {\n        if (this._selectionBox.isVisible())\n        {\n            this._selectionBox.endSelection(this._graphController.getGraph(), pointer.x, pointer.y);\n        }\n    }\n}\n\nexport default SelectionBoxInputHandler;","import React from 'react';\n\nimport BoxRenderer from 'graph2/renderer/BoxRenderer.js';\nimport GraphHighlightLayer from './GraphHighlightLayer.js';\n\nimport SelectionBox from 'graph2/controller/SelectionBox.js';\nimport SelectionBoxInputHandler from 'graph2/inputhandler/SelectionBoxInputHandler.js';\n\nclass SelectionBoxLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        const inputController = props.inputController;\n        const graphController = props.graphController;\n\n        this._selectionBox = new SelectionBox();\n        this._selectionBoxInputHandler = new SelectionBoxInputHandler(inputController, graphController, this._selectionBox);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const inputController = this.props.inputController;\n        if (inputController)\n        {\n            inputController.setSelectionBox(this._selectionBox);\n        }\n\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            const inputPriority = this.props.inputPriority || -1;\n            inputContext.addInputHandler(this._selectionBoxInputHandler, inputPriority);\n        }\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        this._selectionBox.clearSelection();\n\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            inputContext.removeInputHandler(this._selectionBoxInputHandler);\n        }\n    }\n\n    getSelectionBox() { return this._selectionBox; }\n    getSelectionBoxInputHandler() { return this._selectionBoxInputHandler; }\n\n    /** @override */\n    render()\n    {\n        const selectionBox = this._selectionBox;\n        const selectionBoundingBox = selectionBox.getBoundingBox();\n\n        return (\n            <React.Fragment>\n                <GraphHighlightLayer\n                    nodes={selectionBox.getSelection()} />\n                <BoxRenderer visible={selectionBox.isVisible()}\n                    fromX={selectionBoundingBox.fromX}\n                    fromY={selectionBoundingBox.fromY}\n                    toX={selectionBoundingBox.toX}\n                    toY={selectionBoundingBox.toY} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default SelectionBoxLayer;","class LabelFormatter\n{\n    formatLabel(target, nextLabel, prevLabel = null) { return nextLabel; }\n    getDefaultLabel(target) { return ''; }\n\n    formatNodeLabel(nextNodeLabel, prevNodeLabel = null)\n    {\n        return nextNodeLabel;\n    }\n\n    formatEdgeLabel(nextEdgeLabel, prevEdgeLabel = null)\n    {\n        return nextEdgeLabel;\n    }\n\n    getDefaultNodeLabel() { return ''; }\n    getDefaultEdgeLabel() { return ''; }\n}\nexport default LabelFormatter;\n\nexport const DEFAULT_LABEL_FORMATTER = new LabelFormatter();","const DEFAULT_REFRESH_TICKS = 10;\n\nclass GraphChangeHandler\n{\n    constructor(refreshTicks = DEFAULT_REFRESH_TICKS)\n    {\n        this._cachedGraphHash = 0;\n\n        this._refreshTicks = refreshTicks;\n        this._elapsedTicks = Infinity;\n\n        this._listeners = [];\n    }\n\n    addListener(listener)\n    {\n        if (typeof listener !== 'function')\n            throw new Error('Cannot add uncallable listener');\n        this._listeners.push(listener);\n    }\n\n    removeListener(listener)\n    {\n        const i = this._listeners.indexOf(listener);\n        if (i >= 0)\n        {\n            this._listeners.splice(i, 1);\n            return true;\n        }\n        return false;\n    }\n\n    clearListeners() { this._listeners.length = 0; }\n    getListeners() { return this._listeners; }\n\n    reset()\n    {\n        this._elapsedTicks = 0;\n        this._cachedGraphHash = 0;\n    }\n\n    update(graph)\n    {\n        if (++this._elapsedTicks >= this._refreshTicks)\n        {\n            this._elapsedTicks = 0;\n\n            const graphHash = graph.getHashCode(false);\n            if (graphHash !== this._cachedGraphHash)\n            {\n                this._cachedGraphHash = graphHash;\n                for (const listener of this._listeners)\n                {\n                    listener(graph);\n                }\n            }\n        }\n    }\n}\n\nexport default GraphChangeHandler;\n","import {DEFAULT_LABEL_FORMATTER} from './LabelFormatter.js';\n\nimport GraphChangeHandler from './GraphChangeHandler.js';\n\nimport GraphNode from 'graph2/element/GraphNode.js';\nimport GraphEdge from 'graph2/element/GraphEdge.js';\n\nexport const GRAPH_EVENT_CLEAR = 'graph-clear';\n\nclass GraphController\n{\n    constructor(graph)\n    {\n        this._graph = graph;\n        this._graphChangeHandler = new GraphChangeHandler();\n\n        this._labelEditor = null;\n        this._labelFormatter = null;\n\n        this._listeners = [];\n    }\n\n    setLabelEditor(labelEditor)\n    {\n        this._labelEditor = labelEditor;\n        return this;\n    }\n\n    setLabelFormatter(labelFormatter)\n    {\n        this._labelFormatter = labelFormatter;\n        return this;\n    }\n\t\n    addListener(listener)\n    {\n        this._listeners.push(listener);\n        return this;\n    }\n\n    removeListener(listener)\n    {\n        const index = this._listeners.indexOf(listener);\n        if (index >= 0) this._listeners.splice(index, 1);\n    }\n\n    clearListeners() { this._listeners.length = 0; }\n\n    initialize()\n    {\n    }\n\n    update()\n    {\n        if (this._graphChangeHandler)\n        {\n            this._graphChangeHandler.update(this._graph);\n        }\n    }\n\n    destroy()\n    {\n\t\t\n    }\n\t\n    clearGraph()\n    {\n        if (window.confirm(I18N.toString('alert.graph.clear')))\n        {\n            this._graph.clear();\n            this.emitGraphEvent(GRAPH_EVENT_CLEAR);\n        }\n    }\n\n    onGraphEvent(eventName, eventData)\n    {\n        // Do nothing... for now...\n    }\n\n    emitGraphEvent(eventName, eventData = {})\n    {\n        this.onGraphEvent(eventName, eventData);\n\n        for(const listener of this._listeners)\n        {\n            listener.onGraphEvent(this, eventName, eventData);\n        }\n    }\n\n    openLabelEditor(target, defaultLabel = null, callback = null)\n    {\n        if (!this._labelEditor)\n        {\n            if (callback) callback(target, defaultLabel, false);\n            return;\n        }\n\n        const labelEditor = this._labelEditor;\n        const prevLabel = defaultLabel || '';\n        labelEditor.openEditor(target, defaultLabel, (target, value) =>\n        {\n            const hasChanged = !prevLabel || (prevLabel.length > 0 && value !== prevLabel);\n            if (target instanceof GraphEdge)\n            {\n                target.setEdgeLabel(value);\n            }\n            else if (target instanceof GraphNode)\n            {\n                target.setNodeLabel(value);\n            }\n\n            if (callback) callback(target, value, hasChanged);\n        }, (target) =>\n        {\n            if (callback) callback(target, null, false);\n        });\n    }\n\n    getLabelFormatter() { return this._labelFormatter || DEFAULT_LABEL_FORMATTER; }\n    getLabelEditor() { return this._labelEditor; }\n    \n    getGraphChangeHandler() { return this._graphChangeHandler; }\n    getGraph() { return this._graph; }\n}\n\nexport default GraphController;","import React from 'react';\n\nimport NodeRenderer from 'graph2/renderer/NodeRenderer.js';\n\nclass GraphNodeRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const node = this.props.node;\n        const fill = this.props.fill;\n        const stroke = this.props.stroke;\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        const label = node.getNodeLabel();\n        const radius = node.getNodeSize();\n\n        return (\n            <React.Fragment>\n                <NodeRenderer\n                    position={node} \n                    radius={radius}\n                    label={label}\n                    color={fill}\n                    outline={stroke}\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default GraphNodeRenderer;\n","import React from 'react';\n\nimport GraphNodeRenderer from 'graph2/renderer/GraphNodeRenderer.js';\nimport GraphNodeInputHandler from 'graph2/inputhandler/GraphNodeInputHandler.js';\n\nclass GraphNodeLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        const inputController = props.inputController;\n        const graphController = props.graphController;\n\n        this._graphNodeInputHandler = new GraphNodeInputHandler(inputController, graphController);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            const inputPriority = this.props.inputPriority || -1;\n            inputContext.addInputHandler(this._graphNodeInputHandler, inputPriority);\n        }\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            inputContext.removeInputHandler(this._graphNodeInputHandler);\n        }\n    }\n\n    getGraphNodeInputHandler() { return this._graphNodeInputHandler; }\n\n    /** @override */\n    render()\n    {\n        const inputController = this.props.inputController;\n        const Renderer = this.props.nodeRenderer || GraphNodeRenderer;\n        const editable = this.props.editable;\n\n        const onMouseOver = inputController ? inputController.onMouseOver : null;\n        const onMouseOut = inputController ? inputController.onMouseOut : null;\n\n        const nodes = [];\n        for (const node of this.props.nodes)\n        {\n            nodes.push(\n                <Renderer\n                    key={node.getGraphElementID()}\n                    node={node}\n                    fill={'var(--color-graph-node)'}\n                    stroke={'var(--color-graph-text)'}\n                    onMouseOver={onMouseOver}\n                    onMouseOut={onMouseOut}\n                    pointerEvents={editable && inputController && inputController.hasPointerEvents(node) ? 'all' : 'none'} />\n            );\n        }\n\n        return (\n            <g>\n                {nodes}\n            </g>\n        );\n    }\n}\n\nexport default GraphNodeLayer;","import React from 'react';\n\nimport StartMarkerRenderer from './StartMarkerRenderer.js';\n\nclass StartNodeMarkerRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._prevSize = 1;\n    }\n\n    /** @override */\n    render()\n    {\n        const node = this.props.node;\n        const color = this.props.color;\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        let offset, size;\n        if ('getNodeSize' in node)\n        {\n            offset = node.getNodeSize();\n            size = node.getNodeSize() / 2;\n\n            this._prevSize = size;\n        }\n        else\n        {\n            offset = 0;\n            size = this._prevSize;\n        }\n\n        return (\n            <React.Fragment>\n                <StartMarkerRenderer\n                    position={node}\n                    offset={offset}\n                    size={size}\n                    color={color}\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default StartNodeMarkerRenderer;\n","import React from 'react';\n\nimport StartNodeMarkerRenderer from '../../renderer/StartNodeMarkerRenderer.js';\nimport IndexedGraphStartMarkerInputHandler from '../../inputhandler/IndexedGraphStartMarkerInputHandler.js';\n\nclass IndexedGraphStartMarkerLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        const inputController = props.inputController;\n        const graphController = props.graphController;\n\n        this._startMarkerInputHandler = new IndexedGraphStartMarkerInputHandler(inputController, graphController);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            const inputPriority = this.props.inputPriority || -1;\n            inputContext.addInputHandler(this._startMarkerInputHandler, inputPriority);\n        }\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            inputContext.removeInputHandler(this._startMarkerInputHandler);\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const inputController = this.props.inputController;\n        const Renderer = this.props.startMarkerRenderer || StartNodeMarkerRenderer;\n        const editable = this.props.editable;\n\n        const graphController = this.props.graphController;\n        const graph = graphController.getGraph();\n        let target = this._startMarkerInputHandler.getGhostMarker();\n        \n        if ('getStartNode' in graph && !target)\n        {\n            target = graph.getStartNode();\n        }\n\n        const onMouseOver = inputController ? inputController.onMouseOver : null;\n        const onMouseOut = inputController ? inputController.onMouseOut : null;\n        \n        return (\n            <g>\n                {target &&\n                    <Renderer\n                        node={target}\n                        color={'var(--color-graph-text)'}\n                        onMouseOver={onMouseOver}\n                        onMouseOut={onMouseOut}\n                        pointerEvents={editable && inputController && inputController.hasPointerEvents(target) ? 'all' : 'none'} />}\n            </g>\n        );\n    }\n}\n\nexport default IndexedGraphStartMarkerLayer;","import React from 'react';\n\nimport EdgeRenderer, {DIRECTED_FORWARD} from 'graph2/renderer/EdgeRenderer.js';\n\nclass GraphEdgeRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const edge = this.props.edge;\n        const stroke = this.props.stroke;\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        const start = edge.getStartPoint();\n        const end = edge.getEndPoint();\n        const center = edge.getCenterPoint();\n        const label = edge.getEdgeLabel();\n        const edgeDir = edge.getEdgeDirection();\n\n        return (\n            <React.Fragment>\n                <EdgeRenderer\n                    directed={DIRECTED_FORWARD}\n                    from={start}\n                    to={end}\n                    center={center}\n                    label={label}\n                    direction={edgeDir}\n                    color={stroke}\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = edge;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = edge;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default GraphEdgeRenderer;\n","import React from 'react';\n\nimport GraphEdgeRenderer from '../../renderer/GraphEdgeRenderer.js';\nimport GraphEdgeInputHandler from '../../inputhandler/GraphEdgeInputHandler.js';\n\nclass GraphEdgeLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        const inputController = props.inputController;\n        const graphController = props.graphController;\n        \n        this._graphEdgeInputHandler = new GraphEdgeInputHandler(inputController, graphController);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            const inputPriority = this.props.inputPriority || -1;\n            inputContext.addInputHandler(this._graphEdgeInputHandler, inputPriority);\n        }\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        const inputContext = this.props.inputContext;\n        if (inputContext)\n        {\n            inputContext.removeInputHandler(this._graphEdgeInputHandler);\n        }\n    }\n\n    getGraphEdgeInputHandler() { return this._graphEdgeInputHandler; }\n\n    /** @override */\n    render()\n    {\n        const inputController = this.props.inputController;\n        const Renderer = this.props.edgeRenderer || GraphEdgeRenderer;\n        const editable = this.props.editable;\n\n        const onMouseOver = inputController ? inputController.onMouseOver : null;\n        const onMouseOut = inputController ? inputController.onMouseOut : null;\n\t\t\n        const edges = [];\n        for(const edge of this.props.edges)\n        {\n            edges.push(\n                <Renderer\n                    key={edge.getGraphElementID()}\n                    edge={edge}\n                    stroke={'var(--color-graph-text)'}\n                    onMouseOver={onMouseOver}\n                    onMouseOut={onMouseOut}\n                    pointerEvents={editable && inputController && inputController.hasPointerEvents(edge) ? 'all' : 'none'} />\n            );\n        }\n\n        return (\n            <g>\n                {edges}\n            </g>\n        );\n    }\n}\n\nexport default GraphEdgeLayer;","import React from 'react';\n\nexport const SUBMIT_DELAY = 30;\nexport const SUBMIT_KEY = 'Enter';\nexport const CANCEL_KEY = 'Escape';\n\nclass PatternInput extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.inputElement = null;\n\n        this.placeholder = '';\n        this.maxLength = 524288;/*This is the default value*/\n        this.multiLine = true;\n        this.formatter = null;\n\n        this._submitTimeout = null;\n        this._submit = props.submitOnBlur;\n        this._skipBlur = false;\n        this._skipSelect = false;\n\n        this.state = {\n            prevValue: '',\n            value: ''\n        };\n\n        this.onChange = this.onChange.bind(this);\n        this.onFocus = this.onFocus.bind(this);\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n    }\n\n    setFormatter(formatter)\n    {\n        this.formatter = formatter;\n        return this;\n    }\n\n    setPlaceholder(placeholder)\n    {\n        this.placeholder = placeholder;\n        return this;\n    }\n\n    onFocus(e)\n    {\n        if (this._skipSelect)\n        {\n            this.inputElement.select();\n            this._skipSelect = false;\n        }\n    }\n\n    onBlur(e)\n    {\n        if (!this._submitTimeout)\n        {\n            this._submitTimeout = setTimeout(() => \n            {\n                this._submitTimeout = null;\n                if (this._skipBlur) return;\n\n                const submit = this._submit;\n                this._submit = this.props.submitOnBlur;\n                if (document.activeElement !== this.inputElement && submit)\n                {\n                    const value = this.state.value;\n                    if (this.props.onSubmit) this.props.onSubmit(value);\n\n                    this.setState({prevValue: value});\n                }\n                else\n                {\n                    this.setState((prev, props) => \n                    {\n                        return {value: prev.prevValue};\n                    });\n                }\n\n                if (this.props.onBlur) this.props.onBlur(e);\n            }, SUBMIT_DELAY);\n        }\n    }\n\n    onKeyDown(e)\n    {\n        if (e.key === SUBMIT_KEY)\n        {\n            if (e.shiftKey && this.multiLine) return;\n\n            this._submit = true;\n            this.inputElement.blur();\n\n            e.preventDefault();\n            e.stopPropagation();\n        }\n        else if (e.key === CANCEL_KEY)\n        {\n            this.setState((prev, props) => \n            {\n                return {value: prev.prevValue};\n            }, () => \n            {\n                this._submit = false;\n                this.inputElement.blur();\n            });\n\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    onChange(e)\n    {\n        const target = e.target;\n        const caretPosition = target.selectionStart;\n        let value = target.value;\n        if (this.formatter)\n        {\n            value = this.formatter(value, this.state.value);\n        }\n\n        this.setState({value: value}, () => \n        {\n            target.selectionEnd = caretPosition;\n        });\n    }\n\n    focus(select=true)\n    {\n        this._skipSelect = select;\n        this.inputElement.focus();\n    }\n\n    ignoreBlur(ignore)\n    {\n        const prev = this._skipBlur;\n        this._skipBlur = ignore;\n        return prev !== ignore;\n    }\n\n    appendValue(string, separator='', format=true)\n    {\n        const value = this.state.value;\n        if (value && value.length + string.length > this.maxLength) return;\n\n        let result;\n        if (value && value.length > 0)\n        {\n            result = value + separator + string;\n        }\n        else\n        {\n            result = string;\n        }\n\n        if (format && this.formatter)\n        {\n            result = this.formatter(result, this.state.value);\n        }\n\n        this.setState((prev, props) => \n        {\n            return {value: result};\n        });\n    }\n\n    resetValue(string)\n    {\n        this.setState({prevValue: string, value: string});\n    }\n\n    setValue(string, format=true)\n    {\n        let value = string;\n        if (format && this.formatter)\n        {\n            value = this.formatter(value, this.state.value);\n        }\n        this.setState({value: value});\n    }\n\n    getValue()\n    {\n        return this.state.value;\n    }\n\n    /** @override */\n    render()\n    {\n        const placeholder = this.placeholder;\n        const maxlength = this.maxLength;\n        const multiline = this.multiLine;\n        const disabled = this.props.disabled;\n\n        const value = this.state.value;\n\n        return (\n            <div id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}>\n                {\n                    multiline ?\n                        <textarea ref={ref=>this.inputElement=ref}\n                            type=\"text\" rows=\"1\" spellCheck=\"false\"\n                            disabled={disabled}\n                            placeholder={placeholder}\n                            maxLength={maxlength}\n                            value={value || ''}\n                            onChange={this.onChange}\n                            onFocus={this.onFocus}\n                            onBlur={this.onBlur}\n                            onKeyDown={this.onKeyDown}/>\n                        :\n                        <input ref={ref=>this.inputElement=ref}\n                            type=\"text\" spellCheck=\"false\"\n                            disabled={disabled}\n                            placeholder={placeholder}\n                            maxLength={maxlength}\n                            value={value || ''}\n                            onChange={this.onChange}\n                            onFocus={this.onFocus}\n                            onBlur={this.onBlur}\n                            onKeyDown={this.onKeyDown}/>\n                }\n            </div>\n        );\n    }\n}\n\nexport default PatternInput;\n","import React from 'react';\nimport Style from './LabelEditorWidget.css';\n\nimport GraphElement from 'graph2/element/GraphElement.js';\nimport GraphNode from 'graph2/element/GraphNode.js';\nimport GraphEdge from 'graph2/element/GraphEdge.js';\n\nimport PatternInput from 'graph2/components/widgets/pattern/PatternInput.js';\n\nclass LabelEditorWidget extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._ref = React.createRef();\n        this.inputComponent = null;\n\n        this.state = {\n            open: false\n        };\n\n        this._target = null;\n        this._targetCallback = null;\n\n        this.onInputSubmit = this.onInputSubmit.bind(this);\n        this.onInputBlur = this.onInputBlur.bind(this);\n    }\n\n    openEditor(graphElement, defaultValue = null, onSubmit = null, onCancel = null)\n    {\n        if (!(graphElement instanceof GraphElement))\n            throw new Error('Can only open editor for GraphElements');\n\n        this._target = graphElement;\n        this._targetOnSubmit = onSubmit;\n        this._targetOnCancel = onCancel;\n\n        if (graphElement instanceof GraphNode)\n        {\n            const formatter = this.props.labelFormatter.getNodeLabelFormatter();\n            this.inputComponent.setFormatter(formatter);\n        }\n        else if (graphElement instanceof GraphEdge)\n        {\n            const formatter = this.props.labelFormatter.getEdgeLabelFormatter();\n            this.inputComponent.setFormatter(formatter);\n        }\n\n        this.setState({ open: true }, () =>\n        {\n            this.inputComponent.resetValue(defaultValue || '');\n            this.inputComponent.focus();\n        });\n    }\n\n    closeEditor()\n    {\n        this._target = null;\n        this._targetOnSubmit = null;\n        this._targetOnCancel = null;\n\n        this.inputComponent.setFormatter(null);\n\n        this.setState({ open: false });\n    }\n\n    isEditorOpen()\n    {\n        return this.state.open;\n    }\n\n    getTarget()\n    {\n        return this._target;\n    }\n\n    onInputSubmit(value)\n    {\n        if (this._targetOnSubmit)\n        {\n            this._targetOnSubmit(this._target, value);\n            //Don't handle cancel callbacks...\n            this._targetOnCancel = null;\n        }\n    }\n\n    onInputBlur(e)\n    {\n        if (this._targetOnCancel)\n        {\n            this._targetOnCancel(this._target);\n            //Don't handle submit callbacks...\n            this._targetOnSubmit = null;\n        }\n        this.closeEditor();\n    }\n\n    /** @override */\n    render()\n    {\n        const isEditorOpen = this.state.open;\n\n        const target = this._target;\n        const targetStyle = this.props.style || {};\n        const viewport = this.props.viewport;\n\n        if (viewport)\n        {\n            const viewportAdapter = this.props.viewport.getViewportAdapter();\n\n            if (target)\n            {\n                const center = target.getCenterPoint();\n                const element = viewportAdapter.getElement();\n                const parentClientRect = element.getBoundingClientRect();\n                const screenPos = transformViewToScreen(\n                    element,\n                    center.x + viewportAdapter.getOffsetX(),\n                    center.y + viewportAdapter.getOffsetY()\n                );\n                const x = screenPos.x;\n                const y = screenPos.y;\n                const offsetX = -(this._ref.current.offsetWidth / 2) - parentClientRect.left;\n                const offsetY = -(this._ref.current.offsetHeight / 2) - parentClientRect.top;\n\n                targetStyle['top'] = (y + offsetY) + 'px';\n                targetStyle['left'] = (x + offsetX) + 'px';\n            }\n        }\n\n        return (\n            <div ref={this._ref}\n                id={this.props.id}\n                className={Style.editor_container +\n                    (isEditorOpen ? ' open ' : '') +\n                    ' ' + this.props.className}\n                style={targetStyle}>\n                <PatternInput ref={ref => this.inputComponent = ref}\n                    submitOnBlur={this.props.saveOnExit}\n                    onSubmit={this.onInputSubmit}\n                    onBlur={this.onInputBlur} />\n                <div className={Style.tray_container}>\n                    {this.props.children}\n                </div>\n            </div>\n        );\n    }\n}\n\nfunction transformViewToScreen(svg, x, y)\n{\n    const ctm = svg.getScreenCTM();\n    return {\n        x: (x * ctm.a) + ctm.e,\n        y: (y * ctm.d) + ctm.f\n    };\n}\n\nexport default LabelEditorWidget;\n","export function getUnreachableNodes(graph)\n{\n    if (graph.getNodeCount() <= 1) return [];\n\n    const edges = graph.getEdges();\n    const nodes = graph.getNodes().slice();\n    const startNode = nodes.shift();\n    let nextNodes = [];\n    nextNodes.push(startNode);\n\n    while(nextNodes.length > 0)\n    {\n        const node = nextNodes.pop();\n        for(const edge of edges)\n        {\n            if (edge.getEdgeFrom() === node)\n            {\n                const i = nodes.indexOf(edge.getEdgeTo());\n                if (i >= 0)\n                {\n                    const nextNode = nodes.splice(i, 1)[0];\n                    nextNodes.push(nextNode);\n                }\n            }\n        }\n    }\n\n    return nodes;\n}","export { getUnreachableNodes } from './UnreachableNodes.js';","const MAX_COMPUTATION_STEPS = 1000;\n\nexport function solveFSA(fsa, input)\n{\n    if (typeof input === 'string') input = input[Symbol.iterator]();\n\n    if (fsa.isDeterministic())\n    {\n        //Solve if the DFA way...\n        let state = fsa.getStartState();\n        let symbol = null;\n\n        //Is testing null after assignment\n        while ((symbol = input.next().value))\n        {\n            const states = fsa.doTransition(state, symbol);\n            if (states.length < 1) return false;\n            //DFA's should only return 1 output\n            state = states[0];\n        }\n        return fsa.isFinalState(state);\n    }\n    else\n    {\n        //Solve it the NFA way...\n        const cachedStates = [];\n        const cachedSymbols = [];\n\n        //Start with the start state...\n        const startState = fsa.getStartState();\n        //(index refers to the \"level\" of computation)\n        cachedStates.push({ state: startState, index: 0 });\n        //...and any state defined similarly by closure...\n        for (const relatedState of fsa.doClosureTransition(startState))\n        {\n            cachedStates.push({ state: relatedState, index: 0 });\n        }\n\n        //The next symbol to compute...\n        let symbol = null;\n\n        //Just to be safe from infinite loops...\n        let counter = 0;\n        while (cachedStates.length > 0)\n        {\n            symbol = input.next().value;\n            if (solveFSAByStep(fsa, symbol, cachedStates, cachedSymbols))\n            {\n                return true;\n            }\n\n            //HACK: This is to stop any infinite loops! This should be fixed in the future!\n            ++counter;\n            if (counter > MAX_COMPUTATION_STEPS)\n            {\n                return false;\n            }\n        }\n\n        return false;\n    }\n}\n\n//TODO: When an empty transition occurs, it does a closure transition.\n//The closure chain will be stored as a group\n//Any future transitions must not re-enter the group\nexport function solveFSAByStep(nfa, symbol, cachedStates, cachedSymbols)\n{\n    //initialize variables\n    let state = null;\n    let nextStates = [];\n    let nextIndex = 0;\n\n    if (symbol)\n    {\n        cachedSymbols.push(symbol);\n    }\n\n    for (const cstate of cachedStates)\n    {\n        state = cstate.state;\n        symbol = cstate.index < cachedSymbols.length ? cachedSymbols[cstate.index] : null;\n\n        if (symbol)\n        {\n            //Read to next state...\n            nextIndex = cstate.index + 1;\n            for (const nextState of nfa.doTerminalTransition(state, symbol))\n            {\n                nextStates.push({ state: nextState, index: nextIndex });\n            }\n        }\n        else\n        {\n            if (nfa.isFinalState(state)) return true;\n        }\n\n        //Read none to next state...\n        nextIndex = cstate.index;\n    }\n    cachedStates.length = 0;\n    cachedStates.push(...nextStates);\n    return false;\n}\n","export {convertToDFA, convertToNFA} from './util/ConvertFSA.js';\nexport {solveFSA, solveFSAByStep} from './util/SolveFSA.js';\nexport { isEquivalentFSAWithWitness, isEquivalentFSA, isEquivalentDFA} from './util/EqualFSA.js';\nexport {invertDFA} from './util/InvertDFA.js';\nexport {intersectFSA, intersectDFA} from './util/IntersectFSA.js';\n","import GraphNode from 'graph2/element/GraphNode.js';\n\nclass FSANode extends GraphNode\n{\n    constructor(id, x, y)\n    {\n        super(id, x, y);\n\n        this._accept = false;\n\n        //this is not saved to hash since it is an aesthetic option\n        this._custom = false;\n    }\n\n    setNodeAccept(value)\n    {\n        this._accept = value;\n    }\n\n    getNodeAccept()\n    {\n        return this._accept;\n    }\n\n    setNodeCustom(value)\n    {\n        this._custom = value;\n    }\n\n    getNodeCustom()\n    {\n        return this._custom;\n    }\n\n    /** @override */\n    getHashString(usePosition = true)\n    {\n        return super.getHashString(usePosition) + ':' + (this._accept ? '1' : '0');\n    }\n}\n\nexport default FSANode;\n","import FSAGraph from './graph/FSAGraph.js';\nimport { SYMBOL_SEPARATOR } from './graph/element/FSAEdge.js';\n\nconst GRAPH_PARSER_VERSION = '1.0.0';\n\nexport const JSON = {\n    parse(data, dst = null)\n    {\n        if (!dst) dst = new FSAGraph();\n        else dst.clear();\n\n        const nodeDatas = data['nodes'] || [];\n        const nodeCount = Math.min(nodeDatas.length || 0, data['nodeCount'] || 0);\n        const edgeDatas = data['edges'] || [];\n        const edgeCount = Math.min(edgeDatas.length || 0, data['edgeCount'] || 0);\n        const initialIndex = data['initial'] || 0;\n\n        const nodeIndices = new Map();\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            const nodeData = nodeDatas[i];\n            if (!nodeData) continue;\n\n            //NOTE: Assumes createNode will maintain order\n            const node = dst.createNode(nodeData['x'] || 0, nodeData['y'] || 0, nodeData['id']);\n            node.setNodeLabel(nodeData['label'] || '');\n            node.setNodeAccept(nodeData['accept'] || false);\n            node.setNodeCustom(nodeData['custom'] || false);\n\n            nodeIndices.set(i, node);\n        }\n\n        const initialNode = nodeIndices.get(initialIndex);\n        if (initialNode)\n        {\n            dst.setStartNode(initialNode);\n        }\n\n        for (let i = 0; i < edgeCount; ++i)\n        {\n            const edgeData = edgeDatas[i];\n            if (!edgeData) continue;\n            const sourceNode = nodeIndices.get(edgeData['from']) || null;\n            //Cannot create source-less edges\n            if (!sourceNode) continue;\n            const destinationNode = nodeIndices.get(edgeData['to']) || null;\n            //NOTE: Assumes createEdge will maintain order\n            const edge = dst.createEdge(sourceNode, destinationNode, edgeData['id']);\n            const quadData = edgeData['quad'] || {};\n            edge.setEdgeLabel(edgeData['label'] || '');\n            edge.setQuadraticRadians(quadData['radians'] || 0);\n            edge.setQuadraticLength(quadData['length'] || 0);\n        }\n\n        return dst;\n    },\n    objectify(graph)\n    {\n        const graphNodes = graph.getNodes() || [];\n        const nodeCount = graphNodes.length || 0;\n        const graphEdges = graph.getEdges() || [];\n        const edgeCount = graphEdges.length || 0;\n        const graphInitial = graph.getStartNode();\n\n        const nodeDatas = new Array(nodeCount);\n        const nodeIndices = new Map();\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            const node = graphNodes[i];\n            if (node)\n            {\n                //NOTE: Assumes node must have an id\n                const elementID = node.getGraphElementID();\n\n                nodeIndices.set(node, i);\n                nodeDatas[i] = {\n                    id: elementID,\n                    x: node.x || 0, y: node.y || 0,\n                    label: node.getNodeLabel() || '',\n                    accept: node.getNodeAccept() || false,\n                    custom: node.getNodeCustom() || false\n                };\n            }\n        }\n\n        const edgeDatas = new Array(edgeCount);\n        for (let i = 0; i < edgeCount; ++i)\n        {\n            const edge = graphEdges[i];\n            if (edge)\n            {\n                //NOTE: Assumes edge must have an id\n                const elementID = edge.getGraphElementID();\n\n                const quad = edge.getQuadratic() || {};\n                const edgeSource = edge.getEdgeFrom();\n                const edgeDestination = edge.getEdgeTo();\n                const sourceIndex = nodeIndices.has(edgeSource) ? nodeIndices.get(edgeSource) : -1;\n                const destinationIndex = nodeIndices.has(edgeDestination) ? nodeIndices.get(edgeDestination) : -1;\n                edgeDatas[i] = {\n                    id: elementID,\n                    from: sourceIndex,\n                    to: destinationIndex,\n                    quad: { radians: quad['radians'] || 0, length: quad['length'] || 0 },\n                    label: edge.getEdgeLabel() || ''\n                };\n            }\n        }\n\n        const initialIndex = nodeIndices.get(graphInitial) || 0;\n\n        return {\n            nodeCount: nodeCount,\n            nodes: nodeDatas,\n            edgeCount: edgeCount,\n            edges: edgeDatas,\n            initial: initialIndex,\n            _version: GRAPH_PARSER_VERSION\n        };\n    }\n};\n\nexport const XML = {\n    parse(data, dst = null)\n    {\n        if (!dst) dst = new FSAGraph();\n        else dst.clear();\n\n        const nodeElements = data.getElementsByTagName('state') || [];\n        const nodeCount = nodeElements.length;\n        const edgeElements = data.getElementsByTagName('transition') || [];\n        const edgeCount = edgeElements.length;\n        let initialIndex = '0';\n\n        //Get the nodes...\n        const nodeElementIDs = new Map();\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            const nodeElement = nodeElements[i];\n            if (!nodeElement) continue;\n            const nodeElementID = nodeElement.getAttribute('id');\n            if (!nodeElementID) continue;\n\n            //Get x value\n            let x = 0;\n            const xElements = nodeElement.getElementsByTagName('x');\n            //If no elements exists, we are guaranteed an empty list...\n            if (xElements.length > 0)\n            {\n                const xElement = xElements[0];\n                if (xElement.hasChildNodes())\n                {\n                    //hasChildNodes() guarantees at least 1 element\n                    const xValue = xElement.childNodes[0];\n                    if (xValue)\n                    {\n                        try\n                        {\n                            x = parseFloat(xValue.nodeValue) || 0;\n                        }\n                        catch (e)\n                        {\n                            x = 0;\n                        }\n                    }\n                }\n            }\n\n            //Get y value\n            let y = 0;\n            const yElements = nodeElement.getElementsByTagName('y');\n            //If no elements exists, we are guaranteed an empty list...\n            if (yElements.length > 0)\n            {\n                const yElement = yElements[0];\n                if (yElement.hasChildNodes())\n                {\n                    //hasChildNodes() guarantees at least 1 element\n                    const yValue = yElement.childNodes[0];\n                    if (yValue)\n                    {\n                        try\n                        {\n                            y = parseFloat(yValue.nodeValue) || 0;\n                        }\n                        catch (e)\n                        {\n                            y = 0;\n                        }\n                    }\n                }\n            }\n\n            //Get initial flag\n            const initialElements = nodeElement.getElementsByTagName('initial');\n            //If no elements exists, we are guaranteed an empty list...\n            const initial = initialElements.length > 0;\n\n            //Get final flag\n            const finalElements = nodeElement.getElementsByTagName('final');\n            //If no elements exists, we are guaranteed an empty list...\n            const final = finalElements.length > 0;\n\n            //NOTE: Assumes createNode will maintain order\n            const node = dst.createNode(x, y);\n            node.setNodeLabel(nodeElement.getAttribute('name') || '');\n            node.setNodeAccept(final);\n\n            if (initial) initialIndex = nodeElementID;\n            nodeElementIDs.set(nodeElementID, node);\n        }\n\n        //Set the initial node...\n        const initialNode = nodeElementIDs.get(initialIndex);\n        if (initialNode)\n        {\n            dst.setStartNode(initialNode);\n        }\n\n        //Readjust the center of graph...\n        const boundingRect = dst.getBoundingRect();\n        const minX = boundingRect.minX;\n        const minY = boundingRect.minY;\n        const width = boundingRect.width;\n        const height = boundingRect.height;\n        const graphNodes = dst.getNodes();\n        for (let i = 0, len = graphNodes.length; i < len; ++i)\n        {\n            graphNodes[i].x -= minX + width / 2;\n            graphNodes[i].y -= minY + height / 2;\n        }\n\n        //Get the transitions...\n        const transitionMapping = new Map();\n        for (let i = 0; i < edgeCount; ++i)\n        {\n            const edgeElement = edgeElements[i];\n            if (!edgeElement) continue;\n\n            //Get from value\n            let sourceID = null;\n            const fromElements = edgeElement.getElementsByTagName('from');\n            //If no elements exists, we are guaranteed an empty list...\n            if (fromElements.length > 0)\n            {\n                const fromElement = fromElements[0];\n                if (fromElement.hasChildNodes())\n                {\n                    //hasChildNodes() guarantees at least 1 element\n                    const fromValue = fromElement.childNodes[0];\n                    if (fromValue)\n                    {\n                        sourceID = fromValue.nodeValue;\n                    }\n                }\n            }\n\n            //Cannot create source-less edges\n            if (!nodeElementIDs.has(sourceID)) continue;\n\n            //Get to value\n            let destinationID = '';\n            const toElements = edgeElement.getElementsByTagName('to');\n            //If no elements exists, we are guaranteed an empty list...\n            if (toElements.length > 0)\n            {\n                const toElement = toElements[0];\n                if (toElement.hasChildNodes())\n                {\n                    //hasChildNodes() guarantees at least 1 element\n                    const toValue = toElement.childNodes[0];\n                    if (toValue)\n                    {\n                        destinationID = toValue.nodeValue || '';\n                    }\n                }\n            }\n\n            //Get read value\n            let symbol = '';\n            const readElements = edgeElement.getElementsByTagName('read');\n            //If no elements exists, we are guaranteed an empty list...\n            if (readElements.length > 0)\n            {\n                const readElement = readElements[0];\n                if (readElement.hasChildNodes())\n                {\n                    //hasChildNodes() guarantees at least 1 element\n                    const readValue = readElement.childNodes[0];\n                    if (readValue)\n                    {\n                        symbol = readValue.nodeValue || '';\n                    }\n                }\n            }\n\n            const transitionID = sourceID + '\\n' + destinationID;\n            let symbols;\n            if (transitionMapping.has(transitionID))\n            {\n                symbols = transitionMapping.get(transitionID);\n            }\n            else\n            {\n                symbols = [];\n                transitionMapping.set(transitionID, symbols);\n            }\n            symbols.push(symbol);\n        }\n\n        for (const transitionKey of transitionMapping.keys())\n        {\n            const key = transitionKey.split('\\n');\n            if (key.length !== 2) continue;\n\n            const symbols = transitionMapping.get(transitionKey);\n            const label = symbols.join(SYMBOL_SEPARATOR);\n            //Should never be null, since it was checked before...\n            const sourceNode = nodeElementIDs.get(key[0]);\n            const destinationNode = nodeElementIDs.get(key[1]);\n\n            //NOTE: Assumes createEdge will maintain order\n            const edge = dst.createEdge(sourceNode, destinationNode);\n            edge.setEdgeLabel(label);\n        }\n\n        return dst;\n    },\n    objectify(graph)\n    {\n        const graphNodes = graph.getNodes() || [];\n        const nodeCount = graphNodes.length || 0;\n        const graphEdges = graph.getEdges() || [];\n        // const edgeCount = graphEdges.length || 0;\n        const graphInitial = graph.getStartNode();\n\n        const header = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?>' +\n            '<!--Created with flap.js ' + GRAPH_PARSER_VERSION + '-->' +\n            '<structure></structure>';\n        const parser = new DOMParser();\n        const doc = parser.parseFromString(header, 'application/xml');\n        const structure = doc.getElementsByTagName('structure')[0];\n\n        const type = doc.createElement('type');\n        type.innerHTML = 'fa'; //finite automata\n        structure.appendChild(type);\n\n        const automaton = doc.createElement('automaton');\n        structure.appendChild(automaton);\n\n        const nodeIndices = new Map();\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            const node = graphNodes[i];\n            nodeIndices.set(node, i);\n\n            //state tag\n            const state = doc.createElement('state');\n            state.id = '' + i;\n            state.setAttribute('name', node.getNodeLabel());\n            automaton.appendChild(state);\n\n            //x tag\n            const x = doc.createElement('x');\n            x.innerHTML = '' + (node.x || 0);\n            state.appendChild(x);\n\n            //y tag\n            const y = doc.createElement('y');\n            y.innerHTML = '' + (node.y || 0);\n            state.appendChild(y);\n\n            //initial tag\n            if (graphInitial === node)\n            {\n                state.appendChild(doc.createElement('initial'));\n            }\n\n            //final tag\n            if (node.getNodeAccept())\n            {\n                state.appendChild(doc.createElement('final'));\n            }\n        }\n\n        for (let edge of graphEdges)\n        {\n            const symbols = edge.getEdgeLabel().split(SYMBOL_SEPARATOR);\n            for (let symbol of symbols)\n            {\n                //transition tag\n                const transition = doc.createElement('transition');\n                automaton.appendChild(transition);\n\n                //from tag\n                const from = doc.createElement('from');\n                from.innerHTML = '' + (nodeIndices.get(edge.getEdgeFrom()) || 0);\n                transition.appendChild(from);\n\n                //to tag\n                const to = doc.createElement('to');\n                to.innerHTML = '' + (nodeIndices.get(edge.getEdgeTo()) || 0);\n                transition.appendChild(to);\n\n                //read tag\n                const read = doc.createElement('read');\n                read.innerHTML = '' + (symbol || '');\n                transition.appendChild(read);\n            }\n        }\n\n        return doc;\n    }\n};\n","import GraphEdge from 'graph2/element/GraphEdge.js';\n\nclass AbstractGraphLabeler\n{\n    constructor() {}\n\n    getDefaultLabel(target)\n    {\n        if (target instanceof GraphEdge)\n        {\n            return this.getDefaultEdgeLabel();\n        }\n        else\n        {\n            return this.getDefaultNodeLabel();\n        }\n    }\n\n    getLabelFormatter(target)\n    {\n        if (target instanceof GraphEdge)\n        {\n            return this.getEdgeLabelFormatter();\n        }\n        else\n        {\n            return this.getNodeLabelFormatter();\n        }\n    }\n\n    //Deprecated - use getDefaultLabel()\n    getDefaultNodeLabel()\n    {\n        return '';\n    }\n\n    //Deprecated - use getDefaultLabel()\n    getDefaultEdgeLabel()\n    {\n        return '';\n    }\n\n    //Deprecated - use getDefaultLabel()\n    getNodeLabelFormatter()\n    {\n        throw new Error('Node label formatting is not supported');\n    }\n\n    //Deprecated - use getDefaultLabel()\n    getEdgeLabelFormatter()\n    {\n        throw new Error('Edge label formatting is not supported');\n    }\n}\n\nexport default AbstractGraphLabeler;\n","class AbstractMachineController\n{\n    constructor(module, machineBuilder)\n    {\n        if (!module) throw new Error('Missing module for machine controller');\n        if (!machineBuilder) throw new Error('Missing machine builder for machine controller');\n\n        this._module = module;\n        this._machineBuilder = machineBuilder;\n    }\n\n    initialize(module)\n    {\n        this._machineBuilder.initialize(module);\n    }\n\n    destroy(module)\n    {\n        this._machineBuilder.destroy(module);\n    }\n\n    update(module)\n    {\n    }\n\n    getMachineBuilder()\n    {\n        return this._machineBuilder;\n    }\n\n    getModule()\n    {\n        return this._module;\n    }\n}\n\nexport default AbstractMachineController;\n","const ALLOW_AUTOMATIC_REGISTER = false;\n\nconst Eventable = {\n    __eventListeners: null,\n    mixin(targetClass)\n    {\n        const targetPrototype = targetClass.prototype;\n        Object.assign(targetPrototype, Eventable);\n        delete targetPrototype.mixin;\n    },\n\n    registerEvent(eventName)\n    {\n        if (!this.__eventListeners) this.__eventListeners = new Map();\n\n        if (!this.__eventListeners.has(eventName))\n        {\n            this.__eventListeners.set(eventName, []);\n        }\n        else\n        {\n            throw new Error('Already registered event \\'' + eventName + '\\'');\n        }\n    },\n\n    unregisterEvent(eventName)\n    {\n        if (!this.__eventListeners) return;\n\n        if (this.__eventListeners.has(eventName))\n        {\n            this.__eventListeners.delete(eventName);\n        }\n        else\n        {\n            throw new Error('Unable to find event \\'' + eventName + '\\'');\n        }\n    },\n\n    addEventListener(eventName, listener)\n    {\n        if (!this.__eventListeners) this.__eventListeners = new Map();\n\n        let listeners;\n        if (this.__eventListeners.has(eventName))\n        {\n            listeners = this.__eventListeners.get(eventName);\n        }\n        else if (ALLOW_AUTOMATIC_REGISTER)\n        {\n            listeners = [];\n            this.__eventListeners.set(eventName, listeners);\n        }\n        else\n        {\n            throw new Error('Unable to find event \\'' + eventName + '\\'');\n        }\n\n        listeners.push(listener);\n    },\n\n    removeEventListener(eventName, listener)\n    {\n        if (!this.__eventListeners) return;\n\n        if (this.__eventListeners.has(eventName))\n        {\n            const listeners = this.__eventListeners.get(eventName);\n            let flag = false;\n            let i = listeners.length;\n            while (i--)\n            {\n                if (listeners[i] === listener)\n                {\n                    listeners.splice(i, 1);\n                    flag = true;\n                }\n            }\n\n            if (!flag)\n            {\n                throw new Error('Unable to find listener for event \\'' + eventName + '\\'');\n            }\n        }\n        else\n        {\n            throw new Error('Unknown event \\'' + eventName + '\\'');\n        }\n    },\n\n    clearEventListeners(eventName)\n    {\n        if (!this.__eventListeners) return;\n\n        if (!eventName)\n        {\n            this.__eventListeners.clear();\n        }\n        else if (this.__eventListeners.has(eventName))\n        {\n            const listeners = this.__eventListeners.get(eventName);\n            listeners.length = 0;\n        }\n        else if (ALLOW_AUTOMATIC_REGISTER)\n        {\n            const listeners = [];\n            this.__eventListeners.set(eventName, listeners);\n        }\n        else\n        {\n            throw new Error('Unable to find event \\'' + eventName + '\\'');\n        }\n    },\n\n    countEventListeners(eventName)\n    {\n        if (!this.__eventListeners) return 0;\n        return this.__eventListeners.has(eventName) ? this.__eventListeners.get(eventName).length : 0;\n    },\n\n    getEventListeners(eventName)\n    {\n        if (!this.__eventListeners) return null;\n        return this.__eventListeners.get(eventName);\n    },\n\n    on(eventName, listener)\n    {\n        this.addEventListener(eventName, listener);\n    },\n\n    once(eventName, listener)\n    {\n        const f = (...args) => \n        {\n            try\n            {\n                listener.apply(null, args);\n            }\n            finally\n            {\n                this.removeEventListener(eventName, f);\n            }\n        };\n\n        this.addEventListener(eventName, f);\n    },\n\n    emit(eventName, ...args)\n    {\n        try\n        {\n            if (!this.__eventListeners) return;\n\n            let listeners;\n            if (!this.__eventListeners.has(eventName))\n            {\n                if (ALLOW_AUTOMATIC_REGISTER)\n                {\n                    listeners = [];\n                    this.__eventListeners.set(eventName, listeners);\n                }\n                else\n                {\n                    throw new Error('Unable to find event \\'' + eventName + '\\'');\n                }\n            }\n            else\n            {\n                listeners = this.__eventListeners.get(eventName);\n\n                let result = null;\n                let i = listeners.length;\n                while (i--)\n                {\n                    try\n                    {\n                        result = listeners[i].apply(null, args);\n                    }\n                    catch (e)\n                    {\n                        continue;\n                    }\n\n                    if (result === true) break;\n                }\n            }\n        }\n        finally\n        {\n            this.onEventProcessed(eventName, ...args);\n        }\n    },\n\n    onEventProcessed(eventName, ...args)\n    {\n        //Do nothing.\n    }\n};\n\nexport default Eventable;\n","import AbstractEventHandler from 'session/manager/undo/AbstractEventHandler.js';\n\nclass SafeGraphEventHandler extends AbstractEventHandler\n{\n    constructor(graphController, graphParser)\n    {\n        super();\n\n        this._graphController = graphController;\n        this._graphParser = graphParser;\n        this._graphData = graphParser.objectify(graphController.getGraph());\n    }\n\n    /** @override */\n    applyUndo(undoManager)\n    {\n        const prevEvent = undoManager.getPreviousEvent();\n        if (prevEvent instanceof SafeGraphEventHandler)\n        {\n            prevEvent.applyRedo(undoManager);\n        }\n        else\n        {\n            this._graphController.getGraph().clear();\n        }\n    }\n\n    /** @override */\n    applyRedo(undoManager)\n    {\n        this._graphParser.parse(this._graphData, this._graphController.getGraph());\n    }\n}\nexport default SafeGraphEventHandler;\n","import React from 'react';\nimport Style from './PanelDivider.css';\n\nclass PanelDivider extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        return (\n            <div id={this.props.id}\n                className={Style.panel_divider +\n          ' ' + this.props.className}\n                style={this.props.style}>\n            </div>\n        );\n    }\n}\n\nexport default PanelDivider;\n","import React from 'react';\n\nclass TriangleIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M12 7.77L18.39 18H5.61L12 7.77M12 4L2 20h20L12 4z\"/>\n            </svg>\n        );\n    }\n}\nexport default TriangleIcon;\n","import React from 'react';\nimport Style from './PanelCheckbox.css';\n\nclass PanelCheckbox extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.state = {\n            checked: props.initial || false\n        };\n\n        this.onChange = this.onChange.bind(this);\n    }\n\n    setChecked(value)\n    {\n        this.setState({checked: value});\n    }\n\n    isChecked()\n    {\n        return this.state.checked;\n    }\n\n    onChange(e)\n    {\n        const checked = e.target.checked;\n        if (this.state.checked !== checked)\n        {\n            this.setState({checked: checked});\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        return (\n            <div id={this.props.id}\n                className={Style.checkbox_container +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                <input type=\"checkbox\" id={this.props.id + '-checkbox'}\n                    name={this.props.id + '-checkbox'} value={this.props.value}\n                    checked={this.state.checked}\n                    disabled={this.props.disabled}\n                    onChange={this.onChange}/>\n                <label htmlFor={this.props.id + '-checkbox'}>{this.props.title}</label>\n            </div>\n        );\n    }\n}\n\nexport default PanelCheckbox;\n","\n/**\n * A class that represents a parser that can encode (compose)\n * and decode (parse) to and from a target object and data.\n */\nclass Parser\n{\n    constructor() {}\n\n    /**\n     * Parses the data object to another object.\n     * \n     * @param  {Object} data    the data to parse.\n     * @param  {*} [dst=null]   the target to set parsed data. If this is null, the\n     *                          data will be set on a new target and returned.\n     * @return {*}              the result in the passed-in dst.\n     */\n    parse(data, dst = null)\n    {\n        return dst;\n    }\n\n    /**\n     * Composes an object from the target.\n     * \n     * @param  {*} target               the target to compose into data.\n     * @param  {Object} [dst=null]      the object to append the composed data. If this\n     *                                  is null, the data will be set on a new empty\n     *                                  object and returned.\n     * @return {Object}                 the result in the passed-in dst.\n     */\n    compose(target, dst = null)\n    {\n        return dst;\n    }\n}\n\nexport default Parser;\n","import React from 'react';\n\nconst RETURN_FOCUS_DELAY = 50;\n\nclass PatternInputButton extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.ref = null;\n\n        this._timeout = null;\n\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onAnyMouseUp = this.onAnyMouseUp.bind(this);\n    }\n\n    onMouseDown(e)\n    {\n        const parent = this.props.parent;\n        if (parent.ignoreBlur(true))\n        {\n            document.addEventListener('mouseup', this.onAnyMouseUp);\n        }\n\n        if (this.props.onClick)\n        {\n            this.props.onClick(e, this);\n        }\n    }\n\n    onAnyMouseUp()\n    {\n        document.removeEventListener('mouseup', this.onAnyMouseUp);\n\n        if (this._timeout) clearTimeout(this._timeout);\n        this._timeout = setTimeout(() => \n        {\n            this._timeout = null;\n\n            const parent = this.props.parent;\n            parent.ignoreBlur(false);\n\n            if (document.activeElement === this.ref)\n            {\n                parent.focus(false);\n            }\n            else if (document.activeElement !== this.props.parent.inputElement)\n            {\n                parent.onBlur();\n            }\n        }, RETURN_FOCUS_DELAY);\n    }\n\n    /** @override */\n    render()\n    {\n        return (\n            <button ref={ref=>this.ref=ref}\n                id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                title={this.props.title}\n                onMouseDown={this.onMouseDown}>\n                {this.props.title}\n            </button>\n        );\n    }\n}\n\nexport default PatternInputButton;\n","import React from 'react';\n\nclass DownArrowIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 24 24\">\n                <path d=\"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z\"/>\n            </svg>\n        );\n    }\n}\nexport default DownArrowIcon;\n","class MachineChangeHandler\n{\n    constructor()\n    {\n        this._listeners = [];\n    }\n\n    addListener(listener)\n    {\n        if (typeof listener !== 'function')\n            throw new Error('Cannot add uncallable listener');\n        this._listeners.push(listener);\n    }\n\n    removeListener(listener)\n    {\n        const i = this._listeners.indexOf(listener);\n        if (i >= 0)\n        {\n            this._listeners.splice(i, 1);\n            return true;\n        }\n        return false;\n    }\n\n    clearListeners()\n    {\n        this._listeners.length = 0;\n    }\n\n    getListeners()\n    {\n        return this._listeners;\n    }\n\n    update(machineBuilder)\n    {\n        for (const listener of this._listeners)\n        {\n            listener(machineBuilder);\n        }\n    }\n}\n\nexport default MachineChangeHandler;\n","import MachineChangeHandler from 'experimental/MachineChangeHandler.js';\n\nclass AbstractMachineBuilder\n{\n    constructor()\n    {\n        this._machineChangeHandler = new MachineChangeHandler();\n\n        this._errors = [];\n        this._warnings = [];\n\n        this.onGraphChange = this.onGraphChange.bind(this);\n    }\n\n    initialize(module)\n    {\n        module.getGraphController().getGraphChangeHandler().addListener(this.onGraphChange);\n    }\n\n    destroy(module)\n    {\n        module.getGraphController().getGraphChangeHandler().removeListener(this.onGraphChange);\n    }\n\n    onGraphChange(graph)\n    {\n        this.attemptBuildMachine(graph, this.getMachine(), this._errors, this._warnings);\n        this._machineChangeHandler.update(this);\n    }\n\n    attemptBuildGraph(machine, dst)\n    {\n        throw new Error('Missing graph build operation');\n    }\n\n    attemptBuildMachine(graph, dst, errors, warnings)\n    {\n        throw new Error('Missing machine build operation');\n    }\n\n    getMachineErrors()\n    {\n        return this._errors;\n    }\n\n    getMachineWarnings()\n    {\n        return this._warnings;\n    }\n\n    getMachineChangeHandler()\n    {\n        return this._machineChangeHandler;\n    }\n\n    isMachineValid()\n    {\n        return this._errors.length <= 0;\n    }\n\n    getMachine()\n    {\n        throw new Error('Missing machine for builder');\n    }\n}\n\nexport default AbstractMachineBuilder;\n","import AbstractGraphLabeler from 'graph2/AbstractGraphLabeler.js';\n\nimport { SYMBOL_SEPARATOR, EMPTY_CHAR } from 'modules/fsa2/graph/element/FSAEdge.js';\n\nconst DEFAULT_NODE_LABEL_PREFIX = 'q';\n\nclass FSAGraphLabeler extends AbstractGraphLabeler\n{\n    constructor()\n    {\n        super();\n\n        this._prefix = DEFAULT_NODE_LABEL_PREFIX;\n        this._graphController = null;\n    }\n\n    setGraphController(graphController)\n    {\n        this._graphController = graphController;\n        return this;\n    }\n\n    setDefaultNodeLabelPrefix(prefix)\n    {\n        this._prefix = prefix;\n    }\n\n    getDefaultNodeLabelPrefix()\n    {\n        return this._prefix;\n    }\n\n    /** @override */\n    getDefaultNodeLabel()\n    {\n        if (!this._graphController.shouldAutoRenameNodes())\n        {\n            return this.getDefaultNodeLabelPrefix();\n        }\n        else\n        {\n            const graph = this._graphController.getGraph();\n            const otherNodes = [];\n            let nodeIndex = 0;\n\n            const startNode = graph.getStartNode();\n            if (startNode && startNode.getNodeCustom()) nodeIndex = 1;\n\n            let newNodeLabel = this.getDefaultNodeLabelPrefix() + nodeIndex;\n            while (graph.getNodesByLabel(newNodeLabel, otherNodes).length > 0)\n            {\n                otherNodes.length = 0;\n                ++nodeIndex;\n                newNodeLabel = this.getDefaultNodeLabelPrefix() + nodeIndex;\n            }\n\n            return newNodeLabel;\n        }\n    }\n\n    /** @override */\n    getDefaultEdgeLabel()\n    {\n        return '';\n    }\n\n    /** @override */\n    getNodeLabelFormatter()\n    {\n        return (string) => string || '';\n    }\n\n    /** @override */\n    getEdgeLabelFormatter()\n    {\n        return edgeLabelFormatter;\n    }\n}\n\nfunction edgeLabelFormatter(string, allowNull = false)\n{\n    const symbols = string.split(SYMBOL_SEPARATOR);\n    const result = new Set();\n\n    let symbol = '';\n    let symbolLength = 0;\n    const length = symbols.length;\n    for (let i = 0; i < length; ++i)\n    {\n        symbol = symbols[i].trim();\n        symbolLength = symbol.length;\n        //If the symbol has none or more than 1 char\n        if (symbolLength !== 1)\n        {\n            //Remove symbol (by not adding to result)\n\n            //Divide multi-char symbol into smaller single char symbols\n            if (symbolLength > 1)\n            {\n                for (let subsymbol of symbol.split(''))\n                {\n                    subsymbol = subsymbol.trim();\n                    if (!result.has(subsymbol))\n                    {\n                        result.add(subsymbol);\n                    }\n                }\n            }\n        }\n        else\n        {\n            result.add(symbol);\n        }\n    }\n\n    //If it is an empty string...\n    if (result.size <= 0) return allowNull ? null : EMPTY_CHAR;\n    return Array.from(result).join(SYMBOL_SEPARATOR);\n}\n\nexport default FSAGraphLabeler;\n","import GraphController from 'graph2/controller/GraphController.js';\n\nimport { GRAPH_EVENT_NODE_EDIT_WHILE_DELETE, GRAPH_EVENT_NODE_DELETE, GRAPH_EVENT_NODE_DELETE_ALL } from 'graph2/inputhandler/GraphNodeInputHandler.js';\nimport { GRAPH_EVENT_EDGE_EDIT_WHILE_DELETE, GRAPH_EVENT_EDGE_DELETE, GRAPH_EVENT_EDGE_CREATE } from 'graph2/inputhandler/GraphEdgeInputHandler.js';\nimport { GRAPH_EVENT_START_MARKER_CHANGE } from 'graph2/inputhandler/IndexedGraphStartMarkerInputHandler.js';\n\nimport { WARNING_LAYOUT_ID } from 'session/manager/notification/NotificationManager.js';\nimport FSAGraphLabeler from './FSAGraphLabeler';\n\nimport { SYMBOL_SEPARATOR } from './element/FSAEdge.js';\n\nexport const TRASH_EDITING_NOTIFICATION_TAG = 'tryCreateWhileTrash';\n\n\n// This really shouldn't be here....\nimport GraphLayout from 'modules/fsa2/GraphLayout.js';\nconst DEFAULT_AUTO_RENAME = true;\nconst NODE_SPAWN_RADIUS = 64;\n\n\nclass FSAGraphController extends GraphController\n{\n    constructor(app, graph, graphParser)\n    {\n        super(graph);\n\n        this._app = app;\n\n        this.setLabelFormatter(new FSAGraphLabeler().setGraphController(this));\n\n\n        // This really shouldn't be here...\n\n        this.shouldAutoLabel = DEFAULT_AUTO_RENAME;\n    }\n\n    /** @override */\n    onGraphEvent(eventName, eventData)\n    {\n        super.onGraphEvent(eventName, eventData);\n\n        switch (eventName)\n        {\n        case GRAPH_EVENT_EDGE_CREATE:\n            formatEdge(this.getGraph(), eventData.target);\n            break;\n        case GRAPH_EVENT_START_MARKER_CHANGE:\n        case GRAPH_EVENT_NODE_DELETE:\n        case GRAPH_EVENT_NODE_DELETE_ALL:\n            if (this.shouldAutoLabel)\n            {\n                this.applyAutoRename();\n            }\n            this._app.getUndoManager().captureEvent();\n            break;\n        case GRAPH_EVENT_NODE_EDIT_WHILE_DELETE:\n        case GRAPH_EVENT_EDGE_EDIT_WHILE_DELETE:\n            this._app.getNotificationManager().pushNotification(\n                I18N.toString('message.warning.cannotmodify'),\n                WARNING_LAYOUT_ID, TRASH_EDITING_NOTIFICATION_TAG, null, true);\n            break;\n        default:\n            this._app.getUndoManager().captureEvent();\n        }\n    }\n\n    getApp() { return this._app; }\n\n    // these really shouldn't be here...\n\n    deleteTargetNodes(targets)\n    {\n        if (!targets || targets.length <= 0) return;\n\n        const graph = this.getGraph();\n        for (const node of targets)\n        {\n            graph.deleteNode(node);\n        }\n\n        //Emit event\n        this.emitGraphEvent(GRAPH_EVENT_NODE_DELETE_ALL, { target: targets });\n    }\n\n    /** @deprecated */\n    getGraphLabeler()\n    {\n        return this.getLabelFormatter();\n    }\n\n    applyAutoLayout()\n    {\n        GraphLayout.applyLayout(this.getGraph());\n\n        this._app.getUndoManager().captureEvent();\n    }\n\n    applyAutoRename()\n    {\n        const graphLabeler = this._labelFormatter;\n        const graph = this._graph;\n\n        if (graph.isEmpty()) return;\n\n        //Reset all default labels...\n        for (const node of graph.getNodes())\n        {\n            if (!node.getNodeCustom()) node.setNodeLabel('');\n        }\n\n        //Rename all default labels appropriately...\n        for (const node of graph.getNodes())\n        {\n            if (!node.getNodeCustom())\n            {\n                node.setNodeLabel(graphLabeler.getDefaultNodeLabel());\n            }\n        }\n    }\n\n    setAutoRenameNodes(enable)\n    {\n        const prev = this.shouldAutoLabel;\n        this.shouldAutoLabel = enable;\n        if (enable && !prev)\n        {\n            this.applyAutoRename();\n        }\n    }\n\n    shouldAutoRenameNodes()\n    {\n        return this.shouldAutoLabel;\n    }\n\n    deleteSelectedNodes(selectedNode)\n    {\n        const selectionBox = this.inputController.getSelectionBox();\n        const selection = selectionBox.getSelection(this.getGraph()).slice();\n\n        //Remove from graph\n        for(const node of selection)\n        {\n            this._graph.deleteNode(node);\n        }\n\n        //Remove from selection\n        selectionBox.clearSelection();\n\n        //Emit event\n        this.emitGraphEvent(GRAPH_EVENT_NODE_DELETE_ALL, { target: selection });\n    }\n\n    deleteTargetNode(target)\n    {\n        this._graph.deleteNode(target);\n\n        //Emit event\n        this.emitGraphEvent(GRAPH_EVENT_NODE_DELETE, { target: target });\n    }\n\n    deleteTargetEdge(target)\n    {\n        this._graph.deleteEdge(target);\n\n        //Emit event\n        this.emitGraphEvent(GRAPH_EVENT_EDGE_DELETE, { target: target });\n    }\n\n    deleteTargetEdges(targets)\n    {\n        if (!targets || targets.length <= 0) return;\n\n        for(const target of targets)\n        {\n            this.deleteTargetEdge(target);\n        }\n    }\n\n    createNode(x, y)\n    {\n        if (typeof x === 'undefined') x = (Math.random() * NODE_SPAWN_RADIUS * 2) - NODE_SPAWN_RADIUS;\n        if (typeof y === 'undefined') y = (Math.random() * NODE_SPAWN_RADIUS * 2) - NODE_SPAWN_RADIUS;\n\n        const node = this._graph.createNode(x, y);\n\n        const newNodeLabel = this.getGraphLabeler().getDefaultNodeLabel();\n        node.setNodeLabel(newNodeLabel);\n\n        this._app.getUndoManager().captureEvent();\n        return node;\n    }\n\n    renameNode(node, newLabel)\n    {\n        node.setNodeLabel(newLabel);\n        node.setNodeCustom(true);\n        this._app.getUndoManager().captureEvent();\n    }\n}\n\n\n//This is more like addEdge() without adding it to the graph and just returns the result\n//This should only be called once when completing an edge\n/** @override */\nfunction formatEdge(graph, edge)\n{\n    const PARALLEL_EDGE_HEIGHT = 16;\n    const edgeSource = edge.getEdgeFrom();\n    const edgeDestination = edge.getEdgeTo();\n    const edgeLabel = edge.getEdgeLabel().split(SYMBOL_SEPARATOR);\n\n    //Look for an existing edge with similar from and to\n    for (const otherEdge of graph.getEdges())\n    {\n        if (otherEdge === edge) continue;\n        if (otherEdge.getEdgeFrom() === edgeSource && otherEdge.getEdgeTo() === edgeDestination)\n        {\n            const otherSymbols = otherEdge.getEdgeSymbolsFromLabel();\n            if (edgeLabel.length > 0)\n            {\n                const result = otherSymbols.concat(edgeLabel);\n                otherEdge.setEdgeLabel(result.join(SYMBOL_SEPARATOR));\n            }\n\n            //Merged with newfound edge...\n            return otherEdge;\n        }\n    }\n\n    //Otherwise, format the current edge\n\n    if (!edge.isSelfLoop())\n    {\n        let flag = false;\n\n        //Bend away if there is another edge not bent with the same src/dst\n        const parallelEdgeHeight = PARALLEL_EDGE_HEIGHT;\n        const HALFPI = Math.PI / 2;\n        for (const otherEdge of graph.getEdges())\n        {\n            if (otherEdge.isQuadratic() && Math.abs(otherEdge.getQuadratic().length) >= parallelEdgeHeight * 2) continue;\n            if ((otherEdge.getEdgeTo() === edgeSource && otherEdge.getEdgeFrom() === edgeDestination))\n            {\n                edge.setQuadraticRadians(HALFPI).setQuadraticLength(parallelEdgeHeight);\n                otherEdge.setQuadraticRadians(HALFPI).setQuadraticLength(parallelEdgeHeight);\n                flag = true;\n\n                //ASSUMES that there will only ever be 2 edges that are parallel...\n                break;\n            }\n        }\n\n        //Try to move the edge away from intersecting nodes...\n        if (!flag)\n        {\n            const maxNodeSize = Math.max(edgeSource.getNodeSize(), edgeDestination.getNodeSize());\n            const x1 = edgeSource.x;\n            const y1 = edgeSource.y;\n            const x2 = edgeDestination.x;\n            const y2 = edgeDestination.y;\n            const dist12sq = (x2 - x1) * (x2 - x1) + (y2 - y1) * (y2 - y1);\n            let vertical = false;\n            let m = 0;\n            let b = 0;\n\n            if (x1 > x2)\n            {\n                m = (y1 - y2) / (x1 - x2);\n                b = y2 - m * x2;\n            }\n            else if (x1 < x2)\n            {\n                m = (y2 - y1) / (x2 - x1);\n                b = y1 - m * x1;\n            }\n            else\n            {\n                vertical = true;\n            }\n\n            for (const node of graph.getNodes())\n            {\n                if (node === edgeSource || node === edgeDestination) continue;\n\n                const x0 = node.x;\n                const y0 = node.y;\n\n                const dist01sq = (x1 - x0) * (x1 - x0) + (y1 - y0) * (y1 - y0);\n                const dist02sq = (x2 - x0) * (x2 - x0) + (y2 - y0) * (y2 - y0);\n                if (dist01sq > dist12sq || dist02sq > dist12sq) continue;\n\n                let dist = 0;\n                if (vertical)\n                {\n                    dist = Math.abs(x1 - x0);\n                }\n                else\n                {\n                    dist = Math.abs(b + m * x0 - y0) / Math.sqrt(1 + m * m);\n                }\n\n                if (dist < node.getNodeSize())\n                {\n                    flag = true;\n                    break;\n                }\n            }\n\n            if (flag)\n            {\n                edge.setQuadraticRadians(-Math.PI / 2);\n                edge.setQuadraticLength(maxNodeSize + 10);\n            }\n        }\n    }\n\n    return edge;\n}\n\nexport default FSAGraphController;","import AbstractMachineBuilder from 'modules/abstract/AbstractMachineBuilder.js';\nimport FSA, { EMPTY_SYMBOL, State } from './FSA.js';\nimport FSANode from 'modules/fsa2/graph/element/FSANode.js';\nimport { SYMBOL_SEPARATOR, EMPTY_CHAR } from 'modules/fsa2/graph/element/FSAEdge.js';\nimport { getUnreachableNodes } from 'graph2/util/NodeGraphUtils.js';\n\nexport const ERROR_UNREACHABLE_STATE = 'unreachable_state';\nexport const ERROR_DUPLICATE_STATE = 'duplicate_state';\nexport const ERROR_INCOMPLETE_TRANSITION = 'incomplete_transition';\nexport const ERROR_DUPLICATE_TRANSITION = 'duplicate_transition';\nexport const ERROR_MISSING_TRANSITION = 'missing_transition';\nexport const ERROR_EMPTY_TRANSITION = 'empty_transition';\n\nclass FSABuilder extends AbstractMachineBuilder\n{\n    constructor()\n    {\n        super();\n\n        this._machine = new FSA();\n    }\n\n    /** @override */\n    attemptBuildGraph(machine, dst)\n    {\n        dst.clear();\n\n        //Add all states\n        const nodeMapping = new Map();\n        let node;\n        for (const state of machine.getStates())\n        {\n            node = dst.createNode(0, 0);\n            node.setNodeLabel(state.getStateLabel());\n            if (machine.isFinalState(state))\n            {\n                node.setNodeAccept(true);\n            }\n            nodeMapping.set(state, node);\n        }\n\n        //Add all transitions\n        let edge, from, to, read;\n        for (let transition of machine.getTransitions())\n        {\n            from = nodeMapping.get(transition.getSourceState());\n            if (!from) continue;\n\n            read = transition.getSymbols().join(' ');\n\n            to = nodeMapping.get(transition.getDestinationState());\n            if (!to) continue;\n\n            edge = dst.createEdge(from, to);\n            edge.setEdgeLabel(read);\n        }\n\n        //Set start state\n        const startState = machine.getStartState();\n\n        let startNodes = dst.getNodesByLabel(startState);\n        if (startNodes && startNodes.length > 0)\n        {\n            dst.setStartNode(startNodes[0]);\n        }\n\n        return dst;\n    }\n\n    /** @override */\n    attemptBuildMachine(graph, dst, errors = [], warnings = [])\n    {\n        errors.length = 0;\n        warnings.length = 0;\n\n        const deterministic = dst.isDeterministic();\n        dst.clear();\n\n        const nodeLabels = new Map();\n        const nodeOutgoings = new Map();\n        const edgeSymbols = new Set();\n        const edgePlaceholders = [];\n        const edgeEmpties = [];\n\n        const graphNodes = graph.getNodes();\n        const graphEdges = graph.getEdges();\n        const graphStart = graph.getStartNode();\n\n        for (const node of graphNodes)\n        {\n            const nodeLabel = node.getNodeLabel();\n            const state = new State(nodeLabel, node);\n            dst.addState(state);\n\n            if (node.getNodeAccept())\n            {\n                dst.setFinalState(state, true);\n            }\n\n            if (graphStart === node)\n            {\n                dst.setStartState(state);\n            }\n\n            //Check for duplicate states\n            if (nodeLabels.has(nodeLabel)) nodeLabels.get(nodeLabel).push(state);\n            else nodeLabels.set(nodeLabel, [state]);\n\n            //For duplicate transitions\n            nodeOutgoings.set(state, new Map());\n        }\n        \n        for (const edge of graphEdges)\n        {\n            const srcNode = edge.getEdgeFrom();\n            const dstNode = edge.getEdgeTo();\n            if (!edge.isPlaceholder() && srcNode instanceof FSANode && dstNode instanceof FSANode)\n            {\n                const srcState = dst.getStateByID(srcNode.getGraphElementID());\n                const dstState = dst.getStateByID(dstNode.getGraphElementID());\n                if (!srcState || !dstState) throw new Error('Cannot find state for edge source/destination nodes - mismatch id');\n\n                const edgeLabelSymbols = edge.getEdgeLabel().split(SYMBOL_SEPARATOR);\n                for (const symbol of edgeLabelSymbols)\n                {\n                    if (!symbol) continue;\n\n                    if (symbol === EMPTY_CHAR)\n                    {\n                        //For empties\n                        edgeEmpties.push(edge);\n                    }\n                    else\n                    {\n                        //For used symbol\n                        edgeSymbols.add(symbol);\n                    }\n\n                    //Translate all labels to symbols\n                    let transitionSymbol;\n                    switch (symbol)\n                    {\n                    case EMPTY_CHAR:\n                        transitionSymbol = EMPTY_SYMBOL;\n                        break;\n                    default:\n                        transitionSymbol = symbol;\n                    }\n\n                    //For duplicate/missing transitions\n                    let outSymbols = nodeOutgoings.get(srcState);\n                    let outEdges = outSymbols.get(transitionSymbol);\n                    if (!outEdges) outSymbols.set(transitionSymbol, outEdges = new Array());\n                    outEdges.push(edge);\n\n                    //Add to machine...\n                    dst.addTransition(srcState, dstState, transitionSymbol);\n                }\n            }\n            else\n            {\n                edgePlaceholders.push(edge);\n                continue;\n            }\n        }\n\n        //Check for duplicate node labels\n        for (const [nodeLabel, sharedStates] of nodeLabels.entries())\n        {\n            if (sharedStates.length > 1)\n            {\n                errors.push({\n                    name: ERROR_DUPLICATE_STATE,\n                    label: nodeLabel,\n                    nodes: sharedStates.map(e => e.getSource())\n                });\n            }\n        }\n\n        //Check for incomplete edge\n        if (edgePlaceholders.length > 0)\n        {\n            errors.push({\n                name: ERROR_INCOMPLETE_TRANSITION,\n                edges: edgePlaceholders\n            });\n        }\n\n        //Check for unreachable nodes\n        const unreachables = getUnreachableNodes(graph);\n        if (unreachables && unreachables.length > 0)\n        {\n            warnings.push({\n                name: ERROR_UNREACHABLE_STATE,\n                nodes: unreachables\n            });\n        }\n\n        if (deterministic)\n        {\n            //Check for empty transitions\n            if (edgeEmpties.length > 0)\n            {\n                errors.push({\n                    name: ERROR_EMPTY_TRANSITION,\n                    edges: edgeEmpties\n                });\n            }\n\n            //Check for duplicate edge labels\n            //Check for missing edge labels\n            const missingSymbols = [];\n            for (const [state, edgeMapping] of nodeOutgoings.entries())\n            {\n                for (const symbol of edgeSymbols)\n                {\n                    const edges = edgeMapping.get(symbol);\n                    if (edges)\n                    {\n                        if (edges.length !== 1)\n                        {\n                            errors.push({\n                                name: ERROR_DUPLICATE_TRANSITION,\n                                edges: edges,\n                                symbol: symbol\n                            });\n                        }\n                    }\n                    else\n                    {\n                        missingSymbols.push(symbol);\n                    }\n                }\n\n                if (missingSymbols.length > 0)\n                {\n                    errors.push({\n                        name: ERROR_MISSING_TRANSITION,\n                        node: state.getSource(),\n                        symbols: missingSymbols.slice()\n                    });\n                    missingSymbols.length = 0;\n                }\n            }\n        }\n\n        if (errors.length <= 0)\n        {\n            //Errors should be empty\n            return dst;\n        }\n        else\n        {\n            //Reasons are stored in errors\n            return null;\n        }\n    }\n\n    /** @override */\n    getMachine()\n    {\n        return this._machine;\n    }\n}\n\n//Representations ->\n//Truth\n\n//MachineBuilder\n//Graph -> Machine (Compile, then return errors)\n//Any changes to graph does not warrant a change to machine\n//Machine Changes -> Graph (Apply them as they happen)\n//Any change to machine does.\n//Machine Conversion -> Graph (Reconstruct the entire graph from machine, then apply layout)\n\nexport default FSABuilder;","import AbstractMachineController from 'modules/abstract/AbstractMachineController.js';\n\nimport FSABuilder from 'modules/fsa2/machine/FSABuilder.js';\nimport { convertToDFA, invertDFA } from 'modules/fsa2/machine/FSAUtils.js';\n\nimport GraphLayout from 'modules/fsa2/GraphLayout.js';\n\nclass MachineController extends AbstractMachineController\n{\n    constructor(module)\n    {\n        super(module, new FSABuilder());\n\n        this.graphController = null;\n    }\n\n    /** @override */\n    initialize(module)\n    {\n        super.initialize(module);\n\n        this.graphController = module.getGraphController();\n    }\n\n    /** @override */\n    destroy(module)\n    {\n        super.destroy(module);\n    }\n\n    /** @override */\n    update(module)\n    {\n        super.update(module);\n    }\n\n    getMachineType()\n    {\n        return this._machineBuilder.getMachine().isDeterministic() ? 'DFA' : 'NFA';\n    }\n\n    setMachineType(machineType)\n    {\n        this._machineBuilder.getMachine().setDeterministic(machineType === 'DFA');\n    }\n\n    changeMachineTo(machineType)\n    {\n        const prev = this.getMachineType();\n        if (prev != machineType)\n        {\n            this.setMachineType(machineType);\n        }\n    }\n\n    getFirstGraphNodeByLabel(graph, label)\n    {\n        for(const node of graph.getNodes())\n        {\n            if (node.getNodeLabel() == label)\n            {\n                return node;\n            }\n        }\n\n        return null;\n    }\n\n    setGraphToMachine(graph, machine)\n    {\n        this._machineBuilder.attemptBuildGraph(machine, graph);\n        //Auto layout graph\n        GraphLayout.applyLayout(graph);\n    }\n\n    convertMachineTo(machineType)\n    {\n        const currentMachineType = this.getMachineType();\n\n        //Already converted machine...\n        if (currentMachineType === machineType) return;\n\n        if (machineType == 'DFA' && currentMachineType == 'NFA')\n        {\n            const result = convertToDFA(this.getMachineBuilder().getMachine());\n            this.setGraphToMachine(this.graphController.getGraph(), result);\n            this.setMachineType(machineType);\n        }\n        else if (machineType == 'NFA' && currentMachineType == 'DFA')\n        {\n            this.changeMachineTo(machineType);\n        }\n        else\n        {\n            throw new Error('Conversion scheme between \\'' + currentMachineType + '\\' to \\'' + machineType + '\\' is not supported');\n        }\n    }\n\n    invertMachine()\n    {\n        const machine = this.getMachineBuilder().getMachine();\n        const result = invertDFA(machine, machine);\n\n        //Update final states\n        for(const state of result.getStates())\n        {\n            const src = state.getSource();\n            src.setNodeAccept(machine.isFinalState(state));\n        }\n    }\n\n    getStates()\n    {\n        return this._machineBuilder.getMachine().getStates();\n    }\n\n    countStates()\n    {\n        return this._machineBuilder.getMachine().getStateCount();\n    }\n\n    getFinalStates()\n    {\n        return this._machineBuilder.getMachine().getFinalStates();\n    }\n\n    getTransitions()\n    {\n        return this._machineBuilder.getMachine().getTransitions();\n    }\n\n    getAlphabet()\n    {\n        const machine = this._machineBuilder.getMachine();\n        return Array.from(machine.getAlphabet());\n    }\n\n    isUsedSymbol(symbol)\n    {\n        return !this.isCustomSymbol(symbol);\n    }\n\n    createSymbol(symbol)\n    {\n        this.addCustomSymbol(symbol);\n    }\n\n    deleteSymbol(symbol)\n    {\n        let edge = null;\n        let index = null;\n        let result = null;\n        const targets = [];\n\n        const graph = this.graphController.getGraph();\n        for(let i = graph.getEdges().length - 1; i >= 0; --i)\n        {\n            edge = graph.getEdges()[i];\n            index = edge.getEdgeLabel().indexOf(symbol);\n            if (index >= 0)\n            {\n                result = edge.getEdgeLabel().substring(0, index) + edge.getEdgeLabel().substring(index + 1);\n                if (result.length > 0)\n                {\n                    edge.setEdgeLabel(result);\n                }\n                else\n                {\n                    edge.setEdgeLabel('');\n                    graph.deleteEdge(edge);\n                }\n                targets.push(edge);\n            }\n        }\n\n        if (targets.length <= 0)\n        {\n            this.getMachineBuilder().removeCustomSymbol(symbol);\n        }\n    }\n\n    renameSymbol(prevSymbol, nextSymbol)\n    {\n        let edge = null;\n        let result = null;\n        const targets = [];\n\n        const graph = this.graphController.getGraph();\n        const length = graph.getEdges().length;\n        for(let i = 0; i < length; ++i)\n        {\n            edge = graph.getEdges()[i];\n            result = edge.getEdgeLabel().replace(prevSymbol, nextSymbol);\n            if (result != edge.getEdgeLabel())\n            {\n                targets.push(edge);\n            }\n            edge.setEdgeLabel(result);\n        }\n\n        if (targets.length <= 0)\n        {\n            this.getMachineBuilder().renameCustomSymbol(prevSymbol, nextSymbol);\n        }\n    }\n\n    getCustomSymbols()\n    {\n        return Array.from(this._machineBuilder.getMachine().getCustomSymbols());\n    }\n\n    isCustomSymbol(symbol)\n    {\n        return this._machineBuilder.isCustomSymbol(symbol);\n    }\n\n    addCustomSymbol(symbol)\n    {\n        this._machineBuilder.getMachine().setCustomSymbol(symbol);\n    }\n\n    clearCustomSymbols()\n    {\n        this._machineBuilder.getMachine().clearCustomSymbols();\n    }\n}\n\nexport default MachineController;\n","import Eventable from 'util/Eventable.js';\n\nimport { solveFSAByStep } from 'modules/fsa2/machine/FSAUtils.js';\n\nimport TapeContext from './TapeContext.js';\n\nclass TestTapeContext extends TapeContext\n{\n    constructor(tester, graphController, machineController)\n    {\n        super(tester.getTestString(), false, true);\n\n        this._tester = tester;\n        this._graphController = graphController;\n        this._machineController = machineController;\n    }\n\n    /** @override */\n    stepForward()\n    {\n        const graphController = this._graphController;\n        const machineController = this._machineController;\n        this._tester.stepForward(graphController, machineController);\n    }\n\n    /** @override */\n    stepBackward()\n    {\n        const graphController = this._graphController;\n        const machineController = this._machineController;\n        this._tester.stepBackward(graphController, machineController);\n    }\n\n    /** @override */\n    reset()\n    {\n        this._tester.resetPosition();\n    }\n\n    /** @override */\n    finish()\n    {\n        const graphController = this._graphController;\n        const machineController = this._machineController;\n        this._tester.runTest(graphController, machineController, false);\n    }\n\n    /** @override */\n    stop()\n    {\n        this._tester.stopTest();\n    }\n\n    /** @override */\n    changeTapeSymbol(index, symbol='')\n    {\n        throw new Error('Operation not yet supported');\n    }\n\n    /** @override */\n    getTapeSourceStatesByIndex(index)\n    {\n        if (index < 0 || index >= this._tapeInput.length) return null;\n        return this._tester.getNodesAtPosition(index);\n    }\n\n    /** @override */\n    getTapeSymbolByIndex(index)\n    {\n        if (index < 0 || index >= this._tapeInput.length) return [];\n        return this._tapeInput[index] || '';\n    }\n\n    /** @override */\n    setCurrentTapeIndex(index)\n    {\n        this._tester.changePosition(index);\n    }\n\n    /** @override */\n    getCurrentTapeIndex()\n    {\n        return this._tester.getPosition();\n    }\n}\n\nclass StringTester\n{\n    constructor()\n    {\n        this._testString = null;\n        this._testIndex = -1;\n\n        this._tapeContext = null;\n\n        //For nfa solver use\n        this._cachePath = [];\n        this._cachedResult = null;\n        this._resolve = null;\n        this._reject = null;\n\n        this.registerEvent('startTest');\n        this.registerEvent('stepTest');\n        this.registerEvent('stopTest');\n    }\n\n    //TODO: a hack to get current targets.\n    get targets()\n    {\n        if (this._cachePath.length <= 0) return [];\n        const cache = this._cachePath[this._cachePath.length - 1];\n        return cache.targets;\n    }\n\n    startTest(testString, graphController, machineController)\n    {\n        if (!testString) testString = '';\n        if (this._tapeContext) throw new Error('Unable to start an already running test');\n\n        const graph = graphController.getGraph();\n        if (graph.isEmpty()) return Promise.reject();\n\n        this._testString = testString;\n        this._testIndex = -1;\n        this._cachePath.length = 0;\n        this._cachedResult = null;\n        this._tapeContext = new TestTapeContext(this, graphController, machineController);\n\n        this.emit('startTest', this);\n\n        return new Promise((resolve, reject) => \n        {\n            this._resolve = resolve;\n            this._reject = reject;\n        });\n    }\n\n    stopTest()\n    {\n        if (!this._tapeContext) throw new Error('Unable to stop null test');\n\n        this.emit('stopTest', this);\n\n        if (!this._resolve) throw new Error('Must call startTest() before anything else');\n        if (!this._reject) throw new Error('Must call startTest() before anything else');\n\n        let testResult = null;\n        if (this._cachePath.length >= this._testString.length)\n        {\n            testResult = this._cachedResult;\n            this._resolve(testResult);\n        }\n        else\n        {\n            testResult = null;\n            this._reject();\n        }\n\n        this._testString = null;\n        this._testIndex = -1;\n        this._cachePath.length = 0;\n        this._cachedResult = null;\n        this._tapeContext = null;\n\n        return Promise.resolve(testResult);\n    }\n\n    runTest(graphController, machineController, thenStop=false)\n    {\n        if (!this._tapeContext) throw new Error('Unable to run null test');\n\n        return new Promise((resolve, reject) => \n        {\n            let result = false;\n            do\n            {\n                result = this.stepForward(graphController, machineController, !thenStop);\n            }\n            while (result);\n\n            resolve(this._cachedResult);\n        }).then((result) => \n        {\n            if (thenStop) return this.stopTest();\n            else return result;\n        });\n    }\n\n    stepForward(graphController, machineController, cacheStep=true)\n    {\n        const machine = machineController.getMachineBuilder().getMachine();\n\n        if (this._testIndex >= this._testString.length) return false;\n        ++this._testIndex;\n\n        if (this._cachePath.length <= this._testIndex)\n        {\n            //Calculate current step...\n            let cachedStates, cachedSymbols = null;\n            const isResult = this._testIndex === this._testString.length;\n\n            //Initialize first step...\n            if (this._testIndex <= 0)\n            {\n                cachedStates = [];\n                cachedSymbols = [];\n\n                const startState = machine.getStartState();\n                for (const currentState of machine.doClosureTransition(startState))\n                {\n                    cachedStates.push({state: currentState, index: 0});\n                }\n            }\n            else\n            {\n                const prevCache = this._cachePath[this._testIndex - 1];\n                cachedStates = prevCache.states.slice();\n                cachedSymbols = prevCache.symbols.slice();\n\n                //Do the remaining steps...\n                const nextSymbol = this._testString[this._testIndex - 1];\n                solveFSAByStep(machine, nextSymbol, cachedStates, cachedSymbols);\n            }\n\n            //Do one last step for result...\n            if (isResult)\n            {\n                this._cachedResult = solveFSAByStep(machine, null, cachedStates, cachedSymbols);\n            }\n\n            //Store current step...\n            const targets = new Set();\n            for(const cachedState of cachedStates)\n            {\n                const node = cachedState.state.getSource();\n\n                //Couldn't find the node that was solved for this step...\n                if (!node) throw new Error('Could not find node \\'' + cachedState.state + '\\'');\n\n                targets.add(node);\n            }\n            const nextCache = {\n                targets: Array.from(targets),\n                states: cachedStates,\n                symbols: cachedSymbols\n            };\n            this._cachePath.push(nextCache);\n        }\n        else\n        {\n            //Go forward a previously calculated step...by doing nothing...\n        }\n\n        this.emit('stepTest');\n        return true;\n    }\n\n    stepBackward(graphController, machineController)\n    {\n        if (this._testIndex <= 0) return false;\n        --this._testIndex;\n\n        //Go back a step...by doing nothing...\n        this.emit('stepTest');\n        return true;\n    }\n\n    isTesting()\n    {\n        return this._testString !== null;\n    }\n\n    changePosition(position)\n    {\n        if (position >= this._cachePath.length)\n        {\n            this._testIndex = this._cachePath.length - 1;\n        }\n        else\n        {\n            if (position < 0)\n            {\n                this._testIndex = 0;\n            }\n            else if (position >= this._testString.length)\n            {\n                this._testIndex = this._testString.length - 1;\n            }\n            else\n            {\n                this._testIndex = position;\n            }\n        }\n    }\n\n    resetPosition()\n    {\n        this._testIndex = -1;\n    }\n\n    getPosition()\n    {\n        return this._testIndex;\n    }\n\n    isComputedPosition(position)\n    {\n        return this._cachePath.length > position;\n    }\n\n    getCurrentNodes()\n    {\n        if (this._testIndex >= 0 && this._testIndex < this._cachePath.length)\n        {\n            return this._cachePath[this._testIndex];\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    getNodesAtPosition(position)\n    {\n        if (position >= 0 && position < this._cachePath.length)\n        {\n            return this._cachePath[position].targets;\n        }\n        else\n        {\n            return null;\n        }\n    }\n\n    getTestString()\n    {\n        return this._testString;\n    }\n\n    getTapeContext()\n    {\n        return this._tapeContext;\n    }\n}\nEventable.mixin(StringTester);\n\nexport default StringTester;\n","class TapeContext\n{\n    constructor(inputString, infiniteLeft=false, infiniteRight=false)\n    {\n        this._tapeInput = inputString ? inputString.split('') : [];\n        this._left = infiniteLeft;\n        this._right = infiniteRight;\n\n        this._index = 0;\n    }\n\n    stepForward()\n    {\n        ++this._index;\n    }\n\n    stepBackward()\n    {\n        --this._index;\n    }\n\n    finish()\n    {\n        this._index = (this._tapeInput.length * 2);\n    }\n\n    reset()\n    {\n        this._index = -1;\n    }\n\n    stop()\n    {\n        this.finish();\n        this.reset();\n    }\n\n    changeTapeSymbol(index, symbol='')\n    {\n        this._tapeInput[index] = symbol;\n    }\n\n    getTapeSourceStatesByIndex(index)\n    {\n        return null;\n    }\n\n    getTapeSymbolByIndex(index)\n    {\n        if (index < 0 || index >= this._tapeInput.length) return '';\n        return this._tapeInput[index] || '';\n    }\n\n    isTapeLeftInfinite()\n    {\n        return this._left;\n    }\n\n    isTapeRightInfinite()\n    {\n        return this._right;\n    }\n\n    setCurrentTapeIndex(index)\n    {\n        this._index = index;\n    }\n\n    getCurrentTapeIndex()\n    {\n        return this._index;\n    }\n\n    getTapeInput()\n    {\n        return this._tapeInput;\n    }\n}\n\nexport default TapeContext;\n","import React from 'react';\nimport DefaultNotificationLayout, { STYLE_TYPE_WARNING } from 'session/manager/notification/components/DefaultNotificationLayout.js';\n\n// TODO: specify what the class does\nclass NFAToDFAConversionNotificationLayout extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(e)\n    {\n        const notification = this.props.notification;\n        // TODO: specify what e is\n        switch (e.target.value)\n        {\n        case 'convert':\n            {\n                //FIXME: FSABUILDER: convertMachineTo needs to change?\n                const machineController = this.props.machineController;\n                machineController.convertMachineTo('DFA');\n                notification.close();\n            }\n            break;\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        // TODO: clarify machineController?\n        const machineController = this.props.machineController;\n        const stateCount = machineController.countStates();\n\n        return (\n            <DefaultNotificationLayout id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                styleType={STYLE_TYPE_WARNING}\n                notification={this.props.notification}>\n                <p>{I18N.toString('message.warning.convertNFAToDFA')}</p>\n                <p>{`${stateCount} states -> ${Math.pow(2, stateCount)} states`}</p>\n                <button value=\"convert\" onClick={this.onClick}>\n                    {I18N.toString('message.action.convert')}\n                </button>\n            </DefaultNotificationLayout>\n        );\n    }\n}\n\nexport default NFAToDFAConversionNotificationLayout;\n","import React from 'react';\nimport DefaultNotificationLayout, { STYLE_TYPE_ERROR }\n    from 'session/manager/notification/components/DefaultNotificationLayout.js';\n\n/**\n * A class representing the layout for a notification referring to states\n */\nclass StateNotificationLayout extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._targetIndex = 0;\n        this._targetLabel = '';\n        const targets = props.message.targets;\n        for (const target of targets)\n        {\n            if (this._targetLabel.length > 0)\n            {\n                this._targetLabel += ', ';\n            }\n            // TODO: make a helper function for this type of constructor\n            this._targetLabel += target.getNodeLabel();\n        }\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    /**\n     * Handles onclick events for the buttons\n     * \n     * @param {Event} e the input event\n     */\n    onClick(e)\n    {\n        const notification = this.props.notification;\n        const message = this.props.message;\n        const app = this.props.app;\n\n        const graphController = this.props.graphController;\n\n        switch (e.target.value)\n        {\n        // Cycle through all of the targets and center the viewport on it\n        case 'locate':\n            {\n                const targets = message.targets;\n                const targetLength = targets.length;\n                if (targetLength > 0 && this._targetIndex < targetLength)\n                {\n                    // Locate the target edge\n                    const target = targets[this._targetIndex++];\n                    if (this._targetIndex >= targetLength) this._targetIndex = 0;\n\n                    // Move pointer to target\n                    const graphView = app.getSession().getCurrentModule().getGraphView();\n                    graphView.moveViewToPosition(target.x, target.y);\n                }\n            }\n            break;\n            // Delete all targets\n        case 'deleteall':\n            {\n                const targets = message.targets;\n                // Delete all target nodes\n                graphController.deleteTargetNodes(targets);\n\n                // Sort the nodes after deleting if enabled...\n                graphController.applyAutoRename();\n\n                // Exit the message\n                notification.close();\n            }\n            break;\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const message = this.props.message;\n\n        // TODO: localization issues\n        return (\n            <DefaultNotificationLayout id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                styleType={STYLE_TYPE_ERROR}\n                notification={this.props.notification}>\n                <p>{message.text + ': ' + this._targetLabel}</p>\n                <button value=\"locate\" onClick={this.onClick}>\n                    {I18N.toString('message.action.locate')}\n                </button>\n                <button value=\"deleteall\" onClick={this.onClick}>\n                    {I18N.toString('message.action.deleteall')}\n                </button>\n            </DefaultNotificationLayout>\n        );\n    }\n}\n\nexport default StateNotificationLayout;\n","import React from 'react';\nimport DefaultNotificationLayout, { STYLE_TYPE_ERROR } from 'session/manager/notification/components/DefaultNotificationLayout.js';\nimport GraphNode from 'graph2/element/GraphNode.js';\n\nconst ARROW = '\\u2192';\n\nclass TransitionNotificationLayout extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.targetIndex = 0;\n        this.targetLabel = '';\n        const targets = props.message.targets;\n        for (const target of targets)\n        {\n            if (this.targetLabel.length > 0)\n            {\n                this.targetLabel += ', ';\n            }\n            this.targetLabel += '(' + target.getEdgeFrom().getNodeLabel() + ', ' +\n                target.getEdgeLabel() + ') ' +\n                ARROW + ' ' + (target.getEdgeTo() instanceof GraphNode ? target.getEdgeTo().getNodeLabel() : 'null');\n        }\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(e)\n    {\n        const notification = this.props.notification;\n        const message = this.props.message;\n        const app = this.props.app;\n\n        const graphController = this.props.graphController;\n\n        switch (e.target.value)\n        {\n        case 'locate':\n            {\n                const targets = message.targets;\n                const targetLength = targets.length;\n                if (targetLength > 0 && this.targetIndex < targetLength)\n                {\n                    //Locate the target edge\n                    const target = targets[this.targetIndex++];\n                    if (this.targetIndex >= targetLength) this.targetIndex = 0;\n\n                    //Move pointer to target\n                    const graphView = app.getSession().getCurrentModule().getGraphView();\n                    const center = target.getCenterPoint();\n                    graphView.moveViewToPosition(center.x, center.y);\n                }\n            }\n            break;\n        case 'deleteall':\n            {\n                const targets = message.targets;\n                //Delete all target edges\n                graphController.deleteTargetEdges(targets);\n\n                //Exit the message\n                notification.close();\n            }\n            break;\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        // const message = this.props.message;\n\n        return (\n            <DefaultNotificationLayout id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                styleType={STYLE_TYPE_ERROR}\n                notification={this.props.notification}>\n                <p>{this.props.message.text + ': ' + this.targetLabel}</p>\n                <button value=\"locate\" onClick={this.onClick}>\n                    {I18N.toString('message.action.locate')}\n                </button>\n                <button value=\"deleteall\" onClick={this.onClick}>\n                    {I18N.toString('message.action.deleteall')}\n                </button>\n            </DefaultNotificationLayout>\n        );\n    }\n}\n\nexport default TransitionNotificationLayout;\n","import React from 'react';\nimport DefaultNotificationLayout, { STYLE_TYPE_ERROR } from 'session/manager/notification/components/DefaultNotificationLayout.js';\n\n// TODO: add @see for usage\nclass StateMissingTransitionNotificationLayout extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        // TODO: check to see if these variables are used elsewhere; otherwise make it private\n        this.targetIndex = 0;\n        this.targetLabel = '';\n        // TODO: clarify what target is, specify type\n        const targets = props.message.targets;\n        for (const target of targets)\n        {\n            if (this.targetLabel.length > 0)\n            {\n                this.targetLabel += ', ';\n            }\n            this.targetLabel += target.getNodeLabel();\n        }\n        // TODO: fix \"for\" - not language compatible\n        this.targetLabel += ' for ' + props.message.symbol;\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(e)\n    {\n        // const notification = this.props.notification;\n        const message = this.props.message;\n        const app = this.props.app;\n        \n        switch (e.target.value)\n        {\n        case 'locate':\n            {\n                const targets = message.targets;\n                const targetLength = targets.length;\n                if (targetLength > 0 && this.targetIndex < targetLength)\n                {\n                    //Locate the target edge\n                    const target = targets[this.targetIndex++];\n                    if (this.targetIndex >= targetLength) this.targetIndex = 0;\n\n                    //Move pointer to target\n                    const graphView = app.getSession().getCurrentModule().getGraphView();\n                    graphView.moveViewToPosition(target.x, target.y);\n                }\n            }\n            break;\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        // TODO: I18N - look out for localization\n        return (\n            <DefaultNotificationLayout id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                styleType={STYLE_TYPE_ERROR}\n                notification={this.props.notification}>\n                <p>{I18N.toString('message.error.missing') + ': ' + this.targetLabel}</p>\n                <button value=\"locate\" onClick={this.onClick}>\n                    {I18N.toString('message.action.locate')}\n                </button>\n            </DefaultNotificationLayout>\n        );\n    }\n}\n\nexport default StateMissingTransitionNotificationLayout;\n","import React from 'react';\nimport DefaultNotificationLayout, { STYLE_TYPE_WARNING } from 'session/manager/notification/components/DefaultNotificationLayout.js';\n\nclass StateUnreachableNotificationLayout extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.targetIndex = 0;\n        this.targetLabel = '';\n        const targets = props.message;\n        for (const target of targets)\n        {\n            if (this.targetLabel.length > 0)\n            {\n                this.targetLabel += ', ';\n            }\n            this.targetLabel += target.getNodeLabel();\n        }\n\n        this.onClick = this.onClick.bind(this);\n    }\n\n    onClick(e)\n    {\n        const notification = this.props.notification;\n        const message = this.props.message;\n        const app = this.props.app;\n        const graphController = this.props.graphController;\n\n        switch (e.target.value)\n        {\n        case 'locate':\n            {\n                //Locate the target node\n                const target = message[this.targetIndex++];\n                if (this.targetIndex >= message.length)\n                {\n                    this.targetIndex = 0;\n                }\n\n                //Move pointer to target\n                const graphView = app.getSession().getCurrentModule().getGraphView();\n                graphView.moveViewToPosition(target.x, target.y);\n            }\n            break;\n        case 'deleteall':\n            {\n                const targets = message;\n                //Delete all target nodes\n                graphController.deleteTargetNodes(targets);\n\n                //Sort the nodes after deleting if enabled...\n                graphController.applyAutoRename();\n\n                //Exit the message\n                notification.close();\n            }\n            break;\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        return (\n            <DefaultNotificationLayout id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                styleType={STYLE_TYPE_WARNING}\n                notification={this.props.notification}>\n                <p>{I18N.toString('message.warning.unreachable') + ': ' + this.targetLabel}</p>\n                <button value=\"locate\" onClick={this.onClick}>\n                    {I18N.toString('message.action.locate')}\n                </button>\n                <button value=\"deleteall\" onClick={this.onClick}>\n                    {I18N.toString('message.action.deleteall')}\n                </button>\n            </DefaultNotificationLayout>\n        );\n    }\n}\n\nexport default StateUnreachableNotificationLayout;\n","import NFAToDFAConversionNotificationLayout from './NFAToDFAConversionNotificationLayout.js';\nexport const MACHINE_CONVERSION_LAYOUT_ID = 'machine-convert';\nexport const MACHINE_CONVERSION_NOTIFICATION_TAG = 'machine-convert';\n\nimport StateNotificationLayout from './StateNotificationLayout.js';\nexport const STATE_LAYOUT_ID = 'machine-state';\n\nimport TransitionNotificationLayout from './TransitionNotificationLayout.js';\nexport const TRANSITION_LAYOUT_ID = 'machine-transition';\n\nimport StateMissingTransitionNotificationLayout from './StateMissingTransitionNotificationLayout.js';\nexport const STATE_MISSING_LAYOUT_ID = 'machine-state-missing';\n\nimport StateUnreachableNotificationLayout from './StateUnreachableNotificationLayout.js';\nexport const STATE_UNREACHABLE_LAYOUT_ID = 'machine-state-unreachable';\n\nexport const MACHINE_ERROR_NOTIFICATION_TAG = 'machine-error';\n\nexport function registerNotifications(notificationManager)\n{\n    notificationManager.registerNotificationLayout(MACHINE_CONVERSION_LAYOUT_ID, NFAToDFAConversionNotificationLayout);\n    notificationManager.registerNotificationLayout(STATE_MISSING_LAYOUT_ID, StateMissingTransitionNotificationLayout);\n    notificationManager.registerNotificationLayout(STATE_UNREACHABLE_LAYOUT_ID, StateUnreachableNotificationLayout);\n    notificationManager.registerNotificationLayout(STATE_LAYOUT_ID, StateNotificationLayout);\n    notificationManager.registerNotificationLayout(TRANSITION_LAYOUT_ID, TransitionNotificationLayout);\n}\n","import { SUCCESS_LAYOUT_ID } from 'session/manager/notification/NotificationManager.js';\nimport\n{\n    MACHINE_ERROR_NOTIFICATION_TAG,\n    STATE_LAYOUT_ID,\n    TRANSITION_LAYOUT_ID,\n    STATE_UNREACHABLE_LAYOUT_ID,\n    STATE_MISSING_LAYOUT_ID\n} from './components/notifications/FSANotifications.js';\n\nimport\n{\n    ERROR_UNREACHABLE_STATE,\n    ERROR_DUPLICATE_STATE,\n    ERROR_INCOMPLETE_TRANSITION,\n    ERROR_DUPLICATE_TRANSITION,\n    ERROR_MISSING_TRANSITION,\n    ERROR_EMPTY_TRANSITION\n} from './machine/FSABuilder.js';\n\nclass FSAErrorChecker\n{\n    constructor(app, graphController, machineController)\n    {\n        this._app = app;\n        this._graphController = graphController;\n        this._machineController = machineController;\n        this._showErrorOnChange = false;\n\n        this.onMachineChange = this.onMachineChange.bind(this);\n\n        machineController.getMachineBuilder().getMachineChangeHandler().addListener(this.onMachineChange);\n    }\n\n    onMachineChange(machineBuilder)\n    {\n        if (this._showErrorOnChange)\n        {\n            this.showErrors();\n        }\n    }\n\n    setErrorChecking(enabled)\n    {\n        this._showErrorOnChange = enabled;\n    }\n\n    isErrorChecking()\n    {\n        return this._showErrorOnChange;\n    }\n\n    showErrors()\n    {\n        const props = {\n            graphController: this._graphController,\n            machineController: this._machineController,\n            app: this._app\n        };\n        const machineBuilder = this._machineController.getMachineBuilder();\n        const errors = machineBuilder.getMachineErrors();\n        const warnings = machineBuilder.getMachineWarnings();\n        const app = this._app;\n        const notificationManager = app.getNotificationManager();\n\n        notificationManager.clearNotifications(MACHINE_ERROR_NOTIFICATION_TAG);\n        if (errors.length <= 0 && warnings.length <= 0)\n        {\n            notificationManager.pushNotification(\n                I18N.toString('message.error.none'),\n                SUCCESS_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, null, false);\n        }\n        else\n        {\n            for (const warning of warnings)\n            {\n                switch (warning.name)\n                {\n                case ERROR_UNREACHABLE_STATE:\n                    notificationManager.pushNotification(warning.nodes,\n                        STATE_UNREACHABLE_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                }\n            }\n\n            for (const error of errors)\n            {\n                switch (error.name)\n                {\n                case ERROR_DUPLICATE_STATE:\n                    notificationManager.pushNotification({\n                        text: 'Found duplicate nodes of similar names',\n                        targets: error.nodes\n                    }, STATE_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                case ERROR_INCOMPLETE_TRANSITION:\n                    notificationManager.pushNotification({\n                        text: I18N.toString('message.error.incomplete'),\n                        targets: error.edges\n                    }, TRANSITION_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                case ERROR_DUPLICATE_TRANSITION:\n                    notificationManager.pushNotification({\n                        text: I18N.toString('message.error.dupe'),\n                        targets: error.edges\n                    }, TRANSITION_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                case ERROR_MISSING_TRANSITION:\n                    notificationManager.pushNotification({\n                        targets: [error.node],\n                        symbol: error.symbols\n                    }, STATE_MISSING_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                case ERROR_EMPTY_TRANSITION:\n                    notificationManager.pushNotification({\n                        text: I18N.toString('message.error.empty'),\n                        targets: error.edges\n                    }, TRANSITION_LAYOUT_ID, MACHINE_ERROR_NOTIFICATION_TAG, props, false);\n                    break;\n                }\n            }\n        }\n    }\n}\n\nexport default FSAErrorChecker;\n","import SessionImporter from 'session/SessionImporter.js';\n\n/**\n * A class that represents a session importer for the FSA module.\n */\nclass FSAImporter extends SessionImporter\n{\n    constructor(app, jsonGraphParser)\n    {\n        super(app);\n\n        this._graphParser = jsonGraphParser;\n        this._prevGraphHash = 0;\n    }\n\n    /** @override */\n    onParseSession(session, fileData)\n    {\n        return JSON.parse(fileData);\n    }\n\n    /** @override */\n    onPreImportSession(session)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n        this._prevGraphHash = graph.getHashCode(true);\n\n        // TODO: this should not be here, this should exist somewhere in graphController\n        if (!graph.isEmpty())\n        {\n            session.getApp().getUndoManager().captureEvent();\n        }\n    }\n\n    /** @override */\n    onImportSession(session, sessionData)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const machineController = currentModule.getMachineController();\n        const graph = graphController.getGraph();\n\n        this._graphParser.parse(sessionData['graphData'], graph);\n\n        loadMachineFromData(graphController, machineController, sessionData['machineData']);\n    }\n\n    /** @override */\n    onPostImportSession(session)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n\n        // Compares the graph hash before and after import, captures event if they are not equal\n        const nextGraphHash = graph.getHashCode(true);\n        if (this._prevGraphHash !== nextGraphHash)\n        {\n            // TODO: this should not be here\n            session.getApp().getUndoManager().captureEvent();\n        }\n    }\n}\n\n/**\n * Sets all of the details pertaining to the module (and the machine)\n *\n * @private\n * @param  {GraphController} graphController        the controller for the graph to be constructed\n * @param  {MachineController} machineController    the controller for the machine to be constructed\n * @param  {Object} machineData                     the machine data to be parsed\n */\nexport function loadMachineFromData(graphController, machineController, machineData)\n{\n    const machineType = machineData.type;\n    if (machineType) machineController.setMachineType(machineType);\n    const customSymbols = machineData.symbols;\n    if (customSymbols && Array.isArray(customSymbols))\n    {\n        machineController.clearCustomSymbols();\n        for(const symbol of customSymbols)\n        {\n            machineController.addCustomSymbol(symbol);\n        }\n    }\n\n    if (graphController)\n    {\n        const statePrefix = machineData.statePrefix;\n        if (statePrefix)\n        {\n            graphController.getGraphLabeler().setDefaultNodeLabelPrefix(statePrefix);\n        }\n    }\n}\n\nexport default FSAImporter;\n","import SessionImporter from 'session/SessionImporter.js';\n\nclass FSAJFFImporter extends SessionImporter\n{\n    constructor(app, jffGraphParser)\n    {\n        super();\n\n        this._app = app;\n        this._graphParser = jffGraphParser;\n    }\n\n    /** @override */\n    onParseSession(session, fileData)\n    {\n        return new DOMParser().parseFromString(fileData, 'text/xml');\n    }\n\n    /** @override */\n    onPreImportSession(session)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n        this._prevGraphHash = graph.getHashCode(true);\n\n        // TODO: this should not be here, this should exist somewhere in graphController\n        if (!graph.isEmpty())\n        {\n            session.getApp().getUndoManager().captureEvent();\n        }\n    }\n\n    /** @override */\n    onImportSession(session, sessionData)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n\n        this._graphParser.parse(sessionData, graph);\n    }\n\n    /** @override */\n    onPostImportSession(session)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n\n        // Compares the graph hash before and after import, captures event if they are not equal\n        const nextGraphHash = graph.getHashCode(true);\n        if (this._prevGraphHash !== nextGraphHash)\n        {\n            // TODO: this should not be here\n            session.getApp().getUndoManager().captureEvent();\n        }\n    }\n}\n\nexport default FSAJFFImporter;\n","import SessionExporter from 'session/SessionExporter.js';\n\nimport JSONFileIcon from 'components/iconset/flat/JSONFileIcon.js';\n\n/**\n * A class that represents a session exporter for the FSA module.\n */\nclass FSAExporter extends SessionExporter\n{\n    constructor(jsonGraphParser)\n    {\n        super('.fsa.json');\n        this._graphParser = jsonGraphParser;\n    }\n\n    /** @override */\n    onExportSession(session, dst)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const machineController = currentModule.getMachineController();\n        const graph = graphController.getGraph();\n        const graphData = this._graphParser.objectify(graph);\n\n        dst['graphData'] = graphData;\n        dst['machineData'] = {\n            type: machineController.getMachineType(),\n            symbols: machineController.getCustomSymbols(),\n            statePrefix: graphController.getGraphLabeler().getDefaultNodeLabelPrefix()\n        };\n    }\n\n    /** @override */\n    getIconClass() { return JSONFileIcon; }\n    /** @override */\n    getLabel() { return I18N.toString('file.export.machine'); }\n    /** @override */\n    getTitle() { return I18N.toString('file.export.machine.hint'); }\n}\n\nexport default FSAExporter;\n","import React from 'react';\n\nclass XMLFileIcon extends React.PureComponent\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        return (\n            <svg id={this.props.id} className={this.props.className} style={this.props.style}\n                xmlns=\"http://www.w3.org/2000/svg\"\n                width=\"24\" height=\"24\" viewBox=\"0 0 56 56\">\n                <path fill=\"#E9E9E0\" d=\"M36.985,0H7.963C7.155,0,6.5,0.655,6.5,1.926V55c0,0.345,0.655,1,1.463,1h40.074 c0.808,0,1.463-0.655,1.463-1V12.978c0-0.696-0.093-0.92-0.257-1.085L37.607,0.257C37.442,0.093,37.218,0,36.985,0z\"/>\n                <polygon fill=\"#D9D7CA\" points=\"37.5,0.151 37.5,12 49.349,12 \t\"/>\n                <path fill=\"#F29C1F\" d=\"M48.037,56H7.963C7.155,56,6.5,55.345,6.5,54.537V39h43v15.537C49.5,55.345,48.845,56,48.037,56z\"/>\n                <path fill=\"#FFFFFF\" d=\"M19.379,48.105L21.936,53h-1.9l-1.6-3.801h-0.137L16.576,53h-1.9l2.557-4.895l-2.721-5.182h1.873 l1.777,4.102h0.137l1.928-4.102H22.1L19.379,48.105z\"/>\n                <path fill=\"#FFFFFF\" d=\"M31.998,42.924h1.668V53h-1.668v-6.932l-2.256,5.605h-1.449l-2.27-5.605V53h-1.668V42.924h1.668 l2.994,6.891L31.998,42.924z\"/>\n                <path fill=\"#FFFFFF\" d=\"M37.863,42.924v8.832h4.635V53h-6.303V42.924H37.863z\"/>\n                <path fill=\"#F29C1F\" d=\"M15.5,24c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l6-6 c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-6,6C16.012,23.902,15.756,24,15.5,24z\"/>\n                <path fill=\"#F29C1F\" d=\"M21.5,30c-0.256,0-0.512-0.098-0.707-0.293l-6-6c-0.391-0.391-0.391-1.023,0-1.414 s1.023-0.391,1.414,0l6,6c0.391,0.391,0.391,1.023,0,1.414C22.012,29.902,21.756,30,21.5,30z\"/>\n                <path fill=\"#F29C1F\" d=\"M33.5,30c-0.256,0-0.512-0.098-0.707-0.293c-0.391-0.391-0.391-1.023,0-1.414l6-6 c0.391-0.391,1.023-0.391,1.414,0s0.391,1.023,0,1.414l-6,6C34.012,29.902,33.756,30,33.5,30z\"/>\n                <path fill=\"#F29C1F\" d=\"M39.5,24c-0.256,0-0.512-0.098-0.707-0.293l-6-6c-0.391-0.391-0.391-1.023,0-1.414 s1.023-0.391,1.414,0l6,6c0.391,0.391,0.391,1.023,0,1.414C40.012,23.902,39.756,24,39.5,24z\"/>\n                <path fill=\"#F29C1F\" d=\"M24.5,32c-0.11,0-0.223-0.019-0.333-0.058c-0.521-0.184-0.794-0.755-0.61-1.276l6-17 c0.185-0.521,0.753-0.795,1.276-0.61c0.521,0.184,0.794,0.755,0.61,1.276l-6,17C25.298,31.744,24.912,32,24.5,32z\"/>\n            </svg>\n        );\n    }\n}\nexport default XMLFileIcon;\n","import SessionExporter from 'session/SessionExporter.js';\n\nimport XMLFileIcon from 'components/iconset/flat/XMLFileIcon.js';\n\nclass FSAJFFExporter extends SessionExporter\n{\n    constructor(jffGraphParser)\n    {\n        super('.jff');\n        this._graphParser = jffGraphParser;\n    }\n\n    /** @override */\n    onExportSession(session, dst)\n    {\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const graph = graphController.getGraph();\n        dst['graphData'] = this._graphParser.objectify(graph);\n    }\n\n    /** @override */\n    onStringifySession(session, dst)\n    {\n        return new XMLSerializer().serializeToString(dst.graphData);\n    }\n\n    /** @override */\n    getIconClass() { return XMLFileIcon; }\n    /** @override */\n    getLabel() { return I18N.toString('file.export.jff'); }\n    /** @override */\n    getTitle() { return I18N.toString('file.export.jff.hint'); }\n}\n\nexport default FSAJFFExporter;\n","class MessageHandler\n{\n    constructor()\n    {\n        this._broadcastManager = null;\n    }\n\n    setBroadcastManager(broadcastManager)\n    {\n        this._broadcastManager = broadcastManager;\n        return this;\n    }\n\n    onBroadcastMessage(type, src, dst, message)\n    {\n        return false;\n    }\n\n    getBroadcastManager() { return this._broadcastManager; }\n}\n\nexport default MessageHandler;\n","import BroadcastHandler from 'session/manager/broadcast/BroadcastHandler.js';\n\nimport { JSON as JSONGraphParser } from 'modules/fsa2/FSAGraphParser.js';\nimport FSA from 'modules/fsa2/machine/FSA.js';\nimport { isEquivalentFSA } from 'modules/fsa2/machine/FSAUtils.js';\nimport { isEquivalentFSAWithWitness } from './machine/util/EqualFSA';\n\nconst MACHINE_REQUEST_MESSAGE_TYPE = 'fsa-machine-request';\nconst MACHINE_RESPONSE_MESSAGE_TYPE = 'fsa-machine-response';\n\nclass FSABroadcastHandler extends BroadcastHandler\n{\n    constructor()\n    {\n        super();\n    }\n\n    testEquivalence(targetSessionID)\n    {\n        this._broadcastManager.sendMessageTo(targetSessionID, MACHINE_REQUEST_MESSAGE_TYPE);\n    }\n\n    /** @override */\n    onBroadcastMessage(type, src, dst, message)\n    {\n        if (type === MACHINE_REQUEST_MESSAGE_TYPE)\n        {\n            const graph = this._broadcastManager.getApp().getSession()\n                .getCurrentModule()\n                .getGraphController()\n                .getGraph();\n            const graphData = JSONGraphParser.objectify(graph);\n            this._broadcastManager.sendMessageTo(src, MACHINE_RESPONSE_MESSAGE_TYPE, {\n                graphData: graphData\n            });\n            return true;\n        }\n        else if (type === MACHINE_RESPONSE_MESSAGE_TYPE)\n        {\n            const machineController = this._broadcastManager.getApp().getSession()\n                .getCurrentModule()\n                .getMachineController();\n            const graphData = message['graphData'];\n            const graph = JSONGraphParser.parse(graphData);\n            const machine = machineController\n                .getMachineBuilder()\n                .attemptBuild(graph, new FSA());\n            const currentMachine = machineController.getMachineBuilder().getMachine();\n\n            // changed isEquivalentFSA to isEquivalentFSAWithWitness\n            const result = isEquivalentFSAWithWitness(machine, currentMachine);\n\n            // changed result to result.value, needed information from the user to show witness string\n            window.alert('The machines are ' + (result.value ? 'EQUAL' : 'NOT EQUAL') + '!');\n            return true;\n        }\n\n        return false;\n    }\n}\n\nexport default FSABroadcastHandler;\n","import LocalStorage from 'util/storage/LocalStorage.js';\n\nimport { SEQUENCE_LAYOUT_ID } from 'session/manager/notification/NotificationManager.js';\nconst TUTORIAL_NOTIFICATION_ID = 'tutorial';\n\nconst TUTORIAL_STORAGE_ID = 'prefs-tut_fsa';\n\nclass TutorialHandler\n{\n    constructor() {}\n\n    start(app, forceStart = false)\n    {\n        if (!forceStart && LocalStorage.getData(TUTORIAL_STORAGE_ID)) return;\n        app.getNotificationManager()\n            .pushNotification(`-=-= Bab's First Graph =-=-\n            We can make a graph by creating nodes and edges.\n            \n            Nodes\n            > DOUBLE CLICK on empty space.\n\n            Edges\n            > RIGHT-HOLD on a node, then DRAG out to target.\n\n            If using touchscreen, you can TAP & HOLD instead of a RIGHT-CLICK.`,\n            SEQUENCE_LAYOUT_ID, [TUTORIAL_NOTIFICATION_ID], { onClick: () => \n            {\n                app.getNotificationManager()\n                    .pushNotification(`-=-= More Bab's Graph =-=-\n                    You can do so much more.\n        \n                    Move stuff\n                    > CLICK & HOLD on target, then DRAG.\n                    \n                    Delete stuff\n                    > DRAG to Trash Can at bottom-right.\n        \n                    Edit labels, etc.\n                    > RIGHT-CLICK on target.\n                    \n                    More tools in the Drawer on the right. Check it out!`,\n                    SEQUENCE_LAYOUT_ID, [TUTORIAL_NOTIFICATION_ID], { onClick: () =>\n                    {\n                        // Don't need to show it again.\n                        LocalStorage.setData(TUTORIAL_STORAGE_ID, 'true');\n                        \n                        app.getNotificationManager()\n                            .pushNotification(`-=- Bab's Masterpiece -=-\n                            Action Mode Tray (Bottom Left)\n                            > This will show you whether you are currently editing or moving stuff or you can manually switch them here!\n                            \n                            Trash Can (Bottom Right)\n                            > This will turn RED if deleting stuff. You can also enter Delete Mode with a CLICK.\n                            \n                            Drawer (Right)\n                            > Open the drawer by a CLICK on the tabs. You can toggle fullscreen with the Expand Arrow at the top.\n                            \n                            Any additional questions, please use the ? button on the toolbar.\n                            Have fun!\n                            `, null, [TUTORIAL_NOTIFICATION_ID]);\n                    }});\n            }});\n    }\n}\n\nexport default TutorialHandler;","import React from 'react';\nimport Style from './StateListElement.css';\n\nconst SUBMIT_KEY_CODE = 'Enter';\nconst CANCEL_KEY_CODE = 'Escape';\n\nclass StateListElement extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.state = {\n            value: null,\n            error: false\n        };\n\n        this.onValueChange = this.onValueChange.bind(this);\n        this.onFocus = this.onFocus.bind(this);\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n        this.onKeyUp = this.onKeyUp.bind(this);\n    }\n\n    onFocus(e)\n    {\n        const target = e.target;\n        const node = this.props.node;\n\n        const nodeLabel = node ? node.getNodeLabel() : null;\n        this.setState({\n            value: nodeLabel,\n            error: false\n        }, () => target.select());\n\n        // Call any listening focus\n        if (this.props.onFocus) this.props.onFocus(e, this);\n    }\n\n    onBlur(e)\n    {\n        const nextLabel = this.state.value;\n\n        // Reset to nothing (will use node.getNodeLabel() instead)\n        this.setState({ value: null, error: false });\n\n        // Call any listening blurs\n        if (this.props.onBlur) this.props.onBlur(e, this, nextLabel);\n    }\n\n    onKeyDown(e)\n    {\n        const keyCode = e.key;\n        if (keyCode === SUBMIT_KEY_CODE || keyCode === CANCEL_KEY_CODE)\n        {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    onKeyUp(e)\n    {\n        const keyCode = e.key;\n        const target = e.target;\n\n        if (keyCode === SUBMIT_KEY_CODE)\n        {\n            target.blur();\n        }\n        else if (keyCode === CANCEL_KEY_CODE)\n        {\n            this.setState({\n                value: null,\n                error: false\n            }, () => target.blur());\n        }\n    }\n\n    onValueChange(e)\n    {\n        let value = e.target.value.trim();\n        let error = false;\n\n        if (this.props.onChange)\n        {\n            try\n            {\n                this.props.onChange(e, this, value);\n            }\n            catch (e)\n            {\n                error = true;\n            }\n        }\n\n        this.setState({\n            value: value,\n            error: error\n        });\n    }\n\n    /** @override */\n    render()\n    {\n        const node = this.props.node;\n        const inputValue = this.state.value;\n\n        const nodeLabel = node ? node.getNodeLabel() : '';\n        const nodeCustom = node ? (node.getNodeCustom() || inputValue !== null && inputValue !== nodeLabel) : false;\n        const nodeAccept = node ? node.getNodeAccept() : false;\n        // Must check for null, not ONLY truthy because value might be empty string.\n        const displayValue = inputValue === null ? nodeLabel : inputValue;\n\n        return (\n            <div id={this.props.id}\n                className={Style.element_container +\n                    (nodeCustom ? ' custom ' : '') +\n                    ((!node.getNodeCustom() && displayValue.length <= 0) ? ' empty ' : '') +\n                    (inputValue !== null && this.state.error ? ' error ' : '') +\n                    (nodeAccept ? ' accept ' : '') +\n                    ' ' + this.props.className}\n                style={this.props.style}>\n                <input\n                    spellCheck={false}\n                    style={{ width: displayValue.length + 'ch' }}\n                    value={displayValue}\n                    onChange={this.onValueChange}\n                    onFocus={this.onFocus}\n                    onBlur={this.onBlur}\n                    onKeyDown={this.onKeyDown}\n                    onKeyUp={this.onKeyUp} />\n            </div>\n        );\n    }\n}\n\nexport default StateListElement;\n","import React from 'react';\nimport Style from './StateListView.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport BoxAddIcon from 'components/iconset/BoxAddIcon.js';\nimport TriangleIcon from 'components/iconset/TriangleIcon.js';\n\nimport StateListElement from './StateListElement.js';\n\nclass StateListView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._prevX = 0;\n        this._prevY = 0;\n\n        this.onElementAdd = this.onElementAdd.bind(this);\n        this.onElementFocus = this.onElementFocus.bind(this);\n        this.onElementBlur = this.onElementBlur.bind(this);\n        this.onElementChange = this.onElementChange.bind(this);\n    }\n\n    onElementAdd(e)\n    {\n        const graphController = this.props.graphController;\n        this._prevX += 16;\n        this._prevY += 16;\n        const node = graphController.createNode(this._prevX, this._prevY);\n        const graphView = this.props.graphView;\n        graphView.moveViewToPosition(node.x, node.y);\n    }\n\n    onElementFocus(e, element)\n    {\n        const node = element.props.node;\n        this._prevX = node.x;\n        this._prevY = node.y;\n        const graphView = this.props.graphView;\n        graphView.moveViewToPosition(node.x, node.y);\n    }\n\n    onElementBlur(e, element, nextLabel)\n    {\n        const node = element.props.node;\n        if (!node) return;\n\n        const graphController = this.props.graphController;\n\n        //The value is already processed, abort\n        if (nextLabel !== null)\n        {\n            const graph = graphController.getGraph();\n            if (nextLabel.length > 0)\n            {\n                const otherNodes = graph.getNodesByLabel(nextLabel);\n                if (otherNodes.length <= 0)\n                {\n                    //None other have the same name. Rename it!\n                    graphController.renameNode(node, nextLabel);\n                }\n                else\n                {\n                    //Found something already named that! Ignore!\n                }\n            }\n            else if (node.getNodeCustom())\n            {\n                //Remove custom naming instead of deleting.\n                node.setNodeCustom(false);\n                graphController.applyAutoRename();\n            }\n            else\n            {\n                //Delete!\n                graphController.deleteTargetNode(node);\n            }\n        }\n    }\n\n    onElementChange(e, element, value)\n    {\n        const graphController = this.props.graphController;\n\n        if (value.length > 0)\n        {\n            const graph = graphController.getGraph();\n            const otherNodes = graph.getNodesByLabel(value);\n\n            //If there are more than 1 nodes by the same name,\n            //OR if the duplicate node found is NOT the same node\n            if (otherNodes.length > 1 || (otherNodes.length === 1 && otherNodes[0] !== element.props.node))\n            {\n                throw new Error('Not a valid node label');\n            }\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const graphController = this.props.graphController;\n        const graph = graphController.getGraph();\n        const nodes = graph.getNodes();\n\n        return (\n            <div id={this.props.id}\n                className={Style.list_container}\n                style={this.props.style}>\n                <div className={Style.element_list}>\n                    <TriangleIcon className={Style.first_marker}/>\n                    {nodes.map(e => <StateListElement key={e.getGraphElementID()}\n                        node={e}\n                        onFocus={this.onElementFocus}\n                        onBlur={this.onElementBlur}\n                        onChange={this.onElementChange}/>)}\n                </div>\n                <IconButton className={Style.add_button}\n                    title=\"Add State\"\n                    onClick={this.onElementAdd}>\n                    <BoxAddIcon/>\n                </IconButton>\n            </div>\n        );\n    }\n}\n\nexport default StateListView;\n","import React from 'react';\nimport Style from './AlphabetListElement.css';\n\nconst SUBMIT_KEY_CODE = 'Enter';\nconst CANCEL_KEY_CODE = 'Escape';\n\nclass AlphabetListElement extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._inputElement = null;\n\n        this.state = {\n            value: null,\n            error: false\n        };\n\n        this.onValueChange = this.onValueChange.bind(this);\n        this.onFocus = this.onFocus.bind(this);\n        this.onBlur = this.onBlur.bind(this);\n        this.onKeyDown = this.onKeyDown.bind(this);\n        this.onKeyUp = this.onKeyUp.bind(this);\n    }\n\n    onFocus(e)\n    {\n        const target = e.target;\n        const symbol = this.props.symbol;\n\n        this.setState({\n            value: symbol,\n            error: false\n        }, () => target.select());\n\n        //Call any listening focus\n        if (this.props.onFocus) this.props.onFocus(e, this);\n    }\n\n    onBlur(e)\n    {\n        const nextSymbol = this.state.value;\n\n        //Call any listening blurs\n        if (this.props.onBlur) this.props.onBlur(e, this, nextSymbol);\n\n        //Reset to nothing (will use props.symbol instead)\n        this.setState({ value: null, error: false });\n    }\n\n    onKeyDown(e)\n    {\n        const keyCode = e.key;\n        if (keyCode === SUBMIT_KEY_CODE || keyCode === CANCEL_KEY_CODE)\n        {\n            e.preventDefault();\n            e.stopPropagation();\n        }\n    }\n\n    onKeyUp(e)\n    {\n        const keyCode = e.key;\n        const target = e.target;\n\n        if (keyCode === SUBMIT_KEY_CODE)\n        {\n            target.blur();\n        }\n        else if (keyCode === CANCEL_KEY_CODE)\n        {\n            this.setState({\n                value: null,\n                error: false\n            }, () => target.blur());\n        }\n    }\n\n    onValueChange(e)\n    {\n        let value = e.target.value.trim();\n        let error = false;\n\n        if (this.props.onChange)\n        {\n            try\n            {\n                this.props.onChange(e, this, value);\n            }\n            catch(e)\n            {\n                error = true;\n            }\n        }\n\n        this.setState({\n            value: value,\n            error: error\n        });\n    }\n\n    focus()\n    {\n        this._inputElement.focus();\n    }\n\n    /** @override */\n    render()\n    {\n        const inputSymbol = this.state.value;\n        const displaySymbol = inputSymbol === null ? this.props.symbol : inputSymbol;\n\n        const symbolUsed = this.props.used || false;\n\n        return (\n            <div id={this.props.id}\n                className={Style.element_container +\n          (displaySymbol !== null && displaySymbol.length <= 0 ? ' empty ' : '') +\n          (inputSymbol !== null && this.state.error ? ' error ' : '') +\n          (symbolUsed ? ' used ' : '') +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                <input ref={ref=>this._inputElement=ref}\n                    spellCheck={false}\n                    maxLength={1}\n                    style={{width: '1ch'}}\n                    value={displaySymbol}\n                    onChange={this.onValueChange}\n                    onFocus={this.onFocus}\n                    onBlur={this.onBlur}\n                    onKeyDown={this.onKeyDown}\n                    onKeyUp={this.onKeyUp}/>\n            </div>\n        );\n    }\n}\n\nexport default AlphabetListElement;\n","import React from 'react';\nimport Style from './AlphabetListView.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport BoxAddIcon from 'components/iconset/BoxAddIcon.js';\n\nimport AlphabetListElement from './AlphabetListElement.js';\n\nclass AlphabetListView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.newSymbolComponent = null;\n\n        this.state = {\n            useNewSymbol: false\n        };\n\n        this.onElementAdd = this.onElementAdd.bind(this);\n        this.onElementFocus = this.onElementFocus.bind(this);\n        this.onElementBlur = this.onElementBlur.bind(this);\n        this.onElementChange = this.onElementChange.bind(this);\n    }\n\n    onElementAdd(e)\n    {\n    //Create a new alphabet element...\n        this.setState({useNewSymbol: true}, () => \n        {\n            this.newSymbolComponent.focus();\n        });\n    }\n\n    onElementFocus(e, element)\n    {\n    //Do nothing...\n    }\n\n    onElementBlur(e, element, nextSymbol)\n    {\n        const symbol = element.props.symbol;\n        const machineController = this.props.machineController;\n\n        if (nextSymbol !== null)\n        {\n            const machine = machineController.getMachineBuilder().getMachine();\n            if (nextSymbol.length > 0)\n            {\n                if (!machine.isSymbol(nextSymbol))\n                {\n                    if (symbol)\n                    {\n                        //None other have the same name. Rename it!\n                        machineController.renameSymbol(symbol, nextSymbol);\n                    }\n                    else\n                    {\n                        //None other have the same name. Create it!\n                        machineController.createSymbol(nextSymbol);\n                    }\n                }\n                else\n                {\n                    //Found something already named that! Ignore!\n                }\n            }\n            else if (symbol)\n            {\n                //Delete!\n                machineController.deleteSymbol(symbol);\n            }\n        }\n\n        //Regardless, just close the \"new\" alphabet element if open.\n        if (this.state.useNewSymbol)\n        {\n            this.setState({ useNewSymbol: false });\n        }\n    }\n\n    onElementChange(e, element, symbol)\n    {\n        const machineController = this.props.machineController;\n\n        if (symbol.length > 0)\n        {\n            //If there are more than 1 symbols by the same name,\n            //OR if the duplicate symbol found is NOT the same symbol\n            const machine = machineController.getMachineBuilder().getMachine();\n            if (machine.isSymbol(symbol) && symbol !== element.props.symbol)\n            {\n                throw new Error('Not a valid symbol');\n            }\n        }\n    }\n\n    renderAlphabetList(machine, alphabet)\n    {\n        const result = [];\n        for(const symbol of alphabet)\n        {\n            if (!symbol) continue;\n\n            result.push(<AlphabetListElement key={symbol}\n                symbol={symbol}\n                used={machine.isUsedSymbol(symbol)}\n                onFocus={this.onElementFocus}\n                onBlur={this.onElementBlur}\n                onChange={this.onElementChange}/>);\n        }\n        return result;\n    }\n\n    /** @override */\n    render()\n    {\n        const machineController = this.props.machineController;\n        const machine = machineController.getMachineBuilder().getMachine();\n        const alphabet = machine.getAlphabet();\n\n        return (\n            <div id={this.props.id}\n                className={Style.list_container}\n                style={this.props.style}>\n                <div className={Style.element_list}>\n                    {this.renderAlphabetList(machine, alphabet)}\n                    <AlphabetListElement\n                        ref={ref=>this.newSymbolComponent=ref}\n                        style={{display: this.state.useNewSymbol ? 'block' : 'none'}}\n                        symbol={''}\n                        onFocus={this.onElementFocus}\n                        onBlur={this.onElementBlur}\n                        onChange={this.onElementChange}/>\n                </div>\n                <IconButton className={Style.add_button}\n                    title=\"Add Symbol\"\n                    onClick={this.onElementAdd}>\n                    <BoxAddIcon/>\n                </IconButton>\n            </div>\n        );\n    }\n}\n\nexport default AlphabetListView;\n","import React from 'react';\nimport Style from './TransitionChartView.css';\n\nimport { EMPTY_CHAR } from 'modules/fsa2/graph/element/FSAEdge.js';\nimport { EMPTY_SYMBOL } from 'modules/fsa2/machine/FSA.js';\n\nclass TransitionChartView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        //NOTE: this only works if machine hashing is faster than a re-calculate\n        this._cachedMachineHash = 0;\n        this._cachedMachineComponents = [];\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n    //Reset cached components for re-rendering\n        this._cachedMachineHash = 0;\n        this._cachedMachineComponents.length = 0;\n    }\n\n    renderTransitionEntry(machine, state, symbol)\n    {\n        const deterministic = machine.isDeterministic();\n\n        let destinations = machine.doTransition(state, symbol, true);\n        let transitionString = '';\n        let error = false;\n\n        if (destinations.length <= 0)\n        {\n            if (deterministic)\n            {\n                error = true;\n                transitionString = '-';\n                if (symbol === EMPTY_SYMBOL)\n                {\n                    //Don't show missing empty transitions for DFA's\n                    return null;\n                }\n            }\n            else\n            {\n                //Don't show missing transitions for NFA's\n                return null;\n            }\n        }\n        else if (destinations.length === 1)\n        {\n            //Regardless if it's deterministic, it is a valid transition\n            error = false;\n            transitionString = destinations[0].getStateLabel();\n\n            if (!deterministic) transitionString = '{' + transitionString + '}';\n        }\n        else\n        {\n            //If it's deterministic, it is not valid\n            if (deterministic) error = true;\n\n            let string = '';\n            for(const state of destinations)\n            {\n                if (string.length > 0) string += ',';\n                string += state.getStateLabel();\n            }\n            transitionString = '{' + string + '}';\n        }\n\n        //Convert empty symbol to the expected char value\n        if (symbol === EMPTY_SYMBOL)\n        {\n            symbol = EMPTY_CHAR;\n\n            //DFA's can't have empty symbols\n            if (deterministic) error = true;\n        }\n\n        return (\n            <tr key={state.getStateID() + ':' + symbol}>\n                <td className={Style.chart_key + (error ? ' error ' : '')}>{'(' + state.getStateLabel() + ',' + symbol + ')'}</td>\n                <td className={Style.chart_value + (error ? ' error ' : '')}>{transitionString}</td>\n            </tr>\n        );\n    }\n\n    renderTransitionTable(machine)\n    {\n        const machineHash = machine.getHashCode();\n        if (machineHash !== this._cachedMachineHash)\n        {\n            this._cachedMachineHash = machineHash;\n        }\n        else\n        {\n            return this._cachedMachineComponents;\n        }\n\n        const result = this._cachedMachineComponents = [];\n        // const deterministic = machine.isDeterministic();\n\n        for(const state of machine.getStates())\n        {\n            let entry = null;\n\n            //The empty transitions...\n            entry = this.renderTransitionEntry(machine, state, EMPTY_SYMBOL);\n            if (entry) result.push(entry);\n\n            //The other transitions...\n            for(const symbol of machine.getAlphabet())\n            {\n                entry = this.renderTransitionEntry(machine, state, symbol);\n                if (entry) result.push(entry);\n            }\n        }\n        return result;\n    }\n\n    /** @override */\n    render()\n    {\n        const machineController = this.props.machineController;\n        const machine = machineController.getMachineBuilder().getMachine();\n        const deterministic = machineController.getMachineType() === 'DFA';\n\n        return (\n            <div id={this.props.id}\n                className={Style.chart_container +\n        ' ' + this.props.className}\n                style={this.props.style}>\n                <table>\n                    <tbody>\n                        <tr>\n                            <th>\n                                {'Q\\u00d7\\u03A3'}\n                            </th>\n                            <th>\n                                {deterministic ?\n                                    <span>{'Q'}</span> :\n                                    <span>\n                                        <span style={{fontFamily: 'cursive'}}>{'P'}</span>\n                                        <span>{'(Q)'}</span>\n                                    </span>}\n                            </th>\n                        </tr>\n                        {this.renderTransitionTable(machine)}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n}\n\nexport default TransitionChartView;\n","import React from 'react';\nimport Style from './TransitionTableView.css';\n\nimport { EMPTY_CHAR } from 'modules/fsa2/graph/element/FSAEdge.js';\nimport { EMPTY_SYMBOL } from 'modules/fsa2/machine/FSA.js';\n\nconst SYMBOL_AXIS = 'symbols';\nconst STATE_AXIS = 'states';\n\nclass TransitionTableView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.state = {\n            rowAxis: SYMBOL_AXIS\n        };\n\n        this.onRowAxisSwitch = this.onRowAxisSwitch.bind(this);\n    }\n\n    onRowAxisSwitch(e)\n    {\n        this.setState((prev, props) => \n        {\n            return {\n                rowAxis: prev.rowAxis === SYMBOL_AXIS ? STATE_AXIS : SYMBOL_AXIS\n            };\n        });\n    }\n\n    renderTableEntryForSymbolAxis(machine, state, symbol)\n    {\n        const deterministic = machine.isDeterministic();\n        const destinations = machine.doTransition(state, symbol);\n        let transitionString = '';\n        let error = false;\n\n        if (destinations.length <= 0)\n        {\n            if (deterministic && symbol !== EMPTY_SYMBOL) error = true;\n            transitionString = '-';\n        }\n        else if (destinations.length === 1)\n        {\n            if (deterministic && symbol === EMPTY_SYMBOL) error = true;\n            transitionString = destinations[0].getStateLabel();\n        }\n        else\n        {\n            if (deterministic) error = true;\n            let string = '';\n            for (const other of destinations)\n            {\n                if (string.length > 0) string += ',';\n                string += other.getStateLabel();\n            }\n            transitionString = '{' + string + '}';\n        }\n\n        const disabled = deterministic && symbol === EMPTY_SYMBOL;\n\n        return (\n            <td key={state.getStateID() + ':' + symbol}\n                className={Style.table_entry +\n                    (error ? ' error ' : '') +\n                    (disabled ? ' disabled ' : '')}>\n                {transitionString}\n            </td>\n        );\n    }\n\n    renderTableEntries(machine, rowAxis)\n    {\n        // const deterministic = machine.isDeterministic();\n\n        const result = [];\n        for (const state of machine.getStates())\n        {\n            const rowComponents = [];\n            switch (rowAxis)\n            {\n            case SYMBOL_AXIS:\n                for (const symbol of machine.getAlphabet())\n                {\n                    rowComponents.push(this.renderTableEntryForSymbolAxis(machine, state, symbol));\n                }\n                rowComponents.push(this.renderTableEntryForSymbolAxis(machine, state, EMPTY_SYMBOL));\n                break;\n            case STATE_AXIS:\n                for (const other of machine.getStates())\n                {\n                    const symbols = machine.getTransitionSymbols(state, other);\n                    let string = '';\n                    if (symbols)\n                    {\n                        for (const symbol of symbols)\n                        {\n                            if (string.length > 0) string += '\\n';\n                            if (symbol === EMPTY_SYMBOL) string += EMPTY_CHAR;\n                            else string += symbol;\n                        }\n                    }\n                    else\n                    {\n                        string = '-';\n                    }\n                    rowComponents.push(\n                        <td key={state.getStateID() + ':' + other.getStateID()}>\n                            {string}\n                        </td>\n                    );\n                }\n                break;\n            default:\n                throw new Error('Unknown row axis type \\'' + rowAxis + '\\'');\n            }\n            result.push(\n                <tr key={state.getStateID()}>\n                    <th scope=\"row\" className={Style.table_axis_header + ' row'}>\n                        {state.getStateLabel()}\n                    </th>\n                    {rowComponents}\n                </tr>\n            );\n        }\n        return result;\n    }\n\n    renderTableAxis(machine, rowAxis)\n    {\n        let result = [];\n        const disabled = machine.isDeterministic();\n        switch (rowAxis)\n        {\n        case SYMBOL_AXIS:\n            for (const symbol of machine.getAlphabet())\n            {\n                result.push(\n                    <th key={symbol} scope=\"col\" className={Style.table_axis_header + ' col'}>\n                        {symbol}\n                    </th>\n                );\n            }\n            result.push(\n                <th key={EMPTY_SYMBOL} scope=\"col\"\n                    className={Style.table_axis_header +\n                            (disabled ? ' disabled ' : '') +\n                            ' col'}>\n                    {EMPTY_CHAR}\n                </th>\n            );\n            return result;\n        case STATE_AXIS:\n            for (const state of machine.getStates())\n            {\n                result.push(\n                    <th key={state.getStateID()} scope=\"col\" className={Style.table_axis_header + ' col'}>\n                        {state.getStateLabel()}\n                    </th>\n                );\n            }\n            return result;\n        default:\n            throw new Error('Unknown row axis type \\'' + rowAxis + '\\'');\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const rowAxis = this.state.rowAxis;\n        const machineController = this.props.machineController;\n        const machine = machineController.getMachineBuilder().getMachine();\n\n        return (\n            <div id={this.props.id}\n                className={Style.table_container +\n                    ' ' + this.props.className}\n                style={this.props.style}>\n                <table>\n                    <tbody>\n                        <tr>\n                            <th>\n                                <button onClick={this.onRowAxisSwitch}>\n                                    {rowAxis === SYMBOL_AXIS ? 'Q/\\u03A3' : 'Q/Q'}\n                                </button>\n                            </th>\n                            {this.renderTableAxis(machine, rowAxis)}\n                        </tr>\n                        {this.renderTableEntries(machine, rowAxis)}\n                    </tbody>\n                </table>\n            </div>\n        );\n    }\n}\n\nexport default TransitionTableView;\n","import React from 'react';\nimport Style from './AutoStateLabelView.css';\n\nimport FormattedInput from 'deprecated/system/formattedinput/FormattedInput.js';\n\nclass AutoStateLabelView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onAutoStatePrefixSubmit = this.onAutoStatePrefixSubmit.bind(this);\n        this.onAutoStatePrefixFormat = this.onAutoStatePrefixFormat.bind(this);\n    }\n\n    onAutoStatePrefixSubmit(next, prev)\n    {\n        const graphController = this.props.graphController;\n        const graphLabeler = graphController.getGraphLabeler();\n\n        const prefix = graphLabeler.getDefaultNodeLabelPrefix();\n        if (prefix != next)\n        {\n            graphLabeler.setDefaultNodeLabelPrefix(next);\n            graphController.applyAutoRename();\n        }\n    }\n\n    onAutoStatePrefixFormat(value)\n    {\n        return value && value.length > 0 ? value :\n            this.props.graphController.getGraphLabeler().getDefaultNodeLabelPrefix();\n    }\n\n    /** @override */\n    render()\n    {\n        const graphController = this.props.graphController;\n\n        return (\n            <div id={this.props.id}\n                className={Style.select_container +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                <label className={Style.select_label}>\n          State Labels\n                </label>\n                <FormattedInput\n                    className={Style.prefix_editor}\n                    defaultValue={graphController.getGraphLabeler().getDefaultNodeLabelPrefix()}\n                    captureOnExit=\"save\"\n                    formatter={this.onAutoStatePrefixFormat}\n                    onSubmit={this.onAutoStatePrefixSubmit}/>\n                <select className={Style.postfix_selector}\n                    onChange={this.onMachineTypeChange}\n                    disabled={true}>\n                    <option>0-9</option>\n                    <option>a-z</option>\n                    <option>A-Z</option>\n                </select>\n            </div>\n        );\n    }\n}\n\nexport default AutoStateLabelView;\n","import React from 'react';\nimport Style from './OverviewPanel.css';\n\nimport PanelContainer from 'experimental/panels/PanelContainer.js';\nimport PanelSection from 'experimental/panels/PanelSection.js';\nimport PanelDivider from 'experimental/panels/PanelDivider.js';\nimport PanelSwitch from 'experimental/panels/PanelSwitch.js';\n\nimport StateListView from './states/StateListView.js';\nimport AlphabetListView from './alphabet/AlphabetListView.js';\nimport TransitionChartView from './transitions/TransitionChartView.js';\nimport TransitionTableView from './transitions/TransitionTableView.js';\nimport AutoStateLabelView from './AutoStateLabelView.js';\n\nconst MACHINE_TYPE_DFA = 'DFA';\nconst MACHINE_TYPE_NFA = 'NFA';\n\nclass OverviewPanel extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onMachineTypeChange = this.onMachineTypeChange.bind(this);\n        this.onAutoLayoutApply = this.onAutoLayoutApply.bind(this);\n        this.onAutoLayoutChange = this.onAutoLayoutChange.bind(this);\n        this.onAutoLabelChange = this.onAutoLabelChange.bind(this);\n        this.onSnapToGridChange = this.onSnapToGridChange.bind(this);\n    }\n\n    onMachineTypeChange(e)\n    {\n        const newValue = e.target.value;\n\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const machineController = currentModule.getMachineController();\n        const machine = machineController.getMachineBuilder().getMachine();\n\n        switch (newValue)\n        {\n        case MACHINE_TYPE_DFA:\n            machine.setDeterministic(true);\n            break;\n        case MACHINE_TYPE_NFA:\n            machine.setDeterministic(false);\n            break;\n        default:\n            throw new Error('Unknown machine type \\'' + newValue + '\\'');\n        }\n    }\n\n    onAutoLayoutApply(e)\n    {\n        const currentModule = this.props.session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        graphController.applyAutoLayout();\n    }\n\n    onAutoLayoutChange(e)\n    {\n        //TODO: Not yet implemented...\n    }\n\n    onAutoLabelChange(e)\n    {\n        const currentModule = this.props.session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        graphController.setAutoRenameNodes(e.target.checked);\n    }\n\n    onSnapToGridChange(e)\n    {\n        //TODO: Not yet implemented...\n    }\n\n    /** @override */\n    render()\n    {\n        const drawer = this.props.drawer;\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const machineController = currentModule.getMachineController();\n        const graphView = currentModule.getGraphView();\n        const machineType = machineController.getMachineBuilder().getMachine().isDeterministic() ? MACHINE_TYPE_DFA : MACHINE_TYPE_NFA;\n        const autoRename = graphController.shouldAutoRenameNodes();\n\n        const drawerFull = drawer.isDrawerFullscreen();\n\n        return (\n            <PanelContainer id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                title={OverviewPanel.TITLE}>\n\n                <select className={Style.machine_type_select}\n                    value={machineType}\n                    onChange={this.onMachineTypeChange}>\n                    <option>{MACHINE_TYPE_DFA}</option>\n                    <option>{MACHINE_TYPE_NFA}</option>\n                </select>\n\n                <PanelDivider />\n\n                <PanelSection title={'States'} initial={true} full={drawerFull}>\n                    <StateListView graphController={graphController} graphView={graphView} />\n                </PanelSection>\n                <PanelSection title={'Alphabet'} initial={true} full={drawerFull}>\n                    <AlphabetListView machineController={machineController} />\n                </PanelSection>\n\n                <PanelDivider />\n\n                <PanelSection title={'Transition Chart'} full={drawerFull} disabled={graphController.getGraph().getEdgeCount() <= 0}>\n                    <TransitionChartView machineController={machineController} />\n                </PanelSection>\n                <PanelSection title={'Transition Table'} full={drawerFull} disabled={graphController.getGraph().getNodeCount() <= 0}>\n                    <TransitionTableView machineController={machineController} />\n                </PanelSection>\n\n                <PanelDivider />\n\n                <AutoStateLabelView graphController={graphController} />\n\n                <button className={Style.autolayout_button}\n                    onClick={this.onAutoLayoutApply}\n                    disabled={graphController.getGraph().isEmpty()}>\n                    {I18N.toString('action.overview.autolayout')}\n                </button>\n\n                <PanelDivider />\n\n                <PanelSwitch id={'overview-auto-label'}\n                    checked={autoRename}\n                    title={'Auto rename nodes'}\n                    onChange={this.onAutoLabelChange} />\n                <PanelSwitch id={'overview-auto-layout'}\n                    checked={false}\n                    title={'Auto layout nodes'}\n                    disabled={true}\n                    onChange={this.onAutoLayoutChange} />\n                <PanelSwitch id={'overview-snap-grid'}\n                    checked={false}\n                    title={'Snap-to-grid'}\n                    disabled={true}\n                    onChange={this.onSnapToGridChange} />\n\n            </PanelContainer>\n        );\n    }\n}\nObject.defineProperty(OverviewPanel, 'TITLE', {\n    get: function () { return I18N.toString('component.overview.title'); }\n});\n\nexport default OverviewPanel;\n","import React from 'react';\nimport Style from './TestItem.css';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport SubtractIcon from 'components/iconset/SubtractIcon.js';\nimport CheckCircleIcon from 'components/iconset/CheckCircleIcon.js';\nimport CrossCircleIcon from 'components/iconset/CrossCircleIcon.js';\nimport PendingIcon from 'components/iconset/PendingIcon.js';\nimport RunningManIcon from 'components/iconset/RunningManIcon.js';\n\nexport const DEFAULT_MODE = 'default';\nexport const SUCCESS_MODE = 'success';\nexport const FAILURE_MODE = 'failure';\nexport const WORKING_MODE = 'working';\n\nclass TestItem extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.inputElement = null;\n\n        this.state = {\n            value: this.props.defaultValue || '',\n            status: DEFAULT_MODE\n        };\n\n        this.onChange = this.onChange.bind(this);\n    }\n\n    focus()\n    {\n        if (this.inputElement)\n        {\n            this.inputElement.focus();\n        }\n    }\n\n    setValue(value, callback=null)\n    {\n        if (this.state.value !== value)\n        {\n            this.setState({value: value}, callback);\n        }\n        else if (callback)\n        {\n            callback();\n        }\n    }\n\n    setStatus(status, callback=null)\n    {\n        if (this.state.status !== status)\n        {\n            this.setState({status: status}, callback);\n        }\n        else if (callback)\n        {\n            callback();\n        }\n    }\n\n    resetStatus(callback=null)\n    {\n        if (this.state.status !== DEFAULT_MODE)\n        {\n            this.setState({status: DEFAULT_MODE}, callback);\n        }\n        else if (callback)\n        {\n            callback();\n        }\n    }\n\n    getValue()\n    {\n        return this.state.value;\n    }\n\n    getStatus()\n    {\n        return this.state.status;\n    }\n\n    onChange(e)\n    {\n        const nextValue = e.target.value;\n        if (this.state.value !== nextValue)\n        {\n            this.setState({value: nextValue, status: DEFAULT_MODE});\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const onDelete = this.props.onDelete;\n        const showDelete = true;\n\n        const onTest = this.props.onTest;\n        const showTest = true;\n\n        const active = this.props.active;\n        // const subtitle = this.props.subtitle;\n        const placeholder = this.props.placeholder;\n        const status = this.state.status;\n\n        return (\n            <div id={this.props.id}\n                className={Style.test_item_container +\n          (active ? ' active ' : '') +\n          ' ' + status +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                {showTest &&\n          <IconButton className={Style.test_button}\n              title={'Test'}\n              disabled={!onTest}\n              onClick={(e) => onTest(e, this)}>\n              {status === SUCCESS_MODE ?\n                  <CheckCircleIcon/> :\n                  status === FAILURE_MODE ?\n                      <CrossCircleIcon/> :\n                      status === WORKING_MODE ?\n                          <PendingIcon/> :\n                          <RunningManIcon/>}\n          </IconButton>}\n                <div className={Style.test_input}>\n                    <input ref={ref=>this.inputElement=ref} type=\"text\"\n                        placeholder={placeholder}\n                        value={this.state.value}\n                        onChange={this.onChange}/>\n                    <label>{this.props.subtitle}</label>\n                </div>\n                {showDelete &&\n          <IconButton className={Style.delete_button}\n              title={'Delete'}\n              disabled={!onDelete}\n              onClick={(e) => onDelete(e, this)}>\n              <SubtractIcon/>\n          </IconButton>}\n            </div>\n        );\n    }\n}\n\nexport default TestItem;\n","import React from 'react';\nimport Style from './TestListView.css';\n\nimport { guid } from 'util/MathHelper.js';\nimport { downloadText } from 'util/Downloader.js';\n\nimport IconButton from 'experimental/components/IconButton.js';\nimport IconUploadButton from 'experimental/components/IconUploadButton.js';\n\nimport PageContentIcon from 'components/iconset/PageContentIcon.js';\nimport UploadIcon from 'components/iconset/UploadIcon.js';\nimport DownloadIcon from 'components/iconset/DownloadIcon.js';\nimport CrossIcon from 'components/iconset/CrossIcon.js';\nimport AddIcon from 'components/iconset/AddIcon.js';\nimport RunningManIcon from 'components/iconset/RunningManIcon.js';\n\nimport TestItem, {SUCCESS_MODE, FAILURE_MODE, WORKING_MODE, DEFAULT_MODE} from './TestItem.js';\n\nconst ACCEPT_FILE_TYPES = ['.txt'];\nconst TEST_FILENAME = 'test.txt';\n// const TEST_REFRESH_TICKS = 30;\n\nclass TestListView extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this._testList = [];\n        this._testName = TEST_FILENAME;\n\n        this.onTestNew = this.onTestNew.bind(this);\n        this.onTestUpload = this.onTestUpload.bind(this);\n        this.onTestDownload = this.onTestDownload.bind(this);\n        this.onTestClose = this.onTestClose.bind(this);\n        this.onTestAdd = this.onTestAdd.bind(this);\n        this.onTestDelete = this.onTestDelete.bind(this);\n        this.onTestTest = this.onTestTest.bind(this);\n        this.onTestRunAll = this.onTestRunAll.bind(this);\n        this.onGraphChange = this.onGraphChange.bind(this);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        this.props.graphController.getGraphChangeHandler().addListener(this.onGraphChange);\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        this.props.graphController.getGraphChangeHandler().removeListener(this.onGraphChange);\n    }\n\n    onGraphChange(graph)\n    {\n        for(const test of this._testList)\n        {\n            test.ref.resetStatus();\n        }\n    }\n\n    onTestNew(e)\n    {\n        if (!this.isEmpty())\n        {\n            this.onTestClose(e);\n        }\n\n        this.onTestAdd(e);\n    }\n\n    onTestUpload(fileBlob)\n    {\n        const reader = new FileReader();\n        reader.onload = (event) => \n        {\n            try\n            {\n                this._testName = fileBlob.name;\n                this._testList.length = 0;\n\n                const tests = event.target.result.split('\\n');\n                for(let test of tests)\n                {\n                    test = test.trim();\n                    if (test.length > 0)\n                    {\n                        this._testList.push({\n                            id: guid(),\n                            defaultValue: test,\n                            ref: null\n                        });\n                    }\n                }\n\n                //Make sure an element exists, at least\n                if (this._testList.length <= 0)\n                {\n                    this.onTestAdd(null);\n                }\n            }\n            catch(e)\n            {\n                reader.abort();\n            }\n        };\n        reader.readAsText(fileBlob);\n    }\n\n    onTestDownload(e)\n    {\n        const testStrings = [];\n        for(const test of this._testList)\n        {\n            const ref = test.ref;\n            if (ref)\n            {\n                testStrings.push(ref.getValue());\n            }\n        }\n\n        downloadText(this._testName, testStrings.join('\\n'));\n    }\n\n    onTestClose(e)\n    {\n        const tester = this.props.tester;\n        if (tester.isTesting())\n        {\n            tester.stopTest();\n        }\n\n        this._testList.length = 0;\n    }\n\n    onTestAdd(e)\n    {\n        this._testList.push({\n            id: guid(),\n            defaultValue: '',\n            ref: null\n        });\n    }\n\n    onTestRunAll(e)\n    {\n        // const tester = this.props.tester;\n        let i = 0;\n\n        const nextTest = () => \n        {\n            const test = this._testList[i];\n            this.onTestTest(null, test.ref, true, () => \n            {\n                ++i;\n                if (i < this._testList.length)\n                {\n                    nextTest();\n                }\n            });\n        };\n        nextTest();\n    }\n\n    onTestDelete(e, item)\n    {\n    //Already handled in render()\n    }\n\n    onTestTest(e, item, forceImmediate=false, callback=null)\n    {\n        const immediate = forceImmediate || this.props.immediate;\n        const tester = this.props.tester;\n        const itemValue = item.getValue();\n\n        item.setState({status: WORKING_MODE});\n\n        const graphController = this.props.graphController;\n        const machineController = this.props.machineController;\n        tester.startTest(itemValue, graphController, machineController).then((result) => \n        {\n            item.setState({status: result ? SUCCESS_MODE : FAILURE_MODE});\n        }, (err) => \n        {\n            //It didn't work out :(\n            item.setState({status: DEFAULT_MODE});\n        });\n\n        if (immediate)\n        {\n            const promise = tester.runTest(graphController, machineController, true);\n            if (callback)\n            {\n                promise.then(callback);\n            }\n        }\n    }\n\n    isEmpty()\n    {\n        return this._testList.length <= 0;\n    }\n  \n    /** @override */\n    render()\n    {\n        // const immediate = this.props.immediate;\n        const tester = this.props.tester;\n\n        const graphController = this.props.graphController;\n        // const machineController = this.props.machineController;\n\n        const empty = this.isEmpty();\n        const disabled = tester && tester.isTesting();\n\n        return (\n            <div id={this.props.id}\n                className={Style.test_container +\n          ' ' + this.props.className}\n                style={this.props.style}>\n                <div className={Style.test_control_tray}>\n                    <IconButton className={Style.test_control_button}\n                        title={I18N.toString('action.testing.new')}\n                        onClick={this.onTestNew}>\n                        <PageContentIcon/>\n                    </IconButton>\n                    <IconUploadButton className={Style.test_control_button}\n                        title={I18N.toString('action.testing.import')}\n                        accept={ACCEPT_FILE_TYPES.join(',')}\n                        onUpload={this.onTestUpload}>\n                        <UploadIcon/>\n                    </IconUploadButton>\n                    <IconButton className={Style.test_control_button}\n                        title={I18N.toString('action.testing.save')}\n                        disabled={empty}\n                        onClick={this.onTestDownload}>\n                        <DownloadIcon/>\n                    </IconButton>\n                    <IconButton className={Style.test_control_button}\n                        title={I18N.toString('action.testing.clear')}\n                        disabled={empty}\n                        onClick={this.onTestClose}>\n                        <CrossIcon/>\n                    </IconButton>\n                </div>\n                <div className={Style.test_list_container +\n          (empty ? ' empty ' : '') +\n          (disabled ? ' disabled ': '')}>\n                    <IconButton className={Style.test_list_add}\n                        title={'Add'} onClick={this.onTestAdd}>\n                        <AddIcon/>\n                        <span className={Style.test_list_count}>\n                            {!empty ? '' + this._testList.length : ''}\n                        </span>\n                    </IconButton>\n                    <div className={Style.test_list_scroll_container}>\n                        <div className={Style.test_list}>\n                            {this._testList.map((e, i) => \n                            {\n                                const id = e.id;\n                                const defaultValue = e['defaultValue'] || '';\n                                let testCallback = this.onTestTest;\n                                if (!tester || graphController.getGraph().isEmpty())\n                                {\n                                    testCallback = null;\n                                }\n                                return <TestItem key={id} ref={ref=>e.ref=ref}\n                                    defaultValue={defaultValue}\n                                    onTest={testCallback}\n                                    onDelete={(e, item) => \n                                    {\n                                        this._testList.splice(i, 1);\n                                        this.onTestDelete(e, item);\n                                    }}/>;\n                            })}\n                        </div>\n                    </div>\n                    <IconButton className={Style.test_list_runall}\n                        title={'Run All'} onClick={this.onTestRunAll}>\n                        <RunningManIcon/>\n                    </IconButton>\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default TestListView;\n","import React from 'react';\nimport Style from './TestingPanel.css';\n\nimport PanelContainer from 'experimental/panels/PanelContainer.js';\nimport PanelSwitch from 'experimental/panels/PanelSwitch.js';\n\nimport TestListView from './TestListView.js';\n\nimport { MACHINE_ERROR_NOTIFICATION_TAG } from 'modules/fsa2/components/notifications/FSANotifications.js';\n\nclass TestingPanel extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.state = {\n            stepMode: false\n        };\n\n        this.onStepTestChange = this.onStepTestChange.bind(this);\n        this.onAutoErrorCheckChange = this.onAutoErrorCheckChange.bind(this);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        //TODO: This should be in modules...\n        const session = this.props.session;\n        const app = session.getApp();\n        const currentModule = session.getCurrentModule();\n        const tester = currentModule._tester;\n        tester.on('startTest', (tester) => \n        {\n            currentModule._testMode = true;\n            app._drawer.setDrawerSoloClass(TestingPanel);\n            app._drawer.closeDrawer();\n        });\n        tester.on('stopTest', (tester) => \n        {\n            currentModule._testMode = false;\n            app._drawer.setDrawerSoloClass(null);\n            app._drawer.openDrawer();\n        });\n    }\n\n    onStepTestChange(e)\n    {\n        this.setState((prev, props) => \n        {\n            return { stepMode: !prev.stepMode };\n        });\n    }\n\n    onAutoErrorCheckChange(e)\n    {\n        const currentModule = this.props.session.getCurrentModule();\n        const errorChecker = currentModule.getErrorChecker();\n        const errorCheck = errorChecker.isErrorChecking();\n        errorChecker.setErrorChecking(!errorCheck);\n        if (errorCheck)\n        {\n            // Turning it off\n            this.props.session.getApp().getNotificationManager().clearNotifications(MACHINE_ERROR_NOTIFICATION_TAG);\n        }\n        else\n        {\n            // Run it at least once on start\n            errorChecker.showErrors();\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const machineController = currentModule.getMachineController();\n        const tester = currentModule.getStringTester();\n        const errorChecker = currentModule.getErrorChecker();\n\n        const stepMode = this.state.stepMode;\n        const errorCheck = errorChecker.isErrorChecking();\n\n        return (\n            <PanelContainer id={this.props.id}\n                className={Style.panel_container +\n                    ' ' + this.props.className}\n                style={this.props.style}\n                title={TestingPanel.TITLE}>\n\n                <TestListView tester={tester} graphController={graphController} machineController={machineController} immediate={!stepMode} />\n                <PanelSwitch id={'testing-step-test'} checked={stepMode} onChange={this.onStepTestChange} title={'Step testing'} />\n                <PanelSwitch id={'testing-error-check'} checked={errorCheck} onChange={this.onAutoErrorCheckChange} title={'Auto error checking'} />\n\n            </PanelContainer>\n        );\n    }\n}\nObject.defineProperty(TestingPanel, 'TITLE', {\n    get: function () { return I18N.toString('component.testing.title'); }\n});\n\nexport default TestingPanel;\n","import Parser from 'util/file/Parser.js';\nimport FSAGraph from '../graph/FSAGraph.js';\n\nexport const VERSION = '1.0.0';\n\nclass FSAGraphParser extends Parser\n{\n    constructor()\n    {\n        super();\n    }\n\n    /**\n     * @override\n     * @param  {Object} data          the graph data to parse\n     * @param  {FSAGraph} [dst=null]  the target to set parsed graph data\n     * @return {FSAGraph}             the result in the passed-in dst\n     */\n    parse(data, dst = null)\n    {\n        if (typeof data !== 'object')\n        {\n            throw new Error('Unable to parse data of non-object type');\n        }\n\n        if (!dst)\n        {\n            dst = new FSAGraph();\n        }\n        else\n        {\n            dst.clear();\n        }\n\n        // const version = data['_version'] || '0.0.0';\n        const nodeDatas = data['nodes'] || [];\n        const nodeCount = Math.min(nodeDatas.length || 0, data['nodeCount'] || 0);\n        const edgeDatas = data['edges'] || [];\n        const edgeCount = Math.min(edgeDatas.length || 0, data['edgeCount'] || 0);\n        const initialIndex = data['initial'] || 0;\n\n        const nodeIndices = new Map();\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            const nodeData = nodeDatas[i];\n            if (!nodeData) continue;\n\n            //NOTE: Assumes createNode will maintain order\n            const node = dst.createNode(nodeData['x'] || 0, nodeData['y'] || 0, nodeData['id']);\n            node.setNodeLabel(nodeData['label'] || '');\n            node.setNodeAccept(nodeData['accept'] || false);\n            node.setNodeCustom(nodeData['custom'] || false);\n\n            nodeIndices.set(i, node);\n        }\n\n        const initialNode = nodeIndices.get(initialIndex);\n        if (initialNode)\n        {\n            dst.setStartNode(initialNode);\n        }\n\n        for (let i = 0; i < edgeCount; ++i)\n        {\n            const edgeData = edgeDatas[i];\n            if (!edgeData) continue;\n            const sourceNode = nodeIndices.get(edgeData['from']) || null;\n            //Cannot create source-less edges\n            if (!sourceNode) continue;\n            const destinationNode = nodeIndices.get(edgeData['to']) || null;\n            //NOTE: Assumes createEdge will maintain order\n            const edge = dst.createEdge(sourceNode, destinationNode, edgeData['id']);\n            const quadData = edgeData['quad'] || {};\n            edge.setEdgeLabel(edgeData['label'] || '');\n            edge.setQuadraticRadians(quadData['radians'] || 0);\n            edge.setQuadraticLength(quadData['length'] || 0);\n        }\n\n        return dst;\n    }\n\n    /**\n     * @override\n     * @param  {FSAGraph} target      the graph to compose into data\n     * @param  {Object} [dst=null]    the object to append graph data\n     * @return {Object}               the result in the passed-in dst\n     */\n    compose(target, dst = null)\n    {\n        if (!(target instanceof FSAGraph))\n        {\n            throw new Error('Unable to compose target of unknown type');\n        }\n\n        if (!dst) dst = {};\n\n        const graphNodes = target.getNodes() || [];\n        const nodeCount = graphNodes.length || 0;\n        const graphEdges = target.getEdges() || [];\n        const edgeCount = graphEdges.length || 0;\n        const graphInitial = target.getStartNode();\n\n        const nodeDatas = new Array(nodeCount);\n        const nodeIndices = new Map();\n        let node;\n        for (let i = 0; i < nodeCount; ++i)\n        {\n            node = graphNodes[i];\n            if (node)\n            {\n                //NOTE: Assumes node must have an id\n                const elementID = node.getGraphElementID();\n\n                nodeIndices.set(node, i);\n                nodeDatas[i] = {\n                    id: elementID,\n                    x: node.x || 0, y: node.y || 0,\n                    label: node.getNodeLabel() || '',\n                    accept: node.getNodeAccept() || false,\n                    custom: node.getNodeCustom() || false\n                };\n            }\n        }\n\n        const edgeDatas = new Array(edgeCount);\n        let edge;\n        for (let i = 0; i < edgeCount; ++i)\n        {\n            edge = graphEdges[i];\n            if (edge)\n            {\n                //NOTE: Assumes edge must have an id\n                const elementID = edge.getGraphElementID();\n\n                const quad = edge.getQuadratic() || {};\n                const edgeSource = edge.getEdgeFrom();\n                const edgeDestination = edge.getEdgeTo();\n                const sourceIndex = nodeIndices.has(edgeSource) ? nodeIndices.get(edgeSource) : -1;\n                const destinationIndex = nodeIndices.has(edgeDestination) ? nodeIndices.get(edgeDestination) : -1;\n                edgeDatas[i] = {\n                    id: elementID,\n                    from: sourceIndex,\n                    to: destinationIndex,\n                    quad: { radians: quad['radians'] || 0, length: quad['length'] || 0 },\n                    label: edge.getEdgeLabel() || ''\n                };\n            }\n        }\n\n        const initialIndex = nodeIndices.get(graphInitial) || 0;\n\n        dst['_version'] = VERSION;\n        dst['nodeCount'] = nodeCount;\n        dst['nodes'] = nodeDatas;\n        dst['edgeCount'] = edgeCount;\n        dst['edges'] = edgeDatas;\n        dst['initial'] = initialIndex;\n\n        return dst;\n    }\n}\n\nexport default FSAGraphParser;\n","import React from 'react';\nimport Style from './AnalysisPanel.css';\nimport { getUnreachableNodes } from 'graph2/util/NodeGraphUtils.js';\n\nimport PanelContainer from 'experimental/panels/PanelContainer.js';\nimport PanelSection from 'experimental/panels/PanelSection.js';\nimport PanelCheckbox from 'experimental/panels/PanelCheckbox.js';\nimport { isEquivalentFSAWithWitness } from 'modules/fsa2/machine/util/EqualFSA';\nimport { MACHINE_CONVERSION_LAYOUT_ID, MACHINE_CONVERSION_NOTIFICATION_TAG } from 'modules/fsa2/components/notifications/FSANotifications.js';\n\nimport { createMachineFromFileBlob } from './MachineLoader.js';\n\nclass AnalysisPanel extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.state = {\n            isEqual: null,\n            witnessString: ''\n        };\n\n        this.optimizeUnreachOption = null;\n        this.optimizeRedundOption = null;\n\n        this.onConvertToDFA = this.onConvertToDFA.bind(this);\n        this.onConvertToNFA = this.onConvertToNFA.bind(this);\n        this.onInvertDFA = this.onInvertDFA.bind(this);\n        this.onEquivalentTest = this.onEquivalentTest.bind(this);\n\n        this.onOptimizeMachine = this.onOptimizeMachine.bind(this);\n\n        this.onFileUpload = this.onFileUpload.bind(this);\n    }\n\n    onDeleteAllUnreachable(e)\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const unreachableArray = getUnreachableNodes(graphController.getGraph());\n        graphController.deleteTargetNodes(unreachableArray);\n    }\n\n    onConvertToDFA(e)\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const graphController = currentModule.getGraphController();\n        const machineController = currentModule.getMachineController();\n        const props = { graphController: graphController, machineController: machineController };\n\n        // Will do: machineController.convertMachineTo(\"DFA\");\n        session.getApp().getNotificationManager().pushNotification(\n            I18N.toString('message.warning.convertNFAToDFA'),\n            MACHINE_CONVERSION_LAYOUT_ID, MACHINE_CONVERSION_NOTIFICATION_TAG, props, true\n        );\n    }\n\n    onConvertToNFA(e)\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const machineController = currentModule.getMachineController();\n        machineController.convertMachineTo('NFA');\n    }\n\n    onInvertDFA(e)\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const machineController = currentModule.getMachineController();\n        machineController.invertMachine();\n    }\n\n    onEquivalentTest(e)\n    {\n        createMachineFromFileBlob(e)\n            .then(result =>\n            {\n                const session = this.props.session;\n                const currentModule = session.getCurrentModule();\n                const machineController = currentModule.getMachineController();\n                const machineBuilder = machineController.getMachineBuilder();\n                const currentMachine = machineBuilder.getMachine();\n                const equivalenceResult = isEquivalentFSAWithWitness(result, currentMachine);\n                if (equivalenceResult.value)\n                {\n                    this.setState({ isEqual: true, witnessString: '' });\n                }\n                else\n                {\n                    if(!equivalenceResult.witnessString)\n                    {\n                        this.setState({ isEqual: false, witnessString: 'Sorry, the machines have different alphabets' });\n                    }\n                    else\n                    {\n                        this.setState({ isEqual: false, witnessString: 'Witness: ' + equivalenceResult.witnessString });\n                    }\n                }\n            })\n            .catch(err =>\n            {\n                this.setState({ isEqual: null, witnessString: err.message });\n            });\n    }\n\n    onOptimizeMachine(e)\n    {\n        if (this.optimizeUnreachOption.isChecked())\n        {\n            this.onDeleteAllUnreachable(e);\n        }\n    }\n\n    canOptimize()\n    {\n        return (this.optimizeRedundOption && this.optimizeRedundOption.isChecked()) ||\n            (this.optimizeUnreachOption && this.optimizeUnreachOption.isChecked());\n    }\n\n    onFileUpload(e)\n    {\n        const files = e.target.files;\n        if (files.length > 0)\n        {\n            this.onEquivalentTest(files[0]);\n\n            //Makes sure you can upload the same file again.\n            e.target.value = '';\n        }\n    }\n\n    /** @override */\n    render()\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const machineController = currentModule.getMachineController();\n\n        return (\n            <PanelContainer id={this.props.id}\n                className={this.props.className}\n                style={this.props.style}\n                title={AnalysisPanel.TITLE}>\n                <PanelSection title={'Optimizations'} initial={true}>\n                    <PanelCheckbox ref={ref => this.optimizeUnreachOption = ref}\n                        id=\"opt-unreach\" title=\"Unreachables\" value=\"unreach\" />\n                    <PanelCheckbox ref={ref => this.optimizeRedundOption = ref} disabled={true}\n                        id=\"opt-redund\" title=\"Redundant States\" value=\"redund\" />\n                    <button className={Style.analysis_button} onClick={this.onOptimizeMachine} disabled={!this.canOptimize()}>Optimize</button>\n                    {\n                        machineController.getMachineType() == 'DFA' ?\n                            <button className={Style.analysis_button} onClick={this.onConvertToNFA}>\n                                {I18N.toString('action.overview.convertnfa')}\n                            </button>\n                            : machineController.getMachineType() == 'NFA' ?\n                                <button className={Style.analysis_button} onClick={this.onConvertToDFA}>\n                                    {I18N.toString('action.overview.convertdfa')}\n                                </button>\n                                : null\n                    }\n                </PanelSection>\n                <PanelSection title={'Related Machines'}>\n                    {machineController.getMachineType() === 'DFA' &&\n                        <button className={Style.analysis_button} onClick={this.onInvertDFA}>\n                            {'Flip all accept states'}\n                        </button>}\n                </PanelSection>\n                <PanelSection title={'Equivalent Test'}>\n                    <input type=\"file\" name=\"import\"\n                        className={Style.upload_input}\n                        onChange={this.onFileUpload}/>\n                    <div>\n                        <label>\n                            {\n                                this.state.isEqual === null\n                                    ? '-- ??? --'\n                                    : this.state.isEqual\n                                        ? '-- Equivalent --'\n                                        : '-- Not Equivalent --'\n                            }\n                        </label>\n                    </div>\n                    <div>\n                        <label>{this.state.witnessString}</label>\n                    </div>\n                </PanelSection>\n            </PanelContainer>\n        );\n    }\n}\nObject.defineProperty(AnalysisPanel, 'TITLE', {\n    get: function () { return I18N.toString('component.analysis.title'); }\n});\n\nexport default AnalysisPanel;\n","import TextUploader from 'util/file/import/TextUploader.js';\nimport FSAGraphParser from 'modules/fsa2/filehandlers/FSAGraphParser.js';\nimport FSAGraph from 'modules/fsa2/graph/FSAGraph.js';\nimport FSABuilder from 'modules/fsa2/machine/FSABuilder.js';\nimport FSA from 'modules/fsa2/machine/FSA.js';\n\nexport function createMachineFromFileBlob(fileBlob)\n{\n    return new Promise((resolve, reject) =>\n    {\n        new TextUploader().uploadFile(fileBlob)\n            .then(result =>\n            {\n                const fileData = JSON.parse(result);\n\n                const graphParser = new FSAGraphParser();\n                const graph = new FSAGraph();\n                graphParser.parse(fileData['graphData'], graph);\n\n                const machineBuilder = new FSABuilder();\n                const machine = new FSA();\n                machineBuilder.attemptBuildMachine(graph, machine);\n                \n                if (machine)\n                {\n                    resolve(machine);\n                }\n                else\n                {\n                    resolve(null);\n                }\n            });\n    });\n}","import React from 'react';\n\nimport NodeRenderer from 'graph2/renderer/NodeRenderer.js';\n\nclass FSANodeRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const node = this.props.node;\n        const fill = this.props.fill;\n        const stroke = this.props.stroke;\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        const label = node.getNodeLabel();\n        const radius = node.getNodeSize();\n\n        const accept = node.getNodeAccept();\n\n        return (\n            <React.Fragment>\n                <NodeRenderer\n                    position={node}\n                    radius={radius}\n                    label={label}\n                    color={fill}\n                    outline={stroke}\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = node;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n                {accept &&\n                    <NodeRenderer\n                        position={node}\n                        radius={radius * 0.7}\n                        color='none'\n                        outline={stroke} />}\n            </React.Fragment>\n        );\n    }\n}\n\nexport default FSANodeRenderer;\n","import AbstractInputHandler from 'util/input/AbstractInputHandler.js';\nimport { EVENT_SOURCE_NODE } from 'graph2/renderer/NodeRenderer.js';\n\nexport const GRAPH_EVENT_NODE_ACCEPT_CHANGE = 'node-accept-change';\n\nclass FSANodeInputHandler extends AbstractInputHandler\n{\n    constructor(inputController, graphController)\n    {\n        super();\n\n        this._inputController = inputController;\n        this._graphController = graphController;\n    }\n\n    /** @override */\n    onDblInputEvent(pointer)\n    {\n        const inputController = this._inputController;\n        const graphController = this._graphController;\n        const currentTargetType = inputController.getCurrentTargetType();\n        if (currentTargetType === EVENT_SOURCE_NODE)\n        {\n            const currentTargetSource = inputController.getCurrentTargetSource();\n            currentTargetSource.setNodeAccept(!currentTargetSource.getNodeAccept());\n\n            graphController.emitGraphEvent(GRAPH_EVENT_NODE_ACCEPT_CHANGE, { target: currentTargetSource });\n        }\n    }\n}\n\nexport default FSANodeInputHandler;","import React from 'react';\n\nimport EdgeRenderer, { DIRECTED_FORWARD } from 'graph2/renderer/EdgeRenderer.js';\n\nimport { SYMBOL_SEPARATOR } from '../element/FSAEdge.js';\n\nclass FSAEdgeRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    /** @override */\n    render()\n    {\n        const edge = this.props.edge;\n        const stroke = this.props.stroke;\n        const onMouseOver = this.props.onMouseOver;\n        const onMouseOut = this.props.onMouseOut;\n        const pointerEvents = this.props.pointerEvents;\n\n        const start = edge.getStartPoint();\n        const end = edge.getEndPoint();\n        const center = edge.getCenterPoint();\n        const label = edge.getEdgeLabel();\n        const edgeDir = edge.getEdgeDirection();\n\n        return (\n            <React.Fragment>\n                <EdgeRenderer\n                    directed={DIRECTED_FORWARD}\n                    from={start}\n                    to={end}\n                    center={center}\n                    label={label.split(SYMBOL_SEPARATOR).join('\\n')}\n                    direction={edgeDir}\n                    color={stroke}\n                    onMouseOver={onMouseOver ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = edge;\n                        onMouseOver(e);\n                    } : null}\n                    onMouseOut={onMouseOut ? e =>\n                    {\n                        const value = e.target['value'] || (e.target['value'] = {});\n                        value.source = edge;\n                        onMouseOut(e);\n                    } : null}\n                    pointerEvents={pointerEvents} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default FSAEdgeRenderer;\n","import React from 'react';\n\nimport GraphNodeLayer from 'graph2/components/layers/GraphNodeLayer.js';\nimport GraphEdgeLayer from 'graph2/components/layers/GraphEdgeLayer.js';\nimport SelectionBoxLayer from 'graph2/components/layers/SelectionBoxLayer.js';\nimport IndexedGraphStartMarkerLayer from 'graph2/components/layers/IndexedGraphStartMarkerLayer.js';\nimport GraphHighlightLayer from 'graph2/components/layers/GraphHighlightLayer.js';\n\nimport FSANodeRenderer from '../../graph/renderer/FSANodeRenderer.js';\nimport FSANodeInputHandler from '../../graph/inputhandler/FSANodeInputHandler.js';\n\nimport FSAEdgeRenderer from '../../graph/renderer/FSAEdgeRenderer.js';\n\nclass FSAGraphLayer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        const graphView = props.graphView;\n        const graphController = props.graphController;\n        const inputController = graphView.getInputController();\n\n        this._fsaNodeInputHandler = new FSANodeInputHandler(inputController, graphController);\n    }\n\n    /** @override */\n    componentDidMount()\n    {\n        const graphView = this.props.graphView;\n        const inputContext = graphView.getInputContext();\n        inputContext.addInputHandler(this._fsaNodeInputHandler);\n    }\n\n    /** @override */\n    componentWillUnmount()\n    {\n        const graphView = this.props.graphView;\n        const inputContext = graphView.getInputContext();\n        inputContext.removeInputHandler(this._fsaNodeInputHandler);\n    }\n\n    /** @override */\n    render()\n    {\n        const graphView = this.props.graphView;\n        const graphController = this.props.graphController;\n        const editable = this.props.editable;\n\n        const graph = graphController.getGraph();\n        const inputController = graphView.getInputController();\n        const inputContext = graphView.getInputContext();\n\n        const session = this.props.session;\n        const testTargetNodes = session.getCurrentModule()._tester.targets;\n\n        return (\n            <React.Fragment>\n                <IndexedGraphStartMarkerLayer\n                    inputController={inputController}\n                    graphController={graphController}\n                    inputContext={inputContext}\n                    inputPriority={-1}\n                    editable={editable} />\n                <GraphNodeLayer\n                    nodes={graph.getNodes()}\n                    inputController={inputController}\n                    graphController={graphController}\n                    nodeRenderer={FSANodeRenderer}\n                    inputContext={inputContext}\n                    inputPriority={-1}\n                    editable={editable} />\n                <GraphEdgeLayer\n                    ref={ref =>\n                    {\n                        if (!ref) return;\n                        ref.getGraphEdgeInputHandler()\n                            .setShouldDeleteEdgeWithEmptyLabel(true)\n                            .setShouldDeleteEdgePlaceholder(true);\n                    }}\n                    edges={graph.getEdges()}\n                    inputController={inputController}\n                    graphController={graphController}\n                    edgeRenderer={FSAEdgeRenderer}\n                    inputContext={inputContext}\n                    inputPriority={-1}\n                    editable={editable} />\n                <SelectionBoxLayer\n                    inputController={inputController}\n                    graphController={graphController}\n                    inputContext={inputContext}\n                    inputPriority={-1} />\n                <GraphHighlightLayer\n                    nodes={testTargetNodes} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default FSAGraphLayer;\n","import React from 'react';\nimport Style from './FSALabelEditorRenderer.css';\n\nimport GraphEdge from 'graph2/element/GraphEdge.js';\nimport GraphNode from 'graph2/element/GraphNode.js';\nimport PatternInputButton from 'graph2/components/widgets/pattern/PatternInputButton.js';\nimport { SYMBOL_SEPARATOR, EMPTY_CHAR } from 'modules/fsa2/graph/element/FSAEdge.js';\n\nconst RECOMMENDED_SYMBOLS = ['0', '1'];\nconst DEFAULT_SYMBOLS = [EMPTY_CHAR];\n\nclass FSALabelEditorRenderer extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n    }\n\n    renderSymbol(symbol)\n    {\n        const graphController = this.props.graphController;\n        const labelEditor = graphController.getLabelEditor();\n        if (!labelEditor) return null;\n\n        const inputComponent = labelEditor.inputComponent;\n        return (\n            <PatternInputButton key={symbol} parent={inputComponent} title={symbol}\n                onClick={e => inputComponent.appendValue(symbol, SYMBOL_SEPARATOR)} />\n        );\n    }\n\n    /** @override */\n    render()\n    {\n        const graphController = this.props.graphController;\n        const labelEditor = graphController.getLabelEditor();\n        const currentModule = this.props.currentModule;\n        const machineController = currentModule.getMachineController();\n        const alphabet = machineController.getAlphabet();\n\n        const showEdgeTray = labelEditor && labelEditor.getTarget() instanceof GraphEdge;\n        const showNodeTray = labelEditor && labelEditor.getTarget() instanceof GraphNode;\n        const showDefault = true;\n        const showRecommended = !alphabet || alphabet.length <= 1;\n\n        return (\n            <div className={Style.tray_container}>\n                {showEdgeTray && <span>\n                    <span className={Style.tray_used}>\n                        {alphabet.map(e => this.renderSymbol(e))}\n                    </span>\n                    <span className={Style.tray_default}>\n                        {showRecommended &&\n                            RECOMMENDED_SYMBOLS.map(e => this.renderSymbol(e))}\n                        {showDefault &&\n                            DEFAULT_SYMBOLS.map(e => this.renderSymbol(e))}\n                    </span>\n                </span>}\n                {showNodeTray && <span>\n                    <PatternInputButton parent={labelEditor.inputComponent}\n                        title={labelEditor.getTarget().getNodeCustom() ? 'Custom' : 'Auto'}\n                        onClick={() => { labelEditor.getTarget().setNodeCustom(!labelEditor.getTarget().getNodeCustom()); }} />\n                    <PatternInputButton parent={labelEditor.inputComponent}\n                        title={labelEditor.getTarget().getNodeAccept() ? 'Accept' : 'Reject'}\n                        onClick={() => { labelEditor.getTarget().setNodeAccept(!labelEditor.getTarget().getNodeAccept()); }} />\n                </span>}\n            </div>\n        );\n    }\n}\n\nexport default FSALabelEditorRenderer;\n","import React from 'react';\n\nimport ViewportEditLayer from 'graph2/components/layers/ViewportEditLayer.js';\nimport ViewportNavigationLayer from 'graph2/components/layers/ViewportNavigationLayer.js';\n\nimport LabelEditorWidget from 'graph2/components/widgets/LabelEditorWidget.js';\n\nimport FSALabelEditorRenderer from '../widgets/FSALabelEditorRenderer.js';\n\nclass FSAGraphOverlayLayer extends React.Component\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        const session = this.props.session;\n        const currentModule = session.getCurrentModule();\n        const graphView = this.props.graphView;\n        const graphController = this.props.graphController;\n        const labelFormatter = graphController.getLabelFormatter();\n        const inputController = graphView.getInputController();\n\n        return (\n            <React.Fragment>\n                <ViewportEditLayer\n                    graphController={graphController}\n                    inputController={inputController}\n                    viewport={graphView.getViewportComponent()}\n                    session={session}/>\n                <ViewportNavigationLayer\n                    style={{ right: 0 }}\n                    viewportAdapter={graphView.getViewportAdapter()} />\n                <LabelEditorWidget ref={ref => graphController.setLabelEditor(ref)}\n                    labelFormatter={labelFormatter}\n                    viewport={graphView.getViewportComponent()}\n                    saveOnExit={true}>\n                    <FSALabelEditorRenderer\n                        graphController={graphController}\n                        currentModule={currentModule} />\n                </LabelEditorWidget>\n            </React.Fragment>\n        );\n    }\n}\n\nexport default FSAGraphOverlayLayer;","import React from 'react';\nimport Style from './TapeWidget.css';\n\nimport DownArrowIcon from 'components/iconset/DownArrowIcon.js';\n\nconst TAPE_INFINITE_LEFT = true;\nconst TAPE_INFINITE_RIGHT = true;\n\nclass TapeWidget extends React.Component\n{\n    constructor(props)\n    {\n        super(props);\n\n        this.onTapeStepBackward = this.onTapeStepBackward.bind(this);\n        this.onTapeStepForward = this.onTapeStepForward.bind(this);\n        this.onTapeFinish = this.onTapeFinish.bind(this);\n        this.onTapeReset = this.onTapeReset.bind(this);\n        this.onTapeSkipForward = this.onTapeSkipForward.bind(this);\n        this.onTapeSkipBackward = this.onTapeSkipBackward.bind(this);\n        this.onTapeStop = this.onTapeStop.bind(this);\n    }\n\n    onTapeStepBackward(e)\n    {\n        const tapeContext = this.props.value;\n        tapeContext.stepBackward();\n    }\n\n    onTapeStepForward(e)\n    {\n        const tapeContext = this.props.value;\n        tapeContext.stepForward();\n    }\n\n    onTapeSkipForward(e)\n    {\n    }\n\n    onTapeSkipBackward(e)\n    {\n    }\n\n    onTapeReset(e)\n    {\n        const tapeContext = this.props.value;\n        tapeContext.reset();\n    }\n\n    onTapeFinish(e)\n    {\n        const tapeContext = this.props.value;\n        tapeContext.finish();\n    }\n\n    onTapeStop(e)\n    {\n        const tapeContext = this.props.value;\n        tapeContext.stop();\n    }\n\n    /** @override */\n    render()\n    {\n        const showTransitionStates = true;\n        const tapeContext = this.props.value;\n        const tapeIndex = tapeContext ? tapeContext.getCurrentTapeIndex() : -1;\n\n        if (!tapeContext) return null;\n\n        return (\n            <div id={this.props.id}\n                className={Style.tape_container +\n                    ' ' + this.props.className}\n                style={this.props.style}>\n\n                <div className={Style.tape_control_tray}>\n                    <button onClick={this.onTapeStepBackward}>BACK</button>\n                    <button onClick={this.onTapeStepForward}>STEP</button>\n                    <button onClick={this.onTapeReset}>RESET</button>\n                    <button onClick={this.onTapeFinish}>TO END</button>\n                </div>\n\n                <div className={Style.tape_control_tray}>\n                    <button onClick={this.onTapeSkipForward}>SKIP TO NEXT</button>\n                    <button onClick={this.onTapeSkipBackward}>SKIP TO PREV</button>\n                    <button onClick={this.onTapeStop}>STOP</button>\n                </div>\n\n                <div className={'tape-row'}>\n\n                    {TAPE_INFINITE_LEFT && tapeContext.isTapeLeftInfinite() &&\n                        <div className=\"tape-row-entry infinite\">\n                            <span className=\"tape-row-states\"></span>\n                            <label className=\"tape-row-symbol\">{'...'}</label>\n                        </div>}\n\n                    <DownArrowIcon\n                        className=\"tape-pointer\"\n                        style={{ opacity: tapeIndex < 0 ? 0 : 1, left: tapeIndex + 'em' }} />\n\n                    {tapeContext.getTapeInput().map((e, i) => \n                    {\n                        let active = false;\n                        let activeRead = false;\n                        active = tapeIndex === i;\n                        activeRead = tapeIndex === i - 1;\n                        /*\n                        const currentIndex = Math.floor(tapeIndex / 2);\n                        if (currentIndex === i)\n                        {\n                        //It's the current index...\n                        active = tapeIndex % 2 === 1;\n                        activeRead = tapeIndex % 2 === 0;\n                        }\n                        else if (currentIndex === i + 1)\n                        {\n                        //It's the previous index...\n                        active = tapeIndex % 2 === 0;\n                        }\n                        */\n\n                        const sourceStates = tapeContext.getTapeSourceStatesByIndex(i);\n                        const disabled = sourceStates === null;\n                        return (\n                            <div key={e + ':' + i} className={'tape-row-entry' +\n                                (active ? ' active ' : '') +\n                                (activeRead ? ' active-read ' : '') +\n                                (disabled ? ' disabled ' : '')}\n                            onClick={(e) => (!disabled ? tapeContext.setCurrentTapeIndex(i) : null)}>\n                                {showTransitionStates &&\n                                    sourceStates &&\n                                    <span className=\"tape-row-states\">\n                                        {sourceStates.map(sourceState => \n                                        {\n                                            return (\n                                                <label key={sourceState.getGraphElementID()}>\n                                                    {sourceState.getNodeLabel()}\n                                                </label>\n                                            );\n                                        })}\n                                    </span>}\n                                <label className=\"tape-row-symbol\">\n                                    {e}\n                                </label>\n                            </div>\n                        );\n                    })}\n\n                    {TAPE_INFINITE_RIGHT && tapeContext.isTapeRightInfinite() &&\n                        <div className=\"tape-row-entry infinite\">\n                            <span className=\"tape-row-states\"></span>\n                            <label className=\"tape-row-symbol\">{'...'}</label>\n                        </div>}\n                </div>\n            </div>\n        );\n    }\n}\n\nexport default TapeWidget;\n","import React from 'react';\n\nimport TapeWidget from '../widgets/TapeWidget.js';\n\nimport ViewportNavigationLayer from 'graph2/components/layers/ViewportNavigationLayer.js';\n\nclass FSATapeGraphOverlayLayer extends React.Component\n{\n    constructor(props) { super(props); }\n\n    /** @override */\n    render()\n    {\n        const graphView = this.props.graphView;\n        const tester = this.props.tester;\n\n        return (\n            <React.Fragment>\n                <ViewportNavigationLayer\n                    style={{ right: 0 }}\n                    viewportAdapter={graphView.getViewportAdapter()} />\n                <TapeWidget style={{ position: 'absolute', bottom: 0 }}\n                    value={tester ? tester.getTapeContext() : null} />\n            </React.Fragment>\n        );\n    }\n}\n\nexport default FSATapeGraphOverlayLayer;","import React from 'react';\n\nimport { userClearGraph } from 'experimental/UserUtil.js';\nimport { CTRL_KEY } from 'session/manager/hotkey/HotKeyManager.js';\nimport { RENDER_LAYER_WORKSPACE } from 'session/manager/RenderManager.js';\n\nimport FSAGraph from './graph/FSAGraph.js';\nimport FSAGraphController from './graph/FSAGraphController.js';\nimport MachineController from './machine/MachineController.js';\n\nimport StringTester from './tester/StringTester.js';\nimport FSAErrorChecker from './FSAErrorChecker.js';\nimport { registerNotifications } from './components/notifications/FSANotifications.js';\n\nimport * as FSAGraphParser from './FSAGraphParser.js';\nimport FSAImporter from './filehandlers/FSAImporter.js';\nimport FSAJFFImporter from './filehandlers/FSAJFFImporter.js';\nimport FSAExporter from './filehandlers/FSAExporter.js';\nimport FSAJFFExporter from './filehandlers/FSAJFFExporter.js';\nimport { registerImageExporters } from 'modules/nodegraph/filehandlers/NodalGraphImageExporter.js';\n\nimport SafeGraphEventHandler from 'modules/nodegraph/SafeGraphEventHandler.js';\n\nimport FSABroadcastHandler from './FSABroadcastHandler.js';\nimport TutorialHandler from './TutorialHandler.js';\n\n/* COMPONENTS */\n\nimport PanelContainer from 'experimental/panels/PanelContainer.js';\n\nimport OverviewPanel from './components/panels/overview/OverviewPanel.js';\nimport TestingPanel from './components/panels/testing/TestingPanel.js';\nimport AnalysisPanel from './components/panels/analysis/AnalysisPanel.js';\n\nimport FSAGraphLayer from './components/layers/FSAGraphLayer.js';\nimport FSAGraphOverlayLayer from './components/layers/FSAGraphOverlayLayer.js';\nimport FSATapeGraphOverlayLayer from './components/layers/FSATapeGraphOverlayLayer.js';\n\nimport GraphView from 'graph2/components/GraphView.js';\n\nconst MODULE_NAME = 'fsa';\nconst MODULE_VERSION = '3.0.0';\n\nclass FSAModule\n{\n    constructor(app)\n    {\n        this._app = app;\n\n        this._graph = new FSAGraph();\n        this._graphController = new FSAGraphController(app, this._graph, null);\n        this._graphViewComponent = React.createRef();\n        \n        const graphController = this._graphController;\n\n        app.getRenderManager()\n            .addRenderer(RENDER_LAYER_WORKSPACE, props => (\n                <GraphView\n                    ref={this._graphViewComponent}\n                    renderGraph={graphView =>\n                    {\n                        return <FSAGraphLayer\n                            graphView={graphView}\n                            graphController={graphController}\n                            editable={!this._testMode}\n                            session={this._app.getSession()} />;\n                    }}\n                    renderOverlay={graphView =>\n                    {\n                        if (!this._testMode)\n                        {\n                            return <FSAGraphOverlayLayer\n                                graphView={graphView}\n                                graphController={graphController}\n                                session={this._app.getSession()} />;\n                        }\n                        else\n                        {\n                            return <FSATapeGraphOverlayLayer\n                                graphView={graphView}\n                                tester={this._tester} />;\n                        }\n                    }}>\n                </GraphView>\n            ));\n        this._machineController = new MachineController(this);\n\n        this._errorChecker = new FSAErrorChecker(app,\n            this._graphController,\n            this._machineController);\n        this._tester = new StringTester();\n        this._testMode = false;\n\n        this._broadcastHandler = new FSABroadcastHandler();\n        this._tutorialHandler = new TutorialHandler(app);\n    }\n\n    /** @override */\n    initialize(app)\n    {\n        registerNotifications(app.getNotificationManager());\n\n        // TODO: These should have a pre/post handlers...\n        app.getExportManager()\n            .registerExporter(new FSAExporter(FSAGraphParser.JSON), 'session')\n            .registerExporter(new FSAJFFExporter(FSAGraphParser.XML), 'jflap');\n\n        registerImageExporters(app.getExportManager());\n\n        app.getImportManager()\n            .addImporter(new FSAImporter(app, FSAGraphParser.JSON), '.fsa.json', '.json')\n            .addImporter(new FSAJFFImporter(app, FSAGraphParser.XML), '.jff');\n\n        app.getUndoManager()\n            .setEventHandlerFactory((...args) => new SafeGraphEventHandler(\n                this._graphController, FSAGraphParser.JSON));\n\n        app.getDrawerManager()\n            .addPanelClass(props => (\n                <PanelContainer id={props.id}\n                    className={props.className}\n                    style={props.style}\n                    title={'Finite State Automata'}>\n                    <p>{'Brought to you with \\u2764 by the Flap.js team.'}</p>\n                    <p>{'<- Tap on a tab to begin!'}</p>\n                    <div style={{position: 'absolute', bottom: 0, right: 0, marginRight: '1em'}}>\n                        {'Looking for Bab\\'s Tutorial?'}\n                        <div style={{display: 'flex', margin: '0.5em 0'}}>\n                            <button style={{flex: 1}} onClick={e =>\n                            {\n                                app.getDrawerComponent().closeDrawer();\n                                this._tutorialHandler.start(app, true);\n                            }}>\n                                {I18N.toString('message.action.next')}\n                            </button>\n                        </div>\n                    </div>\n                </PanelContainer>\n            ))\n            .addPanelClass(OverviewPanel)\n            .addPanelClass(TestingPanel)\n            .addPanelClass(AnalysisPanel);\n\n        app.getHotKeyManager()\n            .registerHotKey('Export to PNG', [CTRL_KEY, 'KeyP'], () => { app.getExportManager().tryExportFile('image-png', app.getSession()); })\n            .registerHotKey('Save as JSON', [CTRL_KEY, 'KeyS'], () => { app.getExportManager().tryExportFile('session', app.getSession()); });\n        \n        app.getMenuManager().setSubtitleComponentClass(props => (\n            <select onChange={(e) =>\n            {\n                this._machineController.setMachineType(e.target.value);\n            }}\n            value={this._machineController.getMachineType()}>\n                <option value=\"DFA\">DFA</option>\n                <option value=\"NFA\">NFA</option>\n            </select>\n        ));\n\n        app.getTooltipManager()\n            .addTooltip(I18N.toString('message.workspace.empty'))\n            .addTooltip('If you need help, try the \\'?\\' at the top.')\n            .addTooltip('Or you can choose to do nothing.')\n            .addTooltip('I can\\'t do anything about that.')\n            .addTooltip('You really should consider doing something though, for the sake of both of us.')\n            .addTooltip('Of course, it is your free will.')\n            .addTooltip('You do you.')\n            .addTooltip('Please do something.')\n            .addTooltip('I need my job.')\n            .addTooltip(I18N.toString('message.workspace.empty'));\n\n        app.getBroadcastManager()\n            .addMessageHandler(this._broadcastHandler);\n\n        this._machineController.initialize(this);\n        this._graphController.initialize();\n\n        this._tutorialHandler.start(app);\n    }\n\n    /** @override */\n    update(app)\n    {\n        this._graphController.update();\n        this._machineController.update(this);\n    }\n\n    /** @override */\n    destroy(app)\n    {\n        this._machineController.destroy(this);\n        this._graphController.destroy();\n    }\n\n    /** @override */\n    clear(app, graphOnly = false)\n    {\n        userClearGraph(app, graphOnly, () => app.getToolbarComponent().closeBar());\n    }\n\n    getMachineController() { return this._machineController; }\n    getGraphController() { return this._graphController; }\n    getGraphView() { return this._graphViewComponent.current; }\n\n    getErrorChecker() { return this._errorChecker; }\n    getStringTester() { return this._tester; }\n    getBroadcastHandler() { return this._broadcastHandler; }\n\n    /** @override */\n    getModuleVersion() { return MODULE_VERSION; }\n    /** @override */\n    getModuleName() { return MODULE_NAME; }\n    /** @override */\n    getLocalizedModuleName() { return 'Finite Automata'; }\n    /** @override */\n    getApp() { return this._app; }\n}\n\nexport default FSAModule;\n"],"sourceRoot":""}